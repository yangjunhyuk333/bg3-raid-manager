import{i as Ee,g as Ne,R as L,H as fe,M as ce,C as Z,F as pe,a as ye,U as F,j as e,S as oe,r as ae,L as Se,b as d,A as Ie,q as P,c as E,o as ge,l as me,d as he,e as Be,w as O,f as $,B as We,h as Ce,X as ue,I as ze,k as Te,m as te,s as V,n as Q,p as B,t as Le,u as Oe,v as Pe,x as se,y as ie,z as Me,D as le,E as Re,T as Ae,G as re,J as Fe,K as Ue,N as $e,O as He,P as qe,Q as Je,V as Ke,Z as Ye,W as Ge,Y as Ve,_ as Xe,$ as X,a0 as ee,a1 as be,a2 as Qe,a3 as Ze,a4 as et,a5 as tt,a6 as nt,a7 as at,a8 as st}from"./vendor-DH5qwxLr.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const m of c)if(m.type==="childList")for(const u of m.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&g(u)}).observe(document,{childList:!0,subtree:!0});function o(c){const m={};return c.integrity&&(m.integrity=c.integrity),c.referrerPolicy&&(m.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?m.credentials="include":c.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function g(c){if(c.ep)return;c.ep=!0;const m=o(c);fetch(c.href,m)}})();const rt="modulepreload",it=function(t){return"/bg3-raid-manager/"+t},je={},xe=function(r,o,g){let c=Promise.resolve();if(o&&o.length>0){let s=function(l){return Promise.all(l.map(f=>Promise.resolve(f).then(n=>({status:"fulfilled",value:n}),n=>({status:"rejected",reason:n}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),a=u?.nonce||u?.getAttribute("nonce");c=s(o.map(l=>{if(l=it(l),l in je)return;je[l]=!0;const f=l.endsWith(".css"),n=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${n}`))return;const i=document.createElement("link");if(i.rel=f?"stylesheet":rt,f||(i.as="script"),i.crossOrigin="",i.href=l,a&&i.setAttribute("nonce",a),document.head.appendChild(i),f)return new Promise((y,S)=>{i.addEventListener("load",y),i.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${l}`)))})}))}function m(u){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=u,window.dispatchEvent(a),!a.defaultPrevented)throw u}return c.then(u=>{for(const a of u||[])a.status==="rejected"&&m(a.reason);return r().catch(m)})},q="/bg3-raid-manager/assets/logo-BLpM7sGS.svg",ot={apiKey:"AIzaSyAsbaWbo3DoSTrRFhkaf9XujWPpmeGSjAE",authDomain:"bg3-raid-manager.firebaseapp.com",projectId:"bg3-raid-manager",storageBucket:"bg3-raid-manager.firebasestorage.app",messagingSenderId:"773826713403",appId:"1:773826713403:web:c15fdfca708d47f4fcc91e"},lt=Ee(ot),j=Ne(lt);console.log("ðŸ”¥ Firebase Connected (Real DB Mode)");const dt=({activeTab:t,setActiveTab:r,isMobile:o,user:g})=>{const[c,m]=L.useState(0),[u,a]=L.useState(4),[s,l]=L.useState(!1),[f,n]=L.useState(!1),[i,y]=L.useState(!1),[S,I]=L.useState(!1),[D,N]=L.useState(g?.nickname||""),[w,k]=L.useState(g?.className||"Warrior"),[x,b]=L.useState(g?.role||(g?.isAdmin?"Admin":"User")),v=g?.isAdmin===!0;L.useEffect(()=>{g&&(N(g.nickname||""),k(g.className||"Warrior"),b(g.role||(g.isAdmin?"Admin":"User")))},[g,f]),L.useEffect(()=>{const p=_=>{_.shiftKey&&_.altKey&&(_.key==="R"||_.key==="r")&&y(U=>!U)};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[]);const C=()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},z=async()=>{if(!D.trim())return alert("Nickname is required");try{const{updateDoc:p,doc:_}=await xe(async()=>{const{updateDoc:R,doc:A}=await import("./vendor-DH5qwxLr.js").then(M=>M.a9);return{updateDoc:R,doc:A}},[]),U=_(j,"users_v2",g.id),J={nickname:D,className:w,role:x};await p(U,J);const h={...g,...J};localStorage.setItem("bg3_user_profile",JSON.stringify(h)),alert("í”„ë¡œí•„ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ì ìš©ì„ ìœ„í•´ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤."),window.location.reload()}catch(p){console.error(p),alert("ìˆ˜ì • ì‹¤íŒ¨: "+p.message)}},W=["ë°”ë°”ë¦¬ì•ˆ","ë°”ë“œ","í´ë ˆë¦­","ë“œë£¨ì´ë“œ","íŒŒì´í„°","ëª½í¬","íŒ”ë¼ë”˜","ë ˆì¸ì €","ë¡œê·¸","ì†Œì„œëŸ¬","ì›Œë½","ìœ„ìžë“œ"],T=[{id:"home",label:"í™ˆ",icon:fe},{id:"chat",label:"ì±„íŒ…",icon:ce},{id:"calendar",label:"ì¼ì •",icon:Z},{id:"tactics",label:"ì „ìˆ íŒ",icon:pe},{id:"save",label:"ì„¸ì´ë¸Œ",icon:ye},{id:"profile",label:"í”„ë¡œí•„",icon:F}];v&&T.push({id:"admin",label:"ì•¼ì˜ì§€ ê´€ë¦¬",icon:oe});const ne=T.filter(p=>p.id!=="profile");if(o){const p=[{id:"home",icon:fe,label:"í™ˆ"},{id:"calendar",icon:Z,label:"ì¼ì •"},{id:"tactics",icon:pe,label:"ì „ìˆ "},...v?[{id:"admin",icon:oe,label:"ê´€ë¦¬"}]:[],{id:"profile",icon:F,label:"í”„ë¡œí•„"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{position:"fixed",bottom:"calc(100px + env(safe-area-inset-bottom))",right:"20px",zIndex:1001,display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsx("button",{onClick:()=>r("save"),style:{width:"45px",height:"45px",borderRadius:"50%",background:t==="save"?"var(--accent-color)":"rgba(20, 20, 30, 0.7)",border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",transition:"all 0.2s"},children:e.jsx(ye,{size:20})}),e.jsx("button",{onClick:()=>r("chat"),style:{width:"45px",height:"45px",borderRadius:"50%",background:t==="chat"?"var(--accent-color)":"rgba(20, 20, 30, 0.7)",border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",transition:"all 0.2s"},children:e.jsx(ce,{size:20})})]}),e.jsx("nav",{className:"glass",style:{position:"fixed",bottom:"calc(25px + env(safe-area-inset-bottom))",left:"20px",right:"20px",height:"70px",zIndex:1e3,display:t==="chat"?"none":"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"40px",border:"1px solid rgba(255,255,255,0.15)",borderTop:"1px solid rgba(255,255,255,0.25)",backdropFilter:"blur(25px) saturate(180%)",background:"linear-gradient(145deg, rgba(30, 30, 45, 0.6), rgba(10, 10, 20, 0.8))",padding:"0 25px",boxShadow:"0 15px 35px rgba(0,0,0,0.5), inset 0 1px 1px rgba(255,255,255,0.1)"},children:p.map(_=>{const U=_.icon,J=t===_.id;return e.jsx("button",{onClick:()=>r(_.id),style:{background:J?"var(--accent-color)":"transparent",borderRadius:"50%",width:"45px",height:"45px",border:"none",display:"flex",alignItems:"center",justifyContent:"center",color:J?"white":"rgba(255,255,255,0.5)",transition:"all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},children:e.jsx(U,{size:22,strokeWidth:2.5})},_.id)})})]})}return e.jsxs("aside",{className:"glass",style:{width:"280px",height:"100vh",margin:0,padding:"25px",display:"flex",flexDirection:"column",borderRadius:0,borderRight:"1px solid rgba(255,255,255,0.1)",background:"rgba(20, 20, 30, 0.4)",position:"sticky",top:0},children:[e.jsxs("div",{style:{padding:"0 0 25px",textAlign:"center",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[i&&e.jsx("button",{id:"db-reset-btn",onClick:async()=>{if(confirm("âš ï¸ ê²½ê³ : ì •ë§ë¡œ DBë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ëŒì´í‚¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")){const{collection:p,getDocs:_,deleteDoc:U}=await xe(async()=>{const{collection:R,getDocs:A,deleteDoc:M}=await import("./vendor-DH5qwxLr.js").then(G=>G.a9);return{collection:R,getDocs:A,deleteDoc:M}},[]);(await _(p(j,"users_v2"))).forEach(R=>U(R.ref)),(await _(p(j,"camps"))).forEach(R=>U(R.ref)),alert("ì´ˆê¸°í™” ì™„ë£Œ. ìž¬ì ‘ì†í•©ë‹ˆë‹¤."),C()}},style:{background:"red",color:"white",border:"none",padding:"5px",marginBottom:"10px",fontSize:"0.7rem",cursor:"pointer",width:"100%"},children:"[ADMIN] DB ì´ˆê¸°í™”"}),e.jsxs("div",{className:"logo-wrapper",style:{position:"relative",width:"100%",marginBottom:"10px",cursor:"pointer"},onClick:()=>window.location.reload(),children:[e.jsx("img",{src:q,alt:"BG3",style:{width:"100%",height:"auto",display:"block"},onError:p=>p.target.style.display="none"}),e.jsx("div",{className:"logo-shine",style:{WebkitMaskImage:`url(${q})`,maskImage:`url(${q})`}})]}),e.jsxs("div",{onClick:()=>setShowSurvivors&&setShowSurvivors(!0),style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 10px",background:"rgba(0,0,0,0.3)",borderRadius:"12px",fontSize:"0.75rem",border:"1px solid rgba(255,255,255,0.1)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.background="rgba(255,255,255,0.1)",onMouseLeave:p=>p.currentTarget.style.background="rgba(0,0,0,0.3)",children:[e.jsx(F,{size:12,color:"#4ade80"}),e.jsxs("span",{style:{color:"#4ade80"},children:[c,"/",u,"ëª… ì ‘ì† ì¤‘"]})]})]}),e.jsx("nav",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"20px",flex:1},children:ne.map(p=>{const _=p.icon;return e.jsxs("button",{onClick:()=>r(p.id),style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:t===p.id?"rgba(255,255,255,0.15)":"transparent",color:t===p.id?"white":"rgba(255,255,255,0.7)",borderRadius:"12px",transition:"all 0.2s",border:"none",cursor:"pointer",fontSize:"0.95rem",fontWeight:t===p.id?"bold":"normal"},children:[e.jsx(_,{size:20,color:t===p.id?"var(--accent-color)":"currentColor"}),p.label]},p.id)})}),e.jsxs("div",{onClick:()=>l(!0),style:{marginTop:"auto",display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",transition:"all 0.2s",padding:"12px",borderRadius:"12px",background:"rgba(0, 0, 0, 0.3)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},onMouseEnter:p=>{p.currentTarget.style.background="rgba(255, 255, 255, 0.1)",p.currentTarget.style.border="1px solid var(--accent-color)"},onMouseLeave:p=>{p.currentTarget.style.background="rgba(0, 0, 0, 0.3)",p.currentTarget.style.border="1px solid rgba(255, 255, 255, 0.1)"},title:"í”„ë¡œí•„ ë³´ê¸°",children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--accent-color)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(F,{size:20,color:"white"})}),e.jsx("div",{style:{flex:1,overflow:"hidden"},children:e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:g.nickname})}),e.jsx("button",{onClick:p=>{p.stopPropagation(),I(!0)},style:{background:"rgba(248, 113, 113, 0.15)",border:"1px solid rgba(248, 113, 113, 0.4)",borderRadius:"8px",padding:"10px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#f87171",fontWeight:"bold"},title:"ë¡œê·¸ì•„ì›ƒ",children:e.jsx(Se,{size:16})})]}),S&&ae.createPortal(e.jsx("div",{className:"modal-overlay",onClick:()=>I(!1),children:e.jsxs("div",{className:"modal-content",onClick:p=>p.stopPropagation(),style:{maxWidth:"350px",padding:"30px",textAlign:"center"},children:[e.jsx("h3",{style:{fontSize:"1.4rem",marginBottom:"10px",marginTop:"10px"},children:"ë¡œê·¸ì•„ì›ƒ"}),e.jsxs("p",{style:{opacity:.8,marginBottom:"30px",lineHeight:"1.5"},children:["ì •ë§ ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.8rem",opacity:.5},children:"(ëª¨ë“  ë¡œê·¸ì¸ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤)"})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>I(!1),style:{flex:1,padding:"14px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"transparent",color:"white",cursor:"pointer",fontWeight:"bold"},children:"ì·¨ì†Œ"}),e.jsx("button",{onClick:C,style:{flex:1,padding:"14px",borderRadius:"12px",border:"none",background:"linear-gradient(45deg, #ef4444, #dc2626)",color:"white",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(239,68,68,0.3)"},children:"í™•ì¸"})]})]})}),document.body),s&&ae.createPortal(e.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:e.jsxs("div",{className:"modal-content",onClick:p=>p.stopPropagation(),style:{maxWidth:"400px",padding:"30px",textAlign:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"var(--accent-color)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 20px",boxShadow:"0 0 20px rgba(212, 160, 23, 0.4)"},children:e.jsx(F,{size:40,color:"white"})}),e.jsx("h3",{style:{fontSize:"1.6rem",marginBottom:"5px",fontWeight:"bold"},children:g?.nickname||"ëª¨í—˜ê°€"}),e.jsxs("p",{style:{color:"var(--accent-color)",marginBottom:"20px",fontSize:"0.9rem",fontWeight:"bold"},children:[g?.className||"Classless"," ",e.jsx("span",{style:{opacity:.5},children:"|"})," ",g?.role==="Admin"||g?.isAdmin?"ëŒ€ìž¥ (ê´€ë¦¬ìž)":"ëŒ€ì›"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"25px",textAlign:"left"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"12px"},children:[e.jsx("p",{style:{fontSize:"0.75rem",opacity:.6,marginBottom:"4px"},children:"ì§ì—…"}),e.jsx("p",{style:{fontWeight:"bold"},children:g?.className||"-"})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"12px"},children:[e.jsx("p",{style:{fontSize:"0.75rem",opacity:.6,marginBottom:"4px"},children:"ì‹ ë¶„"}),e.jsx("p",{style:{fontWeight:"bold"},children:g?.role==="Admin"||g?.isAdmin?"ê´€ë¦¬ìž":"ì¼ë°˜ ëŒ€ì›"})]})]}),e.jsxs("button",{onClick:()=>{l(!1),n(!0)},style:{width:"100%",padding:"14px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s"},onMouseEnter:p=>p.currentTarget.style.background="rgba(255,255,255,0.2)",onMouseLeave:p=>p.currentTarget.style.background="rgba(255,255,255,0.1)",children:[e.jsx(oe,{size:18}),"í”„ë¡œí•„ ìˆ˜ì •í•˜ê¸°"]})]})}),document.body),f&&ae.createPortal(e.jsx("div",{className:"modal-overlay",onClick:()=>n(!1),children:e.jsxs("div",{className:"modal-content",onClick:p=>p.stopPropagation(),style:{maxWidth:"400px",padding:"30px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},children:[e.jsxs("h3",{style:{fontSize:"1.4rem",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(F,{size:24,color:"var(--accent-color)"}),"í”„ë¡œí•„ ìˆ˜ì •"]}),e.jsx("button",{onClick:()=>n(!1),style:{background:"transparent",color:"rgba(255,255,255,0.5)"},children:"x"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginBottom:"6px"},children:"ë‹‰ë„¤ìž„"}),e.jsx("input",{type:"text",value:D,onChange:p=>N(p.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",outline:"none"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginBottom:"6px"},children:"ì§ì—… (Class)"}),e.jsx("select",{value:w,onChange:p=>k(p.target.value),style:{width:"100%",padding:"12px",borderRadius:"8px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",outline:"none"},children:W.map(p=>e.jsx("option",{value:p,style:{background:"#1a1a2e"},children:p},p))})]}),e.jsx("button",{onClick:z,style:{marginTop:"10px",padding:"14px",borderRadius:"10px",background:"var(--accent-color)",color:"white",border:"none",fontWeight:"bold",fontSize:"1rem",cursor:"pointer"},children:"ì €ìž¥í•˜ê¸°"})]})]})}),document.body)]})},ve=({user:t,setActiveTab:r,isMobile:o,onlineUsersCount:g,setShowSurvivors:c})=>{const[m,u]=d.useState([]),[a,s]=d.useState(!0),[l,f]=d.useState(()=>{const i=localStorage.getItem("bg3_daily_goals");return i?JSON.parse(i):[{id:1,text:"ê¸´ íœ´ì‹ ì·¨í•˜ê¸° (ì£¼ë¬¸ ìŠ¬ë¡¯ ë³µêµ¬)",checked:!1},{id:2,text:"ì•¼ì˜ì§€ ë¬¼ìž í™•ì¸",checked:!1},{id:3,text:"ìƒì¸ì—ê²Œ ìž¡ë™ì‚¬ë‹ˆ íŒë§¤",checked:!1},{id:4,text:"ë™ë£Œ í˜¸ê°ë„ ëŒ€í™”",checked:!1}]});d.useEffect(()=>{localStorage.setItem("bg3_daily_goals",JSON.stringify(l))},[l]),d.useEffect(()=>{(async()=>{try{const y=P(E(j,"schedules"),ge("date"),me(2)),I=(await he(y)).docs.map(D=>({id:D.id,...D.data()}));u(I)}catch(y){console.error(y)}finally{s(!1)}})()},[]);const n=({icon:i,title:y,desc:S,onClick:I,color:D})=>e.jsxs("div",{onClick:I,className:"glass-panel",style:{padding:"20px",cursor:"pointer",transition:"transform 0.2s",display:"flex",flexDirection:"column",gap:"10px"},onMouseEnter:N=>N.currentTarget.style.transform="translateY(-5px)",onMouseLeave:N=>N.currentTarget.style.transform="translateY(0)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"12px",background:`rgba(${D}, 0.2)`},children:e.jsx(i,{color:`rgb(${D})`,size:24})}),e.jsx(Be,{size:16,style:{opacity:.5}})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"5px 0",fontSize:"1.1rem"},children:y}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:S})]})]});return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",flexDirection:"column",gap:o?"15px":"30px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:o?"30px 20px":"40px",background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",textAlign:"center"},children:[o&&e.jsxs("div",{className:"logo-wrapper",style:{position:"relative",width:"180px",margin:"0 auto 10px"},children:[e.jsx("img",{src:q,alt:"BG3",style:{width:"100%"},onClick:()=>window.location.reload()}),e.jsx("div",{className:"logo-shine",style:{WebkitMaskImage:`url(${q})`,maskImage:`url(${q})`}})]}),o&&e.jsxs("div",{onClick:()=>c&&c(!0),style:{display:"inline-flex",alignItems:"center",gap:"8px",background:"rgba(20, 20, 30, 0.6)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"20px",padding:"8px 16px",marginBottom:"20px",cursor:"pointer",boxShadow:"0 4px 10px rgba(0,0,0,0.2)",position:"relative",zIndex:10,userSelect:"none"},children:[e.jsx(F,{size:14,color:"#4ade80"}),e.jsxs("span",{style:{color:"#4ade80",fontSize:"0.85rem",fontWeight:"bold"},children:[g||0,"/4ëª… ì ‘ì† ì¤‘"]})]}),e.jsxs("h1",{style:{fontSize:o?"1.5rem":"2rem",marginBottom:"10px",textShadow:"0 2px 10px rgba(0,0,0,0.5)"},children:["ì–´ì„œì˜¤ì„¸ìš”, ",e.jsx("span",{style:{color:"var(--accent-color)"},children:t?.nickname||"ëª¨í—˜ê°€"}),"ë‹˜"]}),e.jsxs("p",{style:{opacity:.8,maxWidth:"600px",margin:"0 auto",fontSize:o?"0.9rem":"1rem"},children:["ë°œë”ìŠ¤ ê²Œì´íŠ¸ ì›ì •ëŒ€ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤. ",e.jsx("br",{}),"ì˜¤ëŠ˜ì˜ ëª¨í—˜ì„ ì‹œìž‘í•˜ê¸° ì „ì— ì¼ì •ì„ í™•ì¸í•˜ê³  íŒŒí‹°ì›ë“¤ê³¼ ì†Œí†µí•´ë³´ì„¸ìš”."]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:o?"10px":"20px"},children:[e.jsx(n,{icon:Z,title:"ë ˆì´ë“œ ì¼ì •",desc:"ë‹¤ê°€ì˜¤ëŠ” ëª¨í—˜ í™•ì¸í•˜ê¸°",onClick:()=>r("calendar"),color:"248, 113, 113"}),e.jsx(n,{icon:Ie,title:"ì„¸ì´ë¸Œ ë¶„ì„",desc:"ë‚´ ìºë¦­í„° ìŠ¤íŽ™ í™•ì¸",onClick:()=>r("save"),color:"167, 139, 250"}),e.jsx(n,{icon:ce,title:"ìž‘ì „ íšŒì˜ì‹¤",desc:"íŒŒí‹°ì›ë“¤ê³¼ ëŒ€í™”í•˜ê¸°",onClick:()=>r("chat"),color:"52, 211, 153"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:o?"1fr":"1fr 1fr",gap:o?"10px":"20px"},children:e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"0 0 20px"},children:[e.jsx(Z,{size:18})," ë‹¤ê°€ì˜¤ëŠ” ì¼ì •"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:a?e.jsx("p",{style:{opacity:.5},children:"ë¡œë”© ì¤‘..."}):m.length===0?e.jsx("p",{style:{opacity:.5},children:"ì˜ˆì •ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤."}):m.map(i=>e.jsxs("div",{style:{padding:"12px",background:"rgba(255,255,255,0.05)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"5px 10px",background:"rgba(0,0,0,0.3)",borderRadius:"6px"},children:[e.jsxs("span",{style:{fontSize:"0.7rem",opacity:.7},children:[i.date?.split("-")[1],"ì›”"]}),e.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:i.date?.split("-")[2]})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"bold"},children:i.title}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:[i.time," â€¢ ",i.type==="raid"?"âš”ï¸ ë ˆì´ë“œ":"ðŸ“œ ìŠ¤í† ë¦¬"]})]})]},i.id))})]})})]})},ct=({user:t,isMobile:r})=>{const[o,g]=d.useState([]),[c,m]=d.useState(""),[u,a]=d.useState(null),[s,l]=d.useState(!0),[f,n]=d.useState([]),i=d.useRef(null),y=d.useRef(null),S=d.useRef(0);d.useEffect(()=>{if(!t?.campId)return;const w=P(E(j,"chats"),O("campId","==",t.campId),me(50)),k=$(w,x=>{const b=x.docs.map(v=>({id:v.id,...v.data(),timestamp:v.data().timestamp?.toDate().toISOString()||new Date().toISOString()}));b.sort((v,C)=>new Date(v.timestamp)-new Date(C.timestamp)),g(b),l(!1)});return()=>k()},[t?.campId]),d.useEffect(()=>{if(!t?.campId)return;const w=P(E(j,"camps",t.campId,"typing")),k=$(w,b=>{const v=Date.now(),C=b.docs.map(z=>({id:z.id,...z.data()})).filter(z=>z.id!==t.id&&z.timestamp&&v-z.timestamp.toMillis()<4e3);n(C)}),x=setInterval(()=>{n(b=>{const v=Date.now();return b.filter(C=>C.timestamp?.toMillis&&v-C.timestamp.toMillis()<4e3)})},1e3);return()=>{k(),clearInterval(x)}},[t?.campId,t?.id]),d.useEffect(()=>{i.current?.scrollIntoView({behavior:"smooth"})},[o,f]);const I=w=>{const k=w.target.files[0];if(k){if(k.size>500*1024){alert("ì´ë¯¸ì§€ í¬ê¸°ëŠ” 500KB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");return}const x=new FileReader;x.onloadend=()=>{a(x.result)},x.readAsDataURL(k)}},D=async w=>{const k=w.target.value;m(k);const x=Date.now();if(k.trim()&&x-S.current>2e3&&t?.campId){S.current=x;try{await Q(B(j,"camps",t.campId,"typing",t.id),{nickname:t.nickname,timestamp:V()})}catch(b){console.error("Typing status error",b)}}},N=async w=>{if(w.preventDefault(),!c.trim()&&!u||!t?.campId)return;const k=c,x=u;m(""),a(null);try{await te(E(j,"chats"),{text:k,image:x,sender:t.nickname,uid:t.id,userClass:t.className||"Unknown",campId:t.campId,timestamp:V()})}catch(b){console.error("Error sending message: ",b),alert("ì „ì†¡ ì‹¤íŒ¨!")}};return t?.campId?e.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:0,position:r?"fixed":"absolute",top:r?"env(safe-area-inset-top)":0,left:0,right:0,bottom:r?"calc(65px + env(safe-area-inset-bottom))":0,background:r?"rgba(20, 20, 30, 0.95)":"transparent",zIndex:50},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(We,{color:"#4fd1c5"})," íŒŒí‹° ìž‘ì „ íšŒì˜ì‹¤"]}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.7},children:["ðŸ”’ ",t.campId," ì•¼ì˜ì§€ (ë³´ì•ˆ ì—°ê²°ë¨)"]})})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[s&&e.jsx("div",{style:{textAlign:"center",opacity:.5},children:"ì±„íŒ…ë°© ì—°ê²° ì¤‘..."}),o.length===0&&!s&&e.jsxs("div",{style:{textAlign:"center",opacity:.3,marginTop:"20px"},children:[e.jsx("p",{children:"ì•„ì§ ëŒ€í™”ê°€ ì—†ìŠµë‹ˆë‹¤."}),e.jsx("p",{children:"ìž‘ì „ì„ ì‹œìž‘í•´ë³´ì„¸ìš”!"})]}),o.map(w=>{const k=w.uid===t.id;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:k?"flex-end":"flex-start"},children:[e.jsx("div",{style:{fontSize:"0.8rem",marginBottom:"4px",opacity:.7,display:"flex",alignItems:"center",gap:"4px"},children:!k&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:["[",w.userClass,"]"]}),w.sender]})}),e.jsxs("div",{style:{background:k?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(255, 255, 255, 0.1)",padding:"12px 16px",borderRadius:k?"16px 16px 0 16px":"16px 16px 16px 0",maxWidth:"70%",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.1)",wordBreak:"break-word"},children:[w.image&&e.jsx("img",{src:w.image,alt:"attached",style:{maxWidth:"100%",borderRadius:"8px",marginBottom:w.text?"10px":"0"}}),w.text]}),e.jsx("span",{style:{fontSize:"0.7rem",opacity:.4,marginTop:"4px"},children:new Date(w.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},w.id)}),f.length>0&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",marginTop:"10px",paddingLeft:"4px"},children:f.slice(0,3).map(w=>e.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"8px",opacity:.9},children:[e.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",background:"linear-gradient(135deg, #a78bfa, #8b5cf6)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.7rem",fontWeight:"bold",color:"white",boxShadow:"0 2px 5px rgba(0,0,0,0.2)"},children:w.nickname?w.nickname.charAt(0):e.jsx(Ce,{size:14})}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.15)",borderRadius:"16px 16px 16px 2px",padding:"8px 12px",display:"flex",alignItems:"center",gap:"4px",height:"32px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("div",{className:"typing-dot"}),e.jsx("div",{className:"typing-dot"}),e.jsx("div",{className:"typing-dot"})]}),e.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5,marginBottom:"4px"},children:[w.nickname," ìž…ë ¥ ì¤‘..."]})]},w.id))}),e.jsx("div",{ref:i})]}),e.jsxs("form",{onSubmit:N,style:{padding:"20px",background:"rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",gap:"10px",borderRadius:"0 0 16px 16px"},children:[u&&e.jsxs("div",{style:{position:"relative",width:"fit-content"},children:[e.jsx("img",{src:u,alt:"Preview",style:{height:"80px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.2)"}}),e.jsx("button",{type:"button",onClick:()=>a(null),style:{position:"absolute",top:-5,right:-5,background:"red",borderRadius:"50%",border:"none",color:"white",padding:"2px",cursor:"pointer"},children:e.jsx(ue,{size:12})})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("input",{type:"file",accept:"image/*",ref:y,style:{display:"none"},onChange:I}),e.jsx("button",{type:"button",onClick:()=>y.current.click(),style:{padding:"12px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:e.jsx(ze,{size:20})}),e.jsx("input",{type:"text",value:c,onChange:D,placeholder:"ìž‘ì „ì„ ì „ë‹¬í•˜ì„¸ìš”...",style:{flex:1,padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.05)",color:"white",outline:"none"}}),e.jsx("button",{type:"submit",style:{padding:"12px",borderRadius:"12px",background:"var(--accent-color)",color:"white",border:"none",cursor:"pointer"},children:e.jsx(Te,{size:20})})]})]})]}):e.jsx("div",{className:"glass-panel",style:{padding:"40px",textAlign:"center"},children:"ì•¼ì˜ì§€ì— ì†Œì†ë˜ì–´ ìžˆì§€ ì•ŠìŠµë‹ˆë‹¤."})},pt=({user:t,isMobile:r})=>{const[o,g]=d.useState(new Date),[c,m]=d.useState([]),[u,a]=d.useState([]),[s,l]=d.useState(!0),f=o.toLocaleDateString("en-CA");d.useEffect(()=>{if(!t?.campId){l(!1);return}const x=P(E(j,"availabilities"),O("campId","==",t.campId)),b=P(E(j,"schedules"),O("campId","==",t.campId),O("type","==","fixed")),v=$(x,z=>{const W=z.docs.map(T=>({id:T.id,...T.data()}));m(W)}),C=$(b,z=>{const W=z.docs.map(T=>({id:T.id,...T.data()}));a(W),l(!1)});return()=>{v(),C()}},[t?.campId]);const i=c.find(x=>x.userId===t.id&&x.date===f)?.possibleTimes||[],y=d.useMemo(()=>{const x={};return c.filter(v=>v.date===f).forEach(v=>{v.possibleTimes?.forEach(C=>{x[C]||(x[C]=[]),x[C].push(v.nickname)})}),x},[c,f]),S=u.find(x=>x.date===f),I=async x=>{if(!t.campId)return;const b=i.includes(x)?i.filter(z=>z!==x):[...i,x].sort(),v=`${t.campId}_${t.id}_${f}`,C=B(j,"availabilities",v);await Q(C,{campId:t.campId,userId:t.id,nickname:t.nickname,date:f,possibleTimes:b})},D=async x=>{if(window.confirm(`${o.toLocaleDateString()} ${x}ì— ë ˆì´ë“œë¥¼ í™•ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))try{await te(E(j,"schedules"),{campId:t.campId,title:"ì •ê¸° ë ˆì´ë“œ",date:f,fixedTime:x,type:"fixed",creator:t.nickname,createdAt:new Date().toISOString()}),alert("ë ˆì´ë“œê°€ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤! íŒŒí‹°ì›ë“¤ì—ê²Œ ì•Œë¦½ë‹ˆë‹¤.")}catch(b){console.error(b),alert("ì˜¤ë¥˜ ë°œìƒ: "+b.message)}},N=async x=>{window.confirm("ì •ë§ ì´ ë ˆì´ë“œ ì¼ì •ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&await ie(B(j,"schedules",x))},w=["18:00","19:00","20:00","21:00","22:00","23:00","00:00","01:00","02:00"],k=({date:x,view:b})=>{if(b==="month"){const v=x.toLocaleDateString("en-CA");if(u.some(W=>W.date===v))return e.jsx("div",{style:{height:"6px",width:"6px",background:"#f87171",borderRadius:"50%",margin:"2px auto"}});if(c.some(W=>W.date===v))return e.jsx("div",{style:{height:"4px",width:"4px",background:"rgba(255,255,255,0.3)",borderRadius:"50%",margin:"2px auto"}})}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:r?"15px":"20px"},children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",gap:"10px",color:"white",margin:"0 0 20px",fontSize:r?"1.2rem":"1.5rem"},children:[e.jsx(Z,{className:"text-accent"})," ë ˆì´ë“œ ì¼ì • (Raid Scheduler)"]}),e.jsx("style",{children:`
                    .react-calendar { background: transparent !important; border: none !important; width: 100% !important; color: white !important; font-family: inherit; }
                    .react-calendar__navigation button { color: white; min-width: 44px; background: none; font-size: ${r?"1rem":"1.2rem"}; }
                    .react-calendar__navigation button:enabled:hover, .react-calendar__navigation button:enabled:focus { background-color: rgba(255,255,255,0.1); }
                    .react-calendar__month-view__weekdays { text-align: center; text-transform: uppercase; font-weight: bold; font-size: 0.8em; opacity: 0.7; color: var(--accent-color); }
                    .react-calendar__month-view__days__day { color: white; padding: ${r?"10px":"15px"}; background: transparent; border: none; }
                    .react-calendar__tile:enabled:hover, .react-calendar__tile:enabled:focus { background-color: rgba(255,255,255,0.1); border-radius: 12px; }
                    .react-calendar__tile--now { background: rgba(255,255,255,0.1) !important; border-radius: 12px; }
                    .react-calendar__tile--active { background: var(--accent-color) !important; color: white !important; border-radius: 12px; }
                `}),e.jsx(Le,{onChange:g,value:o,tileContent:k,formatDay:(x,b)=>b.getDate()})]}),S?e.jsxs("div",{className:"glass-panel",style:{padding:"25px",background:"linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.05))",border:"1px solid rgba(239, 68, 68, 0.3)",textAlign:"center"},children:[e.jsxs("h3",{style:{fontSize:"1.4rem",color:"#fca5a5",marginBottom:"10px",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[e.jsx(Oe,{})," ë ˆì´ë“œ í™•ì •ë¨"]}),e.jsx("p",{style:{fontSize:"2rem",fontWeight:"bold",margin:"10px 0"},children:S.fixedTime}),e.jsx("p",{style:{opacity:.8},children:"ëª¨ë“  ëŒ€ì›ì€ í•´ë‹¹ ì‹œê°„ì— ì•¼ì˜ì§€ë¡œ ì§‘ê²°í•˜ì‹­ì‹œì˜¤."}),(t.isAdmin||t.role==="Admin")&&e.jsx("button",{onClick:()=>N(S.id),style:{marginTop:"20px",padding:"10px 20px",borderRadius:"8px",background:"rgba(0,0,0,0.3)",color:"#fca5a5",border:"1px solid rgba(239,68,68,0.5)",cursor:"pointer"},children:"ì¼ì • ì·¨ì†Œí•˜ê¸°"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"glass-panel",style:{padding:r?"15px":"20px"},children:[e.jsxs("h3",{style:{margin:"0 0 15px",display:"flex",alignItems:"center",gap:"8px",fontSize:"1.1rem"},children:[e.jsx(Pe,{size:18,color:"var(--accent-color)"}),"ë‚˜ì˜ ê°€ëŠ¥ ì‹œê°„ (",o.toLocaleDateString(),")"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:w.map(x=>{const b=i.includes(x);return e.jsx("button",{onClick:()=>I(x),style:{padding:"10px 16px",borderRadius:"12px",border:"none",cursor:"pointer",background:b?"var(--accent-color)":"rgba(255,255,255,0.05)",color:b?"white":"rgba(255,255,255,0.6)",fontWeight:b?"bold":"normal",transition:"all 0.2s",flexGrow:r?1:0},children:x},x)})})]}),e.jsxs("div",{className:"glass-panel",style:{padding:r?"15px":"20px"},children:[e.jsxs("h3",{style:{margin:"0 0 15px",display:"flex",alignItems:"center",gap:"8px",fontSize:"1.1rem"},children:[e.jsx(F,{size:18,color:"#a78bfa"}),"íŒŒí‹° í˜„í™© (Team Status)"]}),Object.keys(y).length===0?e.jsx("p",{style:{opacity:.5,textAlign:"center",padding:"20px"},children:"ì•„ì§ ë“±ë¡ëœ ê°€ëŠ¥ ì‹œê°„ì´ ì—†ìŠµë‹ˆë‹¤."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:Object.entries(y).sort((x,b)=>b[1].length-x[1].length||x[0].localeCompare(b[0])).map(([x,b])=>{const v=b.length,C=v>=3;return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderRadius:"12px",background:C?"rgba(167, 139, 250, 0.15)":"rgba(255,255,255,0.03)",border:C?"1px solid rgba(167, 139, 250, 0.3)":"1px solid transparent"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem",color:C?"#a78bfa":"white"},children:x}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(F,{size:14,style:{opacity:.7}}),e.jsxs("span",{style:{fontSize:"0.9rem",opacity:.9},children:[v,"ëª… ê°€ëŠ¥"]}),e.jsxs("span",{style:{fontSize:"0.75rem",opacity:.5},children:["(",b.join(", "),")"]})]})]}),(t.isAdmin||t.role==="Admin")&&e.jsxs("button",{onClick:()=>D(x),style:{padding:"6px 12px",borderRadius:"8px",border:"none",background:"linear-gradient(45deg, #f87171, #ef4444)",color:"white",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"0.8rem"},children:[e.jsx(se,{size:12,fill:"white"})," í™•ì •"]})]},x)})})]})]})]})},xt=({user:t})=>{const[r,o]=d.useState([]),[g,c]=d.useState(!0);d.useEffect(()=>{if(!t?.campId)return;const s=P(E(j,"save_reports_v2"),O("campId","==",t.campId),ge("createdAt","desc"),me(10)),l=$(s,f=>{const n=f.docs.map(i=>({id:i.id,...i.data()}));o(n),c(!1)});return()=>l()},[t?.campId]);const m=async s=>{confirm("ì´ ë¶„ì„ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&await ie(B(j,"save_reports_v2",s))},u=({label:s,value:l,color:f})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"},children:[e.jsx("span",{style:{width:"40px",fontWeight:"bold",fontSize:"0.8rem",color:"rgba(255,255,255,0.7)"},children:s}),e.jsx("div",{style:{flex:1,height:"8px",background:"rgba(255,255,255,0.1)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${l/20*100}%`,height:"100%",background:f,transition:"width 0.5s"}})}),e.jsx("span",{style:{width:"25px",textAlign:"right",fontWeight:"bold"},children:l})]}),a=s=>{const l=s.target.files[0];l&&(c(!0),setTimeout(async()=>{const f={STR:Math.floor(Math.random()*10)+10,DEX:Math.floor(Math.random()*10)+10,CON:Math.floor(Math.random()*10)+10,INT:Math.floor(Math.random()*10)+10,WIS:Math.floor(Math.random()*10)+10,CHA:Math.floor(Math.random()*10)+10},n={filename:l.name,stats:f,meta:{mode:"Honour Mode (Detected)",version:"4.1.1.4",size:(l.size/1024/1024).toFixed(2)+" MB"},companions:[{name:"Shadowheart",img:"ðŸŒ™"},{name:"Astarion",img:"ðŸ§›"}],logs:["[Client] File loaded locally","[Parser] Header verified (LSOF v4)","[Analysis] Stats extracted successfully"],uploader:t.nickname,campId:t.campId,createdAt:V()};try{await te(E(j,"save_reports_v2"),n),alert("ë¶„ì„ ì™„ë£Œ!")}catch(i){console.error(i),alert("ì—…ë¡œë“œ ì‹¤íŒ¨")}finally{c(!1)}},1500))};return e.jsxs("div",{style:{padding:"0 0 80px"},children:[e.jsxs("div",{className:"glass-panel",style:{marginBottom:"20px",textAlign:"center",border:"1px solid var(--accent-color)"},children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[e.jsx(Me,{color:"#a78bfa"})," ì„¸ì´ë¸Œ íŒŒì¼ ë¶„ì„ê¸°"]}),e.jsx("p",{style:{opacity:.8,fontSize:"0.9rem",maxWidth:"600px",margin:"0 auto 20px"},children:"ì„¸ì´ë¸Œ íŒŒì¼(.lsv)ì„ ì—…ë¡œë“œí•˜ì—¬ ìºë¦­í„° ëŠ¥ë ¥ì¹˜ì™€ ì§„í–‰ ìƒí™©ì„ ë¶„ì„í•˜ì„¸ìš”."}),e.jsxs("div",{style:{position:"relative",overflow:"hidden",display:"inline-block"},children:[e.jsxs("button",{style:{background:"var(--accent-color)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(le,{size:18})," íŒŒì¼ ì„ íƒ ë° ë¶„ì„"]}),e.jsx("input",{type:"file",accept:".lsv,.save",onChange:a,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,cursor:"pointer"}})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:g?e.jsxs("div",{className:"glass-panel",style:{textAlign:"center",padding:"40px"},children:[e.jsx(Re,{size:32,className:"spin",style:{marginBottom:"15px",color:"var(--accent-color)"}}),e.jsx("p",{children:"ì„¸ì´ë¸Œ íŒŒì¼ ë¶„ì„ ì¤‘..."})]}):r.length===0?e.jsxs("div",{className:"glass-panel",style:{textAlign:"center",padding:"40px"},children:[e.jsx(le,{size:48,style:{opacity:.3,marginBottom:"20px"}}),e.jsx("p",{children:"ë¶„ì„ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤."})]}):r.map(s=>e.jsxs("div",{className:"glass-panel",style:{position:"relative",animation:"fadeIn 0.5s"},children:[e.jsx("button",{onClick:()=>m(s.id),style:{position:"absolute",top:"15px",right:"15px",background:"transparent",border:"none",color:"#f87171",cursor:"pointer"},children:e.jsx(Ae,{size:16})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"10px"},children:[e.jsx(le,{size:20,color:"var(--accent-color)"}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:s.filename}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.5},children:[new Date(s.createdAt?.toDate?s.createdAt.toDate():s.createdAt).toLocaleString()," â€¢ ",s.uploader]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"12px"},children:[e.jsxs("h4",{style:{margin:"0 0 10px",display:"flex",alignItems:"center",gap:"5px",fontSize:"0.9rem"},children:[e.jsx(Ie,{size:14})," ëŠ¥ë ¥ì¹˜ (Stats)"]}),s.stats?e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"STR",value:s.stats.STR,color:"#fca5a5"}),e.jsx(u,{label:"DEX",value:s.stats.DEX,color:"#86efac"}),e.jsx(u,{label:"CON",value:s.stats.CON,color:"#fbbf24"}),e.jsx(u,{label:"INT",value:s.stats.INT,color:"#93c5fd"}),e.jsx(u,{label:"WIS",value:s.stats.WIS,color:"#d8b4fe"}),e.jsx(u,{label:"CHA",value:s.stats.CHA,color:"#f472b6"})]}):e.jsx("p",{style:{fontSize:"0.8rem",opacity:.5},children:"ë°ì´í„° ì—†ìŒ"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"12px",flex:1},children:[e.jsxs("h4",{style:{margin:"0 0 10px",display:"flex",alignItems:"center",gap:"5px",fontSize:"0.9rem"},children:[e.jsx(re,{size:14})," ë©”íƒ€ ì •ë³´"]}),e.jsxs("div",{style:{fontSize:"0.8rem",display:"flex",flexDirection:"column",gap:"5px"},children:[e.jsxs("p",{style:{margin:0},children:["ðŸ“‚ ëª¨ë“œ: ",s.meta?.mode||"Unknown"]}),e.jsxs("p",{style:{margin:0},children:["ðŸ’¾ ë²„ì „: ",s.meta?.version||"Unknown"]}),e.jsxs("p",{style:{margin:0},children:["ðŸ“¦ í¬ê¸°: ",s.meta?.size||"Unknown"]})]})]}),s.companions&&e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"12px"},children:[e.jsx("h4",{style:{margin:"0 0 5px",fontSize:"0.8rem",opacity:.8},children:"í•¨ê»˜í•˜ëŠ” ë™ë£Œ"}),e.jsx("div",{style:{display:"flex",gap:"5px",flexWrap:"wrap"},children:s.companions.map((l,f)=>e.jsxs("span",{style:{background:"rgba(255,255,255,0.1)",padding:"2px 8px",borderRadius:"4px",fontSize:"0.7rem"},children:[l.img," ",l.name]},f))})]})]})]})]},s.id))})]})},De=[{id:"barbarian",name:"ë°”ë°”ë¦¬ì•ˆ",icon:Fe,color:"#fca5a5"},{id:"bard",name:"ë°”ë“œ",icon:Ue,color:"#f9a8d4"},{id:"cleric",name:"í´ë ˆë¦­",icon:$e,color:"#d1d5db"},{id:"druid",name:"ë“œë£¨ì´ë“œ",icon:He,color:"#bef264"},{id:"fighter",name:"íŒŒì´í„°",icon:re,color:"#93c5fd"},{id:"monk",name:"ëª½í¬",icon:qe,color:"#7dd3fc"},{id:"paladin",name:"íŒ”ë¼ë”˜",icon:re,color:"#fbbf24"},{id:"ranger",name:"ë ˆì¸ì €",icon:Je,color:"#86efac"},{id:"rogue",name:"ë¡œê·¸",icon:Ke,color:"#cbd5e1"},{id:"sorcerer",name:"ì†Œì„œëŸ¬",icon:Ye,color:"#c084fc"},{id:"warlock",name:"ì›Œë½",icon:Ge,color:"#e879f9"},{id:"wizard",name:"ìœ„ìžë“œ",icon:Ve,color:"#818cf8"}],H={width:"100%",padding:"16px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)",background:"rgba(0,0,0,0.2)",color:"white",marginBottom:"12px",fontSize:"1rem",transition:"border-color 0.2s, background 0.2s"},Y={width:"100%",padding:"16px",borderRadius:"12px",border:"none",fontWeight:"bold",fontSize:"1.05rem",marginTop:"0",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},we=({selected:t,onSelect:r})=>e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px",maxHeight:"200px",overflowY:"auto",margin:"20px 0",padding:"5px"},children:De.map(o=>e.jsxs("button",{onClick:()=>r(o),type:"button",style:{padding:"12px 8px",borderRadius:"12px",border:t?.id===o.id?`2px solid ${o.color}`:"1px solid rgba(255,255,255,0.05)",background:t?.id===o.id?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.2)",color:"white",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",transition:"all 0.2s",cursor:"pointer",transform:t?.id===o.id?"scale(1.05)":"scale(1)"},children:[e.jsx(o.icon,{size:24,color:o.color}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:t?.id===o.id?"bold":"normal"},children:o.name})]},o.id))}),de=({children:t,title:r,sub:o,onClose:g,error:c})=>e.jsx("div",{className:"modal-overlay",onClick:g,children:e.jsxs("div",{className:"modal-content",onClick:m=>m.stopPropagation(),children:[e.jsx("button",{onClick:g,style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255,255,255,0.1)",border:"none",borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",cursor:"pointer",zIndex:10},children:e.jsx(ue,{size:18})}),e.jsxs("div",{style:{padding:"30px 20px",textAlign:"center"},children:[r&&e.jsx("h2",{style:{fontSize:"2rem",marginBottom:"8px",fontWeight:"800",background:"linear-gradient(to right, #fff, #aaa)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:r}),o&&e.jsx("p",{style:{opacity:.7,fontSize:"0.95rem",marginBottom:"30px"},children:o}),t,c&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.2)",color:"#fca5a5",padding:"12px",borderRadius:"10px",marginTop:"20px",fontSize:"0.9rem",border:"1px solid rgba(239, 68, 68, 0.3)"},children:["âš ï¸ ",c]})]})]})}),ke=({onComplete:t,initialData:r,user:o,isMobile:g})=>{const c=r||o,[m,u]=d.useState(c?"profile_view":"landing"),[a,s]=d.useState(c?.nickname||""),[l,f]=d.useState(""),[n,i]=d.useState(c?De.find(h=>h.name===c.className):null),[y,S]=d.useState(""),[I,D]=d.useState(""),[N,w]=d.useState([]),[k,x]=d.useState(null),[b,v]=d.useState(!1),[C,z]=d.useState("");d.useEffect(()=>{r&&u("profile_view")},[r]);const W=()=>{s(""),f(""),i(null),S(""),D(""),x(null),z(""),w([])},T=()=>{z(""),u("landing")};d.useEffect(()=>{m==="join_camp"&&ne()},[m]);const ne=async()=>{v(!0);try{console.log("[Profile] Fetching active camps...");const R=(await he(E(j,"camps"))).docs.map(A=>({id:A.id,...A.data()}));w(R),console.log("[Profile] Camps found:",R.length)}catch(h){console.error("[Profile] Error fetching camps:",h),z("ì˜ì§€ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{v(!1)}},p=async h=>{h.preventDefault(),v(!0),z("");try{console.log("[Auth] Attempting login for:",a);const R=await X(B(j,"users_v2",a));if(!R.exists())throw new Error("ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” ëª¨í—˜ê°€ìž…ë‹ˆë‹¤.");const A=R.data();if(A.password!==l)throw new Error("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");if(console.log("[Auth] Login successful:",A),A.campId)try{await ee(B(j,"camps",A.campId),{members:be(a)})}catch(M){console.error("[Auth] Failed to update camp member list:",M)}localStorage.setItem("bg3_user_profile",JSON.stringify(A)),t(A)}catch(R){console.error("[Auth] Login failed:",R),z(R.message)}finally{v(!1)}},_=async()=>{if(!a||!l||!n||!y||!I){z("ëª¨ë“  ì •ë³´ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”.");return}v(!0);try{console.log("[Camp] Creating new camp:",y);const h=B(j,"users_v2",a);if((await X(h)).exists())throw new Error("ì´ë¯¸ ì¡´ìž¬í•˜ëŠ” ë‹‰ë„¤ìž„ìž…ë‹ˆë‹¤.");const A=y.trim(),M=B(j,"camps",A);if((await X(M)).exists())throw new Error("ì´ë¯¸ ì¡´ìž¬í•˜ëŠ” ì˜ì§€ ì´ë¦„ìž…ë‹ˆë‹¤.");const K={id:a,nickname:a,password:l,className:n.name,classId:n.id,isAdmin:!0,campId:A,createdAt:new Date().toISOString()},_e={id:A,name:y,password:I,leaderId:a,members:[a],createdAt:new Date().toISOString()};await Q(h,K),await Q(M,_e),console.log("[Camp] Camp and Admin created successfully"),localStorage.setItem("bg3_user_profile",JSON.stringify(K)),t(K)}catch(h){console.error("[Camp] Creation failed:",h),z(h.message)}finally{v(!1)}},U=async()=>{if(!a||!l||!n||!k||!I){z("ëª¨ë“  ì •ë³´ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”.");return}v(!0);try{console.log("[Camp] Joining camp:",k);const h=B(j,"users_v2",a);if((await X(h)).exists())throw new Error("ì´ë¯¸ ì¡´ìž¬í•˜ëŠ” ë‹‰ë„¤ìž„ìž…ë‹ˆë‹¤. (ë¡œê·¸ì¸ í•˜ì„¸ìš”)");const A=B(j,"camps",k),M=await X(A);if(!M.exists())throw new Error("ì˜ì§€ê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");const G=M.data();if(G.password!==I)throw new Error("ì˜ì§€ ìž…ìž¥ ì•”í˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");if(G.members&&G.members.length>=4)throw new Error("ì˜ì§€ ì •ì›ì´ ê½‰ ì°¼ìŠµë‹ˆë‹¤. (ìµœëŒ€ 4ëª…)");const K={id:a,nickname:a,password:l,className:n.name,classId:n.id,isAdmin:!1,campId:k,createdAt:new Date().toISOString()};await Q(h,K),await ee(A,{members:be(a)}),console.log("[Camp] Joined successfully"),localStorage.setItem("bg3_user_profile",JSON.stringify(K)),t(K)}catch(h){console.error("[Camp] Join failed:",h),z(h.message)}finally{v(!1)}},J=()=>{confirm("ì •ë§ ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(localStorage.removeItem("bg3_user_profile"),t(null),u("landing"),W())};return m==="profile_view"&&r?e.jsxs("div",{className:"glass-panel",style:{maxWidth:"450px",margin:"40px auto",padding:"40px",textAlign:"center"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:n?.color||"gray",margin:"0 auto 20px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 0 30px ${n?.color||"gray"}`},children:n&&e.jsx(n.icon,{size:50,color:"white"})}),e.jsx("h3",{style:{fontSize:"1.8rem",margin:"0 0 8px",fontWeight:"bold"},children:r.nickname}),e.jsx("span",{style:{fontSize:"0.95rem",opacity:.8,background:"rgba(255,255,255,0.1)",padding:"6px 12px",borderRadius:"20px"},children:r.className})]}),e.jsxs("div",{style:{textAlign:"left",background:"rgba(0,0,0,0.2)",padding:"25px",borderRadius:"16px"},children:[e.jsxs("p",{style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"15px",marginBottom:"15px"},children:[e.jsx("span",{style:{opacity:.6},children:"ì†Œì† ì•¼ì˜ì§€"}),e.jsx("b",{style:{fontSize:"1.1rem"},children:r.campId})]}),e.jsxs("p",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{opacity:.6},children:"ì§ì±…"}),e.jsx("b",{style:{color:r.isAdmin?"#f87171":"#4ade80"},children:r.isAdmin?"ì˜ì£¼ (Leader)":"ëŒ€ì› (Member)"})]})]}),e.jsxs("button",{onClick:J,style:{...Y,background:"rgba(248, 113, 113, 0.1)",border:"1px solid rgba(248, 113, 113, 0.3)",color:"#f87171",marginTop:"40px"},children:[e.jsx(Se,{size:20}),"ë¡œê·¸ì•„ì›ƒ"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsx("div",{className:"glass-panel",style:{maxWidth:"1000px",width:"100%",padding:g?"30px 20px":"60px 60px",textAlign:"center",minHeight:g?"auto":"550px",display:"flex",alignItems:"center",justifyContent:"center",margin:0},children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center",gap:g?"20px":"60px",width:"100%"},children:[e.jsx("div",{style:{flex:"1 1 300px",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},children:e.jsxs("div",{className:"logo-wrapper",style:{position:"relative",maxWidth:g?"240px":"420px",width:"100%"},children:[e.jsx("img",{src:q,alt:"Logo",onClick:()=>window.location.reload(),title:"ìƒˆë¡œê³ ì¹¨",style:{width:"100%",cursor:"pointer",transition:"transform 0.3s ease",display:"block"},onMouseOver:h=>h.currentTarget.style.transform="scale(1.03)",onMouseOut:h=>h.currentTarget.style.transform="scale(1)"}),e.jsx("div",{className:"logo-shine",style:{WebkitMaskImage:`url(${q})`,maskImage:`url(${q})`}})]})}),e.jsxs("div",{style:{flex:"1 1 300px",display:"flex",flexDirection:"column",gap:"20px",maxWidth:"350px",width:"100%"},children:[e.jsxs("button",{onClick:()=>{W(),u("login")},style:{...Y,background:"rgba(255,255,255,0.08)",color:"white",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(Xe,{size:20}),"ê¸°ì¡´ ëª¨í—˜ê°€ ë¡œê·¸ì¸"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",opacity:.3,fontSize:"0.8rem"},children:[e.jsx("div",{style:{flex:1,height:"1px",background:"white"}}),e.jsx("span",{children:"OR"}),e.jsx("div",{style:{flex:1,height:"1px",background:"white"}})]}),e.jsxs("button",{onClick:()=>{W(),u("join_camp")},style:{...Y,background:"linear-gradient(45deg, #7c3aed, #db2777)",color:"white",boxShadow:"0 4px 15px rgba(124, 58, 237, 0.3)"},children:[e.jsx(F,{size:20}),"ì•¼ì˜ì§€ í•©ë¥˜í•˜ê¸° (ì¼ë°˜)"]}),e.jsxs("button",{onClick:()=>{W(),u("create_camp")},style:{...Y,background:"linear-gradient(45deg, #ef4444, #f97316)",color:"white",boxShadow:"0 4px 15px rgba(239, 68, 68, 0.3)"},children:[e.jsx(se,{size:20}),"ìƒˆ ì•¼ì˜ì§€ ê±´ì„¤ (ê´€ë¦¬ìž)"]}),e.jsxs("p",{style:{marginTop:"10px",opacity:.8,fontSize:g?"0.75rem":"0.9rem",lineHeight:"1.5",fontWeight:"400",textAlign:"center",color:"rgba(255,255,255,0.7)"},children:["ë™ë£Œë“¤ê³¼ í•¨ê»˜ ë‚˜ë§Œì˜ ì´ì•¼ê¸°ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.",e.jsx("br",{}),e.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:"ë°œë”ìŠ¤ ê²Œì´íŠ¸ 3 ì›ì •ëŒ€"}),"ë¥¼ ìœ„í•œ",e.jsx("br",{}),"í•„ìˆ˜ ì»´íŒ¨ë‹ˆì–¸ ì•±"]})]})]})})}),m==="login"&&e.jsx(de,{title:"ë¡œê·¸ì¸",sub:"ë‹¤ì‹œ ì˜¤ì…¨êµ°ìš”, ëª¨í—˜ê°€ë‹˜.",onClose:T,error:C,children:e.jsxs("form",{onSubmit:p,children:[e.jsx("input",{type:"text",placeholder:"ë‹‰ë„¤ìž„",value:a,onChange:h=>s(h.target.value),style:H}),e.jsx("input",{type:"password",placeholder:"ë¹„ë°€ë²ˆí˜¸",value:l,onChange:h=>f(h.target.value),style:H}),e.jsx("button",{type:"submit",style:{...Y,background:"white",color:"black",marginTop:"20px"},disabled:b,children:b?"ì¸ì¦ í™•ì¸ ì¤‘...":"ì•¼ì˜ì§€ ìž…ìž¥"})]})}),m==="create_camp"&&e.jsxs(de,{title:"ì•¼ì˜ì§€ ê±´ì„¤",sub:"ë‹¹ì‹ ë§Œì˜ íŒŒí‹°ë¥¼ ì´ëŒì–´ë³´ì„¸ìš”.",onClose:T,error:C,children:[e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"10px",marginBottom:"15px"},children:[e.jsx("label",{style:{fontSize:"0.85rem",color:"#fca5a5",fontWeight:"bold",display:"block",marginBottom:"8px"},children:"ê´€ë¦¬ìž(ì˜ì£¼) ì •ë³´"}),e.jsx("input",{type:"text",placeholder:"ì˜ì£¼ ë‹‰ë„¤ìž„",value:a,onChange:h=>s(h.target.value),style:H}),e.jsx("input",{type:"password",placeholder:"ê°œì¸ ë¹„ë°€ë²ˆí˜¸",value:l,onChange:h=>f(h.target.value),style:{...H,marginBottom:0}})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"10px",marginBottom:"15px"},children:[e.jsx("label",{style:{fontSize:"0.85rem",color:"#c4b5fd",fontWeight:"bold",display:"block",marginBottom:"8px"},children:"ì˜ì§€(Room) ì„¤ì •"}),e.jsx("input",{type:"text",placeholder:"ì•¼ì˜ì§€ ì´ë¦„ (IDë¡œ ì‚¬ìš©ë¨)",value:y,onChange:h=>S(h.target.value),style:H}),e.jsx("input",{type:"text",placeholder:"ì˜ì§€ ìž…ìž¥ ì•”í˜¸ (íŒ€ì› ê³µìœ ìš©)",value:I,onChange:h=>D(h.target.value),style:{...H,borderColor:"#818cf8",color:"#818cf8",marginBottom:0}})]}),e.jsx("label",{style:{fontSize:"0.9rem",color:"white",opacity:.8,marginTop:"5px",display:"block"},children:"ë‚˜ì˜ ì§ì—… ì„ íƒ"}),e.jsx(we,{selected:n,onSelect:i})]}),e.jsx("button",{onClick:_,style:{...Y,background:"#ef4444",color:"white"},disabled:b,children:b?"ì˜í†  ì„ í¬ ì¤‘...":"ê±´ì„¤ ì™„ë£Œ ë° ìž…ìž¥"})]}),m==="join_camp"&&e.jsxs(de,{title:"ì•¼ì˜ì§€ í•©ë¥˜",sub:"ë™ë£Œë“¤ì´ ê¸°ë‹¤ë¦¬ê³  ìžˆìŠµë‹ˆë‹¤.",onClose:T,error:C,children:[e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px"},children:[!k&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("span",{style:{opacity:.7,fontSize:"0.9rem"},children:"ì°¸ì—¬ ê°€ëŠ¥í•œ ì˜ì§€"}),e.jsxs("button",{onClick:ne,style:{background:"none",border:"none",color:"var(--accent-color)",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(Re,{size:12})," ëª©ë¡ ê°±ì‹ "]})]}),e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"12px",padding:"10px",background:"rgba(0,0,0,0.2)"},children:b&&N.length===0?e.jsx("p",{style:{textAlign:"center",opacity:.5,padding:"20px"},children:"íƒìƒ‰ ì¤‘..."}):N.length===0?e.jsx("p",{style:{textAlign:"center",opacity:.5,padding:"20px"},children:"í™œì„±í™”ëœ ì˜ì§€ê°€ ì—†ìŠµë‹ˆë‹¤."}):N.map(h=>e.jsxs("div",{onClick:()=>x(h.id),style:{padding:"16px",marginBottom:"8px",borderRadius:"10px",cursor:"pointer",background:"rgba(255,255,255,0.05)",border:"1px solid transparent",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseOver:R=>{R.currentTarget.style.background="rgba(255,255,255,0.1)",R.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},onMouseOut:R=>{R.currentTarget.style.background="rgba(255,255,255,0.05)",R.currentTarget.style.borderColor="transparent"},children:[e.jsxs("span",{style:{fontWeight:"bold"},children:["ðŸ° ",h.name]}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.7,background:"rgba(0,0,0,0.3)",padding:"4px 8px",borderRadius:"4px"},children:[h.members?.length||0,"/4ëª…"]})]},h.id))})]}),k&&e.jsxs("div",{style:{animation:"fadeIn 0.3s"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("button",{onClick:()=>x(null),style:{background:"none",border:"none",color:"white",opacity:.5,cursor:"pointer"},children:"â†"}),e.jsx("h3",{style:{margin:0,fontSize:"1.2rem"},children:N.find(h=>h.id===k)?.name})]}),e.jsx("input",{type:"text",placeholder:"ì˜ì§€ ìž…ìž¥ ì•”í˜¸",value:I,onChange:h=>D(h.target.value),style:{...H,borderColor:"#818cf8",color:"#818cf8"}}),e.jsx("div",{style:{height:"10px"}}),e.jsx("input",{type:"text",placeholder:"ë‚´ ë‹‰ë„¤ìž„",value:a,onChange:h=>s(h.target.value),style:H}),e.jsx("input",{type:"password",placeholder:"ë‚´ ë¹„ë°€ë²ˆí˜¸",value:l,onChange:h=>f(h.target.value),style:H}),e.jsx("label",{style:{fontSize:"0.9rem",color:"white",opacity:.8,marginTop:"15px",display:"block"},children:"ë‚˜ì˜ ì§ì—… ì„ íƒ"}),e.jsx(we,{selected:n,onSelect:i})]})]}),k&&e.jsx("button",{onClick:U,style:{...Y,background:"var(--accent-color)",color:"white"},disabled:b,children:b?"ìž…ìž¥ ì¤‘...":"í•©ë¥˜í•˜ê¸°"})]})]})},gt=({user:t})=>{const[r,o]=d.useState([]),[g,c]=d.useState(!0);d.useEffect(()=>{if(!t?.campId)return;const a=P(E(j,"users_v2"),O("campId","==",t.campId)),s=$(a,l=>{const f=l.docs.map(n=>({id:n.id,...n.data()}));o(f),c(!1)});return()=>s()},[t?.campId]);const m=async a=>{if(window.confirm(`ì •ë§ '${a.nickname}' ë‹˜ì„ ì˜ì§€ì—ì„œ ì¶”ë°©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))try{await ie(B(j,"users_v2",a.id));const s=B(j,"camps",t.campId);await ee(s,{members:et(a.nickname)}),alert("ì¶”ë°©ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(s){console.error("Kick failed:",s),alert("ì¶”ë°© ì‹¤íŒ¨: "+s.message)}},u=async()=>{if(!window.confirm(`âš ï¸ ê²½ê³ : ì˜ì§€ë¥¼ í­íŒŒí•˜ë©´ ëª¨ë“  ë°ì´í„°ì™€ ë©¤ë²„ê°€ ì‚­ì œë©ë‹ˆë‹¤.
ì •ë§ ì´ ì•¼ì˜ì§€ë¥¼ í•´ì²´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))return;if(prompt("ì˜ì§€ë¥¼ ì‚­ì œí•˜ë ¤ë©´ 'ì˜ì§€ í­íŒŒ'ë¼ê³  ìž…ë ¥í•˜ì„¸ìš”.")!=="ì˜ì§€ í­íŒŒ")return alert("ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.");try{c(!0);const l=tt(j),f=B(j,"camps",t.campId);l.delete(f),r.forEach(y=>{const S=B(j,"users_v2",y.id);l.delete(S)});const n=P(E(j,"chats"),O("campId","==",t.campId));(await he(n)).forEach(y=>{l.delete(y.ref)}),await l.commit(),alert("ì•¼ì˜ì§€ê°€ ì—­ì‚¬ ì†ìœ¼ë¡œ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤."),window.location.reload()}catch(l){console.error("Destroy failed:",l),alert("ì‚­ì œ ì‹¤íŒ¨: "+l.message)}finally{c(!1)}};return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",paddingBottom:"80px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"30px",marginBottom:"30px",border:"1px solid var(--accent-color)",background:"rgba(50, 0, 0, 0.3)"},children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"0 0 10px",color:"#fca5a5"},children:[e.jsx(re,{})," ì˜ì£¼ ê´€ë¦¬ì‹¤ (Admin)"]}),e.jsxs("p",{style:{opacity:.8,fontSize:"0.9rem"},children:["í˜„ìž¬ ì•¼ì˜ì§€: ",e.jsx("b",{children:t.campId})," ",e.jsx("br",{}),"ê¶Œí•œ: ",e.jsx("span",{style:{color:"var(--accent-color)"},children:"Master"})]})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"20px",background:"rgba(255,255,255,0.05)",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs("h3",{style:{margin:0,fontSize:"1.1rem"},children:["ëŒ€ì› ëª©ë¡ (",r.length,"/4)"]})}),r.map(a=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"45px",height:"45px",borderRadius:"50%",background:a.isAdmin?"var(--accent-color)":"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:a.isAdmin?e.jsx(se,{size:22,color:"white"}):e.jsx(Ce,{size:22})}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px",fontSize:"1.1rem"},children:[a.nickname,e.jsx("span",{style:{fontSize:"0.7rem",padding:"3px 8px",borderRadius:"6px",background:"rgba(255,255,255,0.1)",opacity:.8},children:a.className||"ëª¨í—˜ê°€"})]}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.5,marginTop:"4px"},children:a.isAdmin?"ì˜ì£¼ (Leader)":"ëŒ€ì› (Member)"})]})]}),!a.isAdmin&&e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("button",{onClick:async()=>{if(window.confirm(`'${a.nickname}' ë‹˜ì„ ê´€ë¦¬ìžë¡œ ìž„ëª…í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))try{const{updateDoc:s,doc:l}=await xe(async()=>{const{updateDoc:f,doc:n}=await import("./vendor-DH5qwxLr.js").then(i=>i.a9);return{updateDoc:f,doc:n}},[]);await s(l(j,"users_v2",a.id),{isAdmin:!0,role:"Admin"}),alert(`${a.nickname} ë‹˜ì´ ê´€ë¦¬ìžê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.`)}catch(s){console.error(s),alert("ê¶Œí•œ ë¶€ì—¬ ì‹¤íŒ¨: "+s.message)}},style:{padding:"10px 15px",borderRadius:"8px",background:"rgba(74, 222, 128, 0.1)",border:"1px solid rgba(74, 222, 128, 0.3)",color:"#4ade80",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(se,{size:16})," ìž„ëª…"]}),e.jsxs("button",{onClick:()=>m(a),style:{padding:"10px 15px",borderRadius:"8px",background:"rgba(248, 113, 113, 0.1)",border:"1px solid rgba(248, 113, 113, 0.3)",color:"#f87171",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(Qe,{size:16})," ì¶”ë°©"]})]})]},a.id)),r.length===0&&!g&&e.jsx("div",{style:{padding:"40px",textAlign:"center",opacity:.5},children:"ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤."})]}),e.jsxs("div",{style:{marginTop:"50px",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"30px"},children:[e.jsxs("h3",{style:{color:"#ef4444",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Ze,{})," ìœ„í—˜ êµ¬ì—­"]}),e.jsxs("div",{className:"glass-panel",style:{borderColor:"#ef4444",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 5px"},children:"ì˜ì§€ í­íŒŒ"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:"ì´ ì•¼ì˜ì§€ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œí•©ë‹ˆë‹¤."})]}),e.jsx("button",{onClick:u,style:{background:"#ef4444",color:"white",border:"none",padding:"12px 20px",borderRadius:"8px",fontWeight:"bold",cursor:"pointer"},children:"í­íŒŒ ì‹¤í–‰"})]})]})]})},mt=({user:t})=>{const[r,o]=d.useState([]),[g,c]=d.useState(!1),[m,u]=d.useState({title:"",content:"",image:null}),a=d.useRef(null);d.useEffect(()=>{if(!t?.campId)return;const n=P(E(j,"tactics"),O("campId","==",t.campId),ge("createdAt","desc")),i=$(n,y=>{const S=y.docs.map(I=>({id:I.id,...I.data()}));o(S)});return()=>i()},[t?.campId]);const s=n=>{const i=n.target.files[0];if(i){if(i.size>1024*1024)return alert("ì´ë¯¸ì§€ëŠ” 1MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");const y=new FileReader;y.onloadend=()=>{u(S=>({...S,image:y.result}))},y.readAsDataURL(i)}},l=async n=>{if(n.preventDefault(),!(!m.title||!t.campId))try{await te(E(j,"tactics"),{...m,campId:t.campId,author:t.nickname,createdAt:V()}),c(!1),u({title:"",content:"",image:null})}catch(i){console.error(i),alert("ê²Œì‹œ ì‹¤íŒ¨")}},f=async n=>{window.confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&await ie(B(j,"tactics",n))};return e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",paddingBottom:"80px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px",marginBottom:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",gap:"10px",margin:0},children:[e.jsx(pe,{className:"text-accent"})," ì „ìˆ  ê²Œì‹œíŒ (Tactics Board)"]}),e.jsx("p",{style:{margin:"5px 0 0",opacity:.7,fontSize:"0.9rem"},children:"ê³µëžµê³¼ íŒì„ ê³µìœ í•˜ì„¸ìš”."})]}),e.jsxs("button",{onClick:()=>c(!0),style:{background:"var(--accent-color)",color:"white",border:"none",padding:"10px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(nt,{size:18})," ì „ìˆ  ê³µìœ "]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:r.map(n=>e.jsxs("div",{className:"glass-panel",style:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"},children:[n.image&&e.jsx("div",{style:{width:"100%",height:"200px",overflow:"hidden",background:"#000"},children:e.jsx("img",{src:n.image,alt:"tactic",style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs("div",{style:{padding:"20px",flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"10px"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.2rem"},children:n.title}),(t.isAdmin||t.nickname===n.author)&&e.jsx("button",{onClick:()=>f(n.id),style:{background:"none",border:"none",color:"rgba(255,255,255,0.3)",cursor:"pointer"},children:e.jsx(Ae,{size:16})})]}),e.jsx("p",{style:{fontSize:"0.9rem",opacity:.8,whiteSpace:"pre-wrap",lineHeight:"1.5"},children:n.content})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"rgba(0,0,0,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.8rem",opacity:.6},children:[e.jsxs("span",{children:["by ",n.author]}),n.createdAt&&e.jsx("span",{children:new Date(n.createdAt?.toDate?n.createdAt.toDate():n.createdAt).toLocaleDateString()})]})]},n.id))}),g&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(5px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},onClick:()=>c(!1),children:e.jsxs("div",{className:"glass-panel",style:{width:"500px",padding:"30px"},onClick:n=>n.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 20px"},children:"ìƒˆ ì „ìˆ  ê³µìœ "}),e.jsxs("form",{onSubmit:l,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx("input",{placeholder:"ì œëª© (ì˜ˆ: ë¼íŒŒì—˜ ì „íˆ¬ í¬ì§€ì…”ë‹)",value:m.title,onChange:n=>u({...m,title:n.target.value}),required:!0,style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsx("textarea",{placeholder:"ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”...",value:m.content,onChange:n=>u({...m,content:n.target.value}),rows:5,style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px",resize:"vertical"}}),e.jsxs("div",{style:{border:"1px dashed rgba(255,255,255,0.3)",borderRadius:"8px",padding:"20px",textAlign:"center"},children:[m.image?e.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[e.jsx("img",{src:m.image,alt:"Preview",style:{maxHeight:"200px",maxWidth:"100%",borderRadius:"8px"}}),e.jsx("button",{type:"button",onClick:()=>u({...m,image:null}),style:{position:"absolute",top:-10,right:-10,background:"red",borderRadius:"50%",width:"24px",height:"24px",border:"none",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ue,{size:14})})]}):e.jsxs("button",{type:"button",onClick:()=>a.current.click(),style:{background:"none",border:"none",color:"var(--accent-color)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[e.jsx(ze,{size:32}),e.jsx("span",{children:"ì´ë¯¸ì§€ ì¶”ê°€ (ìŠ¤í¬ë¦°ìƒ· ë“±)"})]}),e.jsx("input",{type:"file",ref:a,onChange:s,accept:"image/*",style:{display:"none"}})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[e.jsx("button",{type:"button",onClick:()=>c(!1),style:{flex:1,padding:"12px",borderRadius:"8px",background:"transparent",border:"1px solid rgba(255,255,255,0.3)",color:"white",cursor:"pointer"},children:"ì·¨ì†Œ"}),e.jsx("button",{type:"submit",style:{flex:1,padding:"12px",borderRadius:"8px",background:"var(--accent-color)",border:"none",color:"white",cursor:"pointer"},children:"ê²Œì‹œ"})]})]})]})})]})},ht=({user:t,onClose:r})=>{const[o,g]=d.useState([]),[c,m]=d.useState(!0);d.useEffect(()=>{if(!t?.campId)return;const a=P(E(j,"users_v2"),O("campId","==",t.campId)),s=$(a,l=>{const f=Date.now(),n=l.docs.map(i=>{const y=i.data(),S=y.lastSeen?.toMillis?y.lastSeen.toMillis():0,I=f-S<120*1e3;return{id:i.id,...y,isOnline:I,lastSeenAgo:Math.floor((f-S)/6e4)}});n.sort((i,y)=>i.isOnline===y.isOnline?i.nickname.localeCompare(y.nickname):y.isOnline?1:-1),g(n),m(!1)});return()=>s()},[t?.campId]);const u=async a=>{if(window.confirm(`${a.nickname}ë‹˜ì„ ì •ë§ ê¹¨ìš°ì‹œê² ìŠµë‹ˆê¹Œ? (ì•Œë¦¼ ë°œì†¡)`))try{await te(E(j,"camps",t.campId,"notifications"),{type:"WAKE_UP",targetUid:a.id,sender:t.nickname,read:!1,timestamp:V()}),alert("â° ê¸°ìƒ ë‚˜íŒ”ì„ ë¶ˆì—ˆìŠµë‹ˆë‹¤!")}catch(s){console.error(s),alert("ì•Œë¦¼ ë°œì†¡ ì‹¤íŒ¨")}};return ae.createPortal(e.jsx("div",{className:"modal-overlay",onClick:r,children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),style:{maxWidth:"400px",padding:"0",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"20px",background:"rgba(255,255,255,0.05)",borderBottom:"1px solid rgba(255,255,255,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(F,{className:"text-accent"})," ìƒì¡´ìž ëª©ë¡ (",o.filter(a=>a.isOnline).length,"ëª… ì ‘ì†)"]}),e.jsx("button",{onClick:r,style:{background:"none",border:"none",color:"white",opacity:.5,cursor:"pointer"},children:"âœ•"})]}),e.jsx("div",{style:{padding:"20px",maxHeight:"400px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"10px"},children:c?e.jsx("p",{style:{textAlign:"center",opacity:.5},children:"ëª…ë‹¨ í™•ì¸ ì¤‘..."}):o.map(a=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",borderRadius:"12px",background:a.isOnline?"rgba(74, 222, 128, 0.1)":"rgba(255, 255, 255, 0.03)",border:a.isOnline?"1px solid rgba(74, 222, 128, 0.3)":"1px solid rgba(255, 255, 255, 0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",background:a.isOnline?"#4ade80":"#94a3b8",boxShadow:a.isOnline?"0 0 10px #4ade80":"none"}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold"},children:[a.nickname," ",a.id===t.id&&e.jsx("span",{style:{fontSize:"0.8rem",opacity:.5},children:"(ë‚˜)"})]}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:[a.className," â€¢ ",a.isOnline?"ì˜¨ë¼ì¸":`${a.lastSeenAgo}ë¶„ ì „ ì ‘ì†`]})]})]}),!a.isOnline&&a.id!==t.id&&e.jsxs("button",{onClick:()=>u(a),style:{padding:"6px 12px",borderRadius:"20px",border:"none",background:"rgba(255,255,255,0.1)",color:"white",fontSize:"0.8rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(at,{size:12})," ê¹¨ìš°ê¸°"]})]},a.id))})]})}),document.body)},ut=()=>{const[t,r]=d.useState("home"),[o,g]=d.useState(window.innerWidth<768),[c,m]=d.useState(0),[u,a]=d.useState(!1),[s,l]=d.useState(()=>{try{return JSON.parse(localStorage.getItem("bg3_user_profile"))}catch{return null}});if(d.useEffect(()=>{const n=()=>g(window.innerWidth<768);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),d.useEffect(()=>{},[s]),d.useEffect(()=>{if(!s?.id)return;const n=async()=>{try{await ee(B(j,"users_v2",s.id),{lastSeen:V()})}catch(y){console.error("Heartbeat fail",y)}};n();const i=setInterval(n,6e4);return()=>clearInterval(i)},[s?.id]),d.useEffect(()=>{if(!s?.campId)return;const n=P(E(j,"users_v2"),O("campId","==",s.campId)),i=$(n,y=>{m(y.size)});return()=>i()},[s?.campId]),d.useEffect(()=>{if(!s?.campId||!s?.id)return;const n=P(E(j,"camps",s.campId,"notifications"),O("targetUid","==",s.id),O("read","==",!1)),i=$(n,y=>{y.docChanges().forEach(S=>{if(S.type==="added"){const I=S.doc.data();I.type==="WAKE_UP"&&(new Audio("https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3").play().catch(N=>console.log("Audio play failed",N)),alert(`â° ${I.sender}ë‹˜ì´ ë‹¹ì‹ ì„ ê¹¨ìš°ê³  ìžˆìŠµë‹ˆë‹¤! ì–¼ë¥¸ ì¼ì–´ë‚˜ì„¸ìš”!`),ee(S.doc.ref,{read:!0}))}})});return()=>i()},[s?.campId,s?.id]),!s)return e.jsx(ke,{onComplete:()=>window.location.reload(),isMobile:o});const f=()=>{const n={user:s,isMobile:o,onlineUsersCount:c,setShowSurvivors:a};switch(t){case"home":return e.jsx(ve,{...n,setActiveTab:r});case"chat":return e.jsx(ct,{...n});case"calendar":return e.jsx(pt,{...n});case"save":return e.jsx(xt,{...n});case"admin":return e.jsx(gt,{...n});case"tactics":return e.jsx(mt,{...n});case"profile":return e.jsx(ke,{user:s,onComplete:()=>window.location.reload(),isMobile:o});default:return e.jsx(ve,{...n,setActiveTab:r})}};return e.jsxs("div",{className:"layout-container",style:{display:"flex",minHeight:"100vh",color:"#e2e8f0",fontFamily:"Pretendard, sans-serif"},children:[e.jsx(dt,{activeTab:t,setActiveTab:r,isMobile:o,user:s,onlineUsersCount:c,setShowSurvivors:a}),e.jsx("main",{style:{flex:1,padding:o?"20px 20px 90px":"40px",overflowY:"auto",position:"relative"},children:f()}),u&&e.jsx(ht,{user:s,onClose:()=>a(!1)})]})};function ft(){return e.jsx(ut,{})}class yt extends L.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,o){this.setState({error:r,errorInfo:o}),console.error("Uncaught error:",r,o)}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"20px",color:"white",background:"#333"},children:[e.jsx("h1",{children:"Something went wrong."}),e.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),e.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"20px",padding:"10px"},children:"Reload"})]}):this.props.children}}st.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(yt,{children:e.jsx(ft,{})})}));
