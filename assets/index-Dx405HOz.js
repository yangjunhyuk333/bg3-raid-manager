import{i as ke,g as Ce,R as U,H as Ie,M as me,C as Y,F as he,a as ze,U as J,j as e,L as ue,S as Re,r as d,A as fe,q as F,c as _,o as Q,l as ie,b as oe,d as De,w as q,e as K,B as Ae,X as Z,I as ye,f as Be,h as ee,s as le,P as be,k as _e,T as de,m as Ee,n as Ne,p as te,t as D,u as G,v as Te,x as se,y as je,z as X,D as We,E as Me,G as Le,J as Oe,K as Pe,N as Fe,O as Ue,Z as He,W as qe,Q as $e,V as Je,Y as ve,_ as $,$ as ce,a0 as ne,a1 as Ke,a2 as Ve,a3 as Ye,a4 as Ge,a5 as Xe,a6 as Qe}from"./vendor-Dxo_RTKH.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))b(s);new MutationObserver(s=>{for(const p of s)if(p.type==="childList")for(const l of p.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&b(l)}).observe(document,{childList:!0,subtree:!0});function c(s){const p={};return s.integrity&&(p.integrity=s.integrity),s.referrerPolicy&&(p.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?p.credentials="include":s.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function b(s){if(s.ep)return;s.ep=!0;const p=c(s);fetch(s.href,p)}})();const Ze="modulepreload",et=function(t){return"/bg3-raid-manager/"+t},pe={},tt=function(i,c,b){let s=Promise.resolve();if(c&&c.length>0){let n=function(r){return Promise.all(r.map(g=>Promise.resolve(g).then(o=>({status:"fulfilled",value:o}),o=>({status:"rejected",reason:o}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),m=l?.nonce||l?.getAttribute("nonce");s=n(c.map(r=>{if(r=et(r),r in pe)return;pe[r]=!0;const g=r.endsWith(".css"),o=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${o}`))return;const u=document.createElement("link");if(u.rel=g?"stylesheet":Ze,g||(u.as="script"),u.crossOrigin="",u.href=r,m&&u.setAttribute("nonce",m),document.head.appendChild(u),g)return new Promise((h,f)=>{u.addEventListener("load",h),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})}))}function p(l){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=l,window.dispatchEvent(m),!m.defaultPrevented)throw l}return s.then(l=>{for(const m of l||[])m.status==="rejected"&&p(m.reason);return i().catch(p)})},H="/bg3-raid-manager/assets/logo-BLpM7sGS.svg",st={apiKey:"AIzaSyAsbaWbo3DoSTrRFhkaf9XujWPpmeGSjAE",authDomain:"bg3-raid-manager.firebaseapp.com",projectId:"bg3-raid-manager",storageBucket:"bg3-raid-manager.firebasestorage.app",messagingSenderId:"773826713403",appId:"1:773826713403:web:c15fdfca708d47f4fcc91e"},nt=ke(st),w=Ce(nt);console.log("🔥 Firebase Connected (Real DB Mode)");const rt=({activeTab:t,setActiveTab:i,isMobile:c,user:b})=>{const[s,p]=U.useState(0),[l,m]=U.useState(4),n=b?.isAdmin===!0,[r,g]=U.useState(!1),[o,u]=U.useState(!1);U.useEffect(()=>{const y=j=>{j.shiftKey&&j.altKey&&(j.key==="R"||j.key==="r")&&g(k=>!k)};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[]);const h=()=>{localStorage.clear(),sessionStorage.clear(),setUser(null),window.location.reload()},f=[{id:"home",label:"홈",icon:Ie},{id:"chat",label:"채팅",icon:me},{id:"calendar",label:"일정",icon:Y},{id:"tactics",label:"전술판",icon:he},{id:"save",label:"세이브",icon:ze},{id:"profile",label:"프로필",icon:J}];if(n&&f.push({id:"admin",label:"야영지 관리",icon:Re}),c){const y=f.slice(0,4);return f.find(j=>j.id==="profile"),e.jsxs("nav",{className:"glass",style:{position:"fixed",bottom:0,left:0,right:0,height:"75px",zIndex:1e3,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"16px 16px 0 0",borderTop:"1px solid rgba(255,255,255,0.15)",backdropFilter:"blur(25px)",background:"rgba(10, 10, 20, 0.95)",padding:"0 10px",paddingBottom:"safe-area-inset-bottom"},children:[y.map(j=>{const k=j.icon,S=t===j.id;return e.jsxs("button",{onClick:()=>i(j.id),style:{background:S?"rgba(255,255,255,0.1)":"transparent",borderRadius:"12px",border:"none",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",color:S?"var(--accent-color)":"rgba(255,255,255,0.5)",height:"55px",flex:1,margin:"0 2px"},children:[e.jsx(k,{size:S?26:24,strokeWidth:S?2.5:2}),S&&e.jsx("span",{style:{fontSize:"10px"},children:j.label})]},j.id)}),e.jsxs("button",{onClick:()=>i("profile"),style:{background:t==="profile"?"rgba(255,255,255,0.1)":"transparent",borderRadius:"12px",border:"none",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",color:t==="profile"?"var(--accent-color)":"rgba(255,255,255,0.5)",height:"55px",flex:1,margin:"0 2px"},children:[e.jsx(J,{size:t==="profile"?26:24,strokeWidth:t==="profile"?2.5:2}),t==="profile"&&e.jsx("span",{style:{fontSize:"10px"},children:"프로필"})]})]})}return e.jsxs("aside",{className:"glass",style:{width:"280px",height:"100vh",margin:0,padding:"25px",display:"flex",flexDirection:"column",borderRadius:0,borderRight:"1px solid rgba(255,255,255,0.1)",background:"rgba(20, 20, 30, 0.4)",position:"sticky",top:0},children:[e.jsxs("div",{style:{padding:"0 0 25px",textAlign:"center",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[r&&e.jsx("button",{id:"db-reset-btn",onClick:async()=>{if(confirm("⚠️ 경고: 정말로 DB를 초기화하시겠습니까? 돌이킬 수 없습니다.")){const{collection:y,getDocs:j,deleteDoc:k}=await tt(async()=>{const{collection:E,getDocs:a,deleteDoc:v}=await import("./vendor-Dxo_RTKH.js").then(C=>C.a7);return{collection:E,getDocs:a,deleteDoc:v}},[]);(await j(y(w,"users_v2"))).forEach(E=>k(E.ref)),(await j(y(w,"camps"))).forEach(E=>k(E.ref)),alert("초기화 완료. 재접속합니다."),h()}},style:{background:"red",color:"white",border:"none",padding:"5px",marginBottom:"10px",fontSize:"0.7rem",cursor:"pointer",width:"100%"},children:"[ADMIN] DB 초기화"}),e.jsxs("div",{className:"logo-wrapper",style:{position:"relative",width:"100%",marginBottom:"10px"},children:[e.jsx("img",{src:H,alt:"BG3",style:{width:"100%",height:"auto",display:"block"},onError:y=>y.target.style.display="none"}),e.jsx("div",{className:"logo-shine",style:{WebkitMaskImage:`url(${H})`,maskImage:`url(${H})`}})]}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 10px",background:"rgba(0,0,0,0.3)",borderRadius:"12px",fontSize:"0.75rem",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(J,{size:12,color:"#4ade80"}),e.jsxs("span",{style:{color:"#4ade80"},children:[s,"/",l,"명 접속 중"]})]})]}),e.jsx("nav",{style:{display:"flex",flexDirection:"column",gap:"10px",marginTop:"20px",flex:1},children:f.map(y=>{const j=y.icon;return e.jsxs("button",{onClick:()=>i(y.id),style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:t===y.id?"rgba(255,255,255,0.15)":"transparent",color:t===y.id?"white":"rgba(255,255,255,0.7)",borderRadius:"12px",transition:"all 0.2s",border:"none",cursor:"pointer",fontSize:"0.95rem",fontWeight:t===y.id?"bold":"normal"},children:[e.jsx(j,{size:20,color:t===y.id?"var(--accent-color)":"currentColor"}),y.label]},y.id)})}),e.jsxs("div",{style:{marginTop:"auto",paddingTop:"20px",borderTop:"1px solid rgba(255,255,255,0.1)",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"var(--accent-color)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(J,{size:20,color:"white"})}),e.jsx("div",{style:{flex:1,overflow:"hidden"},children:e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:b.nickname})}),e.jsx("button",{onClick:()=>u(!0),style:{background:"rgba(248, 113, 113, 0.15)",border:"1px solid rgba(248, 113, 113, 0.4)",borderRadius:"8px",padding:"10px 15px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",cursor:"pointer",color:"#f87171",fontWeight:"bold",fontSize:"0.85rem"},title:"로그아웃",children:e.jsx(ue,{size:16})})]}),o&&e.jsx("div",{className:"modal-overlay",onClick:()=>u(!1),children:e.jsxs("div",{className:"modal-content",onClick:y=>y.stopPropagation(),style:{maxWidth:"350px",padding:"30px",textAlign:"center"},children:[e.jsx("h3",{style:{fontSize:"1.4rem",marginBottom:"10px",marginTop:"10px"},children:"로그아웃"}),e.jsxs("p",{style:{opacity:.8,marginBottom:"30px",lineHeight:"1.5"},children:["정말 로그아웃 하시겠습니까?",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.8rem",opacity:.5},children:"(모든 로그인 데이터가 삭제됩니다)"})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>u(!1),style:{flex:1,padding:"14px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"transparent",color:"white",cursor:"pointer",fontWeight:"bold"},children:"취소"}),e.jsx("button",{onClick:h,style:{flex:1,padding:"14px",borderRadius:"12px",border:"none",background:"linear-gradient(45deg, #ef4444, #dc2626)",color:"white",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(239,68,68,0.3)"},children:"확인"})]})]})})]})},re=({user:t,setActiveTab:i})=>{const[c,b]=d.useState([]),[s,p]=d.useState(!0),[l,m]=d.useState(()=>{const r=localStorage.getItem("bg3_daily_goals");return r?JSON.parse(r):[{id:1,text:"긴 휴식 취하기 (주문 슬롯 복구)",checked:!1},{id:2,text:"야영지 물자 확인",checked:!1},{id:3,text:"상인에게 잡동사니 판매",checked:!1},{id:4,text:"동료 호감도 대화",checked:!1}]});d.useEffect(()=>{localStorage.setItem("bg3_daily_goals",JSON.stringify(l))},[l]),d.useEffect(()=>{(async()=>{try{const g=F(_(w,"schedules"),Q("date"),ie(2)),u=(await oe(g)).docs.map(h=>({id:h.id,...h.data()}));b(u)}catch(g){console.error(g)}finally{p(!1)}})()},[]);const n=({icon:r,title:g,desc:o,onClick:u,color:h})=>e.jsxs("div",{onClick:u,className:"glass-panel",style:{padding:"20px",cursor:"pointer",transition:"transform 0.2s",display:"flex",flexDirection:"column",gap:"10px"},onMouseEnter:f=>f.currentTarget.style.transform="translateY(-5px)",onMouseLeave:f=>f.currentTarget.style.transform="translateY(0)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{padding:"10px",borderRadius:"12px",background:`rgba(${h}, 0.2)`},children:e.jsx(r,{color:`rgb(${h})`,size:24})}),e.jsx(De,{size:16,style:{opacity:.5}})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"5px 0",fontSize:"1.1rem"},children:g}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:o})]})]});return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"30px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"40px",background:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",textAlign:"center"},children:[e.jsxs("h1",{style:{fontSize:"2rem",marginBottom:"10px",textShadow:"0 2px 10px rgba(0,0,0,0.5)"},children:["어서오세요, ",e.jsx("span",{style:{color:"var(--accent-color)"},children:t?.nickname||"모험가"}),"님"]}),e.jsxs("p",{style:{opacity:.8,maxWidth:"600px",margin:"0 auto"},children:["발더스 게이트 원정대에 오신 것을 환영합니다. ",e.jsx("br",{}),"오늘의 모험을 시작하기 전에 일정을 확인하고 파티원들과 소통해보세요."]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px"},children:[e.jsx(n,{icon:Y,title:"레이드 일정",desc:"다가오는 모험 확인하기",onClick:()=>i("calendar"),color:"248, 113, 113"}),e.jsx(n,{icon:fe,title:"세이브 분석",desc:"내 캐릭터 스펙 확인",onClick:()=>i("save"),color:"167, 139, 250"}),e.jsx(n,{icon:me,title:"작전 회의실",desc:"파티원들과 대화하기",onClick:()=>i("chat"),color:"52, 211, 153"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"0 0 20px"},children:[e.jsx(Y,{size:18})," 다가오는 일정"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:s?e.jsx("p",{style:{opacity:.5},children:"로딩 중..."}):c.length===0?e.jsx("p",{style:{opacity:.5},children:"예정된 일정이 없습니다."}):c.map(r=>e.jsxs("div",{style:{padding:"12px",background:"rgba(255,255,255,0.05)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"15px"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"5px 10px",background:"rgba(0,0,0,0.3)",borderRadius:"6px"},children:[e.jsxs("span",{style:{fontSize:"0.7rem",opacity:.7},children:[r.date?.split("-")[1],"월"]}),e.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:r.date?.split("-")[2]})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"bold"},children:r.title}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:[r.time," • ",r.type==="raid"?"⚔️ 레이드":"📜 스토리"]})]})]},r.id))})]})})]})},at=({user:t})=>{const[i,c]=d.useState([]),[b,s]=d.useState(""),[p,l]=d.useState(null),[m,n]=d.useState(!0),r=d.useRef(null),g=d.useRef(null);d.useEffect(()=>{if(!t?.campId)return;const h=F(_(w,"chats"),q("campId","==",t.campId),ie(50)),f=K(h,y=>{const j=y.docs.map(k=>({id:k.id,...k.data(),timestamp:k.data().timestamp?.toDate().toISOString()||new Date().toISOString()}));j.sort((k,S)=>new Date(k.timestamp)-new Date(S.timestamp)),c(j),n(!1)});return()=>f()},[t?.campId]),d.useEffect(()=>{r.current?.scrollIntoView({behavior:"smooth"})},[i]);const o=h=>{const f=h.target.files[0];if(f){if(f.size>500*1024){alert("이미지 크기는 500KB 이하여야 합니다.");return}const y=new FileReader;y.onloadend=()=>{l(y.result)},y.readAsDataURL(f)}},u=async h=>{if(h.preventDefault(),!b.trim()&&!p||!t?.campId)return;const f=b,y=p;s(""),l(null);try{await ee(_(w,"chats"),{text:f,image:y,sender:t.nickname,uid:t.id,userClass:t.className||"Unknown",campId:t.campId,timestamp:le()})}catch(j){console.error("Error sending message: ",j),alert("전송 실패!")}};return t?.campId?e.jsxs("div",{className:"glass-panel",style:{height:"100%",minHeight:"500px",display:"flex",flexDirection:"column",padding:0},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Ae,{color:"#4fd1c5"})," 파티 작전 회의실"]}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.7},children:["🔒 ",t.campId," 야영지 (보안 연결됨)"]})})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[m&&e.jsx("div",{style:{textAlign:"center",opacity:.5},children:"채팅방 연결 중..."}),i.length===0&&!m&&e.jsxs("div",{style:{textAlign:"center",opacity:.3,marginTop:"20px"},children:[e.jsx("p",{children:"아직 대화가 없습니다."}),e.jsx("p",{children:"작전을 시작해보세요!"})]}),i.map(h=>{const f=h.uid===t.id;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:f?"flex-end":"flex-start"},children:[e.jsx("div",{style:{fontSize:"0.8rem",marginBottom:"4px",opacity:.7,display:"flex",alignItems:"center",gap:"4px"},children:!f&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:["[",h.userClass,"]"]}),h.sender]})}),e.jsxs("div",{style:{background:f?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(255, 255, 255, 0.1)",padding:"12px 16px",borderRadius:f?"16px 16px 0 16px":"16px 16px 16px 0",maxWidth:"70%",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.1)",wordBreak:"break-word"},children:[h.image&&e.jsx("img",{src:h.image,alt:"attached",style:{maxWidth:"100%",borderRadius:"8px",marginBottom:h.text?"10px":"0"}}),h.text]}),e.jsx("span",{style:{fontSize:"0.7rem",opacity:.4,marginTop:"4px"},children:new Date(h.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},h.id)}),e.jsx("div",{ref:r})]}),e.jsxs("form",{onSubmit:u,style:{padding:"20px",background:"rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",gap:"10px",borderRadius:"0 0 16px 16px"},children:[p&&e.jsxs("div",{style:{position:"relative",width:"fit-content"},children:[e.jsx("img",{src:p,alt:"Preview",style:{height:"80px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.2)"}}),e.jsx("button",{type:"button",onClick:()=>l(null),style:{position:"absolute",top:-5,right:-5,background:"red",borderRadius:"50%",border:"none",color:"white",padding:"2px",cursor:"pointer"},children:e.jsx(Z,{size:12})})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("input",{type:"file",accept:"image/*",ref:g,style:{display:"none"},onChange:o}),e.jsx("button",{type:"button",onClick:()=>g.current.click(),style:{padding:"12px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:e.jsx(ye,{size:20})}),e.jsx("input",{type:"text",value:b,onChange:h=>s(h.target.value),placeholder:"작전을 전달하세요...",style:{flex:1,padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.05)",color:"white",outline:"none"}}),e.jsx("button",{type:"submit",style:{padding:"12px",borderRadius:"12px",background:"var(--accent-color)",color:"white",border:"none",cursor:"pointer"},children:e.jsx(Be,{size:20})})]})]})]}):e.jsx("div",{className:"glass-panel",style:{padding:"40px",textAlign:"center"},children:"야영지에 소속되어 있지 않습니다."})},it=({user:t})=>{const[i,c]=d.useState([]),[b,s]=d.useState(new Date),[p,l]=d.useState(!0),[m,n]=d.useState(!1),[r,g]=d.useState({title:"",date:"",type:"vote",timeSlots:[],fixedTime:""}),[o,u]=d.useState("");d.useEffect(()=>{if(!t?.campId)return;const a=F(_(w,"schedules"),q("campId","==",t.campId),Q("date")),v=K(a,C=>{const N=C.docs.map(R=>({id:R.id,...R.data()}));c(N),l(!1)});return()=>v()},[t?.campId]);const h=()=>{o&&!r.timeSlots.some(a=>a.time===o)&&(g(a=>({...a,timeSlots:[...a.timeSlots,{time:o,votes:[]}].sort((v,C)=>v.time.localeCompare(C.time))})),u(""))},f=a=>{g(v=>({...v,timeSlots:v.timeSlots.filter(C=>C.time!==a)}))},y=async a=>{a.preventDefault();try{await ee(_(w,"schedules"),{...r,campId:t.campId,creator:t.nickname,createdAt:new Date().toISOString()}),n(!1),g({title:"",date:"",type:"vote",timeSlots:[],fixedTime:""})}catch(v){console.error("Error adding schedule: ",v),alert("일정 추가 실패: "+v.message)}},j=async a=>{window.confirm("정말 삭제하시겠습니까?")&&await te(D(w,"schedules",a))},k=async(a,v,C)=>{const N=i.find(M=>M.id===a);if(!N)return;const R=t.nickname,W=[...N.timeSlots],B={...W[v]};B.votes.includes(R)?B.votes=B.votes.filter(M=>M!==R):B.votes=[...B.votes,R],W[v]=B,await G(D(w,"schedules",a),{timeSlots:W})},S=b.toLocaleDateString("en-CA"),A=i.filter(a=>a.date===S),E=({date:a,view:v})=>{if(v==="month"){const C=a.toLocaleDateString("en-CA");if(i.some(R=>R.date===C))return e.jsx("div",{style:{height:"6px",width:"6px",background:"#f87171",borderRadius:"50%",margin:"2px auto"}})}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",gap:"10px",color:"white",margin:0},children:[e.jsx(Y,{className:"text-accent"})," 모험 일정 (Calendar)"]}),e.jsxs("button",{onClick:()=>{g(a=>({...a,date:S})),n(!0)},className:"glass-button",style:{background:"var(--accent-color)",border:"none",padding:"10px 20px",borderRadius:"8px",color:"white",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(be,{size:18})," 일정 추가"]})]}),e.jsx("style",{children:`
                    .react-calendar { background: transparent !important; border: none !important; width: 100% !important; color: white !important; font-family: inherit; }
                    .react-calendar__navigation button { color: white; min-width: 44px; background: none; font-size: 1.2rem; }
                    .react-calendar__navigation button:enabled:hover, .react-calendar__navigation button:enabled:focus { background-color: rgba(255,255,255,0.1); }
                    .react-calendar__month-view__weekdays { text-align: center; text-transform: uppercase; font-weight: bold; font-size: 0.8em; opacity: 0.7; color: var(--accent-color); }
                    .react-calendar__month-view__days__day { color: white; padding: 15px; background: transparent; border: none; }
                    .react-calendar__tile:enabled:hover, .react-calendar__tile:enabled:focus { background-color: rgba(255,255,255,0.1); border-radius: 12px; }
                    .react-calendar__tile--now { background: rgba(255,255,255,0.1) !important; border-radius: 12px; }
                    .react-calendar__tile--active { background: var(--accent-color) !important; color: white !important; border-radius: 12px; }
                    .react-calendar__month-view__days__day--neighboringMonth { opacity: 0.3; }
                `}),e.jsx(_e,{onChange:s,value:b,tileContent:E,formatDay:(a,v)=>v.getDate()})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"20px",minHeight:"200px"},children:[e.jsxs("h3",{style:{margin:"0 0 15px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"10px"},children:[b.toLocaleDateString()," 일정 목록"]}),p?e.jsx("p",{children:"로딩 중..."}):A.length===0?e.jsx("div",{style:{textAlign:"center",opacity:.5,padding:"20px"},children:"이 날짜에 등록된 일정이 없습니다."}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"15px"},children:A.map(a=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",gap:"5px"},children:[e.jsx("span",{style:{fontSize:"0.7rem",padding:"2px 8px",borderRadius:"10px",background:a.type==="vote"?"rgba(167, 139, 250, 0.2)":"rgba(248, 113, 113, 0.2)",color:a.type==="vote"?"#a78bfa":"#fca5a5"},children:a.type==="vote"?"🗳️ 시간 조율":"⚔️ 확정 일정"}),e.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:["by ",a.creator]})]}),e.jsx("button",{onClick:()=>j(a.id),style:{background:"none",border:"none",color:"rgba(255,255,255,0.3)",cursor:"pointer"},children:e.jsx(de,{size:14})})]}),e.jsx("h4",{style:{margin:"0 0 15px",fontSize:"1.2rem"},children:a.title}),a.type==="fixed"?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"1.1rem",color:"var(--accent-color)"},children:[e.jsx(Ee,{size:16})," ",a.fixedTime]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:a.timeSlots?.map((v,C)=>{const N=Math.max(...a.timeSlots.map(B=>B.votes.length)),R=N>0&&v.votes.length===N,W=v.votes.includes(t.nickname);return e.jsxs("div",{onClick:()=>k(a.id,C,v.votes),style:{padding:"10px",borderRadius:"8px",background:W?"rgba(78, 209, 197, 0.1)":"rgba(0,0,0,0.2)",border:W?"1px solid var(--accent-color)":"1px solid transparent",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.2s"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[R&&e.jsx(Ne,{size:14,color:"#fbbf24"}),e.jsx("span",{style:{fontWeight:R?"bold":"normal",color:R?"#fbbf24":"white"},children:v.time})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx("div",{style:{display:"flex",marginRight:"5px"},children:v.votes.map((B,M)=>e.jsx("div",{title:B,style:{width:"6px",height:"6px",borderRadius:"50%",background:"white",opacity:.5,marginLeft:"2px"}},M))}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.7},children:[v.votes.length,"표"]})]})]},C)})})]},a.id))})]}),m&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(5px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},onClick:()=>n(!1),children:e.jsxs("div",{className:"glass-panel",style:{width:"450px",padding:"30px"},onClick:a=>a.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 20px"},children:"새 일정 추가"}),e.jsxs("form",{onSubmit:y,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx("input",{placeholder:"일정 제목 (예: 3막 보스전)",value:r.title,onChange:a=>g({...r,title:a.target.value}),required:!0,style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("input",{type:"date",value:r.date,onChange:a=>g({...r,date:a.target.value}),required:!0,style:{flex:1,padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsxs("select",{value:r.type,onChange:a=>g({...r,type:a.target.value}),style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"},children:[e.jsx("option",{value:"vote",style:{color:"black"},children:"🗳️ 시간 조율"}),e.jsx("option",{value:"fixed",style:{color:"black"},children:"⚔️ 확정 일정"})]})]}),r.type==="vote"?e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"8px"},children:[e.jsx("label",{style:{fontSize:"0.8rem",opacity:.7,marginBottom:"5px",display:"block"},children:"후보 시간 추가"}),e.jsxs("div",{style:{display:"flex",gap:"5px",marginBottom:"10px"},children:[e.jsx("input",{type:"time",value:o,onChange:a=>u(a.target.value),style:{flex:1,padding:"8px",borderRadius:"6px",border:"none"}}),e.jsx("button",{type:"button",onClick:h,style:{padding:"8px 15px",borderRadius:"6px",background:"var(--accent-color)",color:"white",border:"none",cursor:"pointer"},children:"추가"})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"5px"},children:r.timeSlots.map(a=>e.jsxs("span",{style:{background:"rgba(255,255,255,0.1)",padding:"5px 10px",borderRadius:"15px",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"5px"},children:[a.time,e.jsx(Z,{size:12,style:{cursor:"pointer"},onClick:()=>f(a.time)})]},a.time))})]}):e.jsx("input",{type:"time",required:!0,value:r.fixedTime,onChange:a=>g({...r,fixedTime:a.target.value}),style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[e.jsx("button",{type:"button",onClick:()=>n(!1),style:{flex:1,padding:"12px",borderRadius:"8px",background:"transparent",border:"1px solid rgba(255,255,255,0.3)",color:"white",cursor:"pointer"},children:"취소"}),e.jsx("button",{type:"submit",style:{flex:1,padding:"12px",borderRadius:"8px",background:"var(--accent-color)",border:"none",color:"white",cursor:"pointer"},children:"등록"})]})]})]})})]})},ot=({user:t})=>{const[i,c]=d.useState([]),[b,s]=d.useState(!0);d.useEffect(()=>{if(!t?.campId)return;const n=F(_(w,"save_reports_v2"),q("campId","==",t.campId),Q("createdAt","desc"),ie(10)),r=K(n,g=>{const o=g.docs.map(u=>({id:u.id,...u.data()}));c(o),s(!1)});return()=>r()},[t?.campId]);const p=async n=>{confirm("이 분석 기록을 삭제하시겠습니까?")&&await te(D(w,"save_reports_v2",n))},l=({label:n,value:r,color:g})=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"},children:[e.jsx("span",{style:{width:"40px",fontWeight:"bold",fontSize:"0.8rem",color:"rgba(255,255,255,0.7)"},children:n}),e.jsx("div",{style:{flex:1,height:"8px",background:"rgba(255,255,255,0.1)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${r/20*100}%`,height:"100%",background:g,transition:"width 0.5s"}})}),e.jsx("span",{style:{width:"25px",textAlign:"right",fontWeight:"bold"},children:r})]}),m=n=>{const r=n.target.files[0];r&&(s(!0),setTimeout(async()=>{const g={STR:Math.floor(Math.random()*10)+10,DEX:Math.floor(Math.random()*10)+10,CON:Math.floor(Math.random()*10)+10,INT:Math.floor(Math.random()*10)+10,WIS:Math.floor(Math.random()*10)+10,CHA:Math.floor(Math.random()*10)+10},o={filename:r.name,stats:g,meta:{mode:"Honour Mode (Detected)",version:"4.1.1.4",size:(r.size/1024/1024).toFixed(2)+" MB"},companions:[{name:"Shadowheart",img:"🌙"},{name:"Astarion",img:"🧛"}],logs:["[Client] File loaded locally","[Parser] Header verified (LSOF v4)","[Analysis] Stats extracted successfully"],uploader:t.nickname,campId:t.campId,createdAt:le()};try{await ee(_(w,"save_reports_v2"),o),alert("분석 완료!")}catch(u){console.error(u),alert("업로드 실패")}finally{s(!1)}},1500))};return e.jsxs("div",{style:{padding:"0 0 80px"},children:[e.jsxs("div",{className:"glass-panel",style:{marginBottom:"20px",textAlign:"center",border:"1px solid var(--accent-color)"},children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[e.jsx(Te,{color:"#a78bfa"})," 세이브 파일 분석기"]}),e.jsx("p",{style:{opacity:.8,fontSize:"0.9rem",maxWidth:"600px",margin:"0 auto 20px"},children:"세이브 파일(.lsv)을 업로드하여 캐릭터 능력치와 진행 상황을 분석하세요."}),e.jsxs("div",{style:{position:"relative",overflow:"hidden",display:"inline-block"},children:[e.jsxs("button",{style:{background:"var(--accent-color)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(se,{size:18})," 파일 선택 및 분석"]}),e.jsx("input",{type:"file",accept:".lsv,.save",onChange:m,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,cursor:"pointer"}})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:b?e.jsxs("div",{className:"glass-panel",style:{textAlign:"center",padding:"40px"},children:[e.jsx(je,{size:32,className:"spin",style:{marginBottom:"15px",color:"var(--accent-color)"}}),e.jsx("p",{children:"세이브 파일 분석 중..."})]}):i.length===0?e.jsxs("div",{className:"glass-panel",style:{textAlign:"center",padding:"40px"},children:[e.jsx(se,{size:48,style:{opacity:.3,marginBottom:"20px"}}),e.jsx("p",{children:"분석된 데이터가 없습니다."})]}):i.map(n=>e.jsxs("div",{className:"glass-panel",style:{position:"relative",animation:"fadeIn 0.5s"},children:[e.jsx("button",{onClick:()=>p(n.id),style:{position:"absolute",top:"15px",right:"15px",background:"transparent",border:"none",color:"#f87171",cursor:"pointer"},children:e.jsx(de,{size:16})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"10px"},children:[e.jsx(se,{size:20,color:"var(--accent-color)"}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:n.filename}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.5},children:[new Date(n.createdAt?.toDate?n.createdAt.toDate():n.createdAt).toLocaleString()," • ",n.uploader]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"12px"},children:[e.jsxs("h4",{style:{margin:"0 0 10px",display:"flex",alignItems:"center",gap:"5px",fontSize:"0.9rem"},children:[e.jsx(fe,{size:14})," 능력치 (Stats)"]}),n.stats?e.jsxs(e.Fragment,{children:[e.jsx(l,{label:"STR",value:n.stats.STR,color:"#fca5a5"}),e.jsx(l,{label:"DEX",value:n.stats.DEX,color:"#86efac"}),e.jsx(l,{label:"CON",value:n.stats.CON,color:"#fbbf24"}),e.jsx(l,{label:"INT",value:n.stats.INT,color:"#93c5fd"}),e.jsx(l,{label:"WIS",value:n.stats.WIS,color:"#d8b4fe"}),e.jsx(l,{label:"CHA",value:n.stats.CHA,color:"#f472b6"})]}):e.jsx("p",{style:{fontSize:"0.8rem",opacity:.5},children:"데이터 없음"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"12px",flex:1},children:[e.jsxs("h4",{style:{margin:"0 0 10px",display:"flex",alignItems:"center",gap:"5px",fontSize:"0.9rem"},children:[e.jsx(X,{size:14})," 메타 정보"]}),e.jsxs("div",{style:{fontSize:"0.8rem",display:"flex",flexDirection:"column",gap:"5px"},children:[e.jsxs("p",{style:{margin:0},children:["📂 모드: ",n.meta?.mode||"Unknown"]}),e.jsxs("p",{style:{margin:0},children:["💾 버전: ",n.meta?.version||"Unknown"]}),e.jsxs("p",{style:{margin:0},children:["📦 크기: ",n.meta?.size||"Unknown"]})]})]}),n.companions&&e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"12px"},children:[e.jsx("h4",{style:{margin:"0 0 5px",fontSize:"0.8rem",opacity:.8},children:"함께하는 동료"}),e.jsx("div",{style:{display:"flex",gap:"5px",flexWrap:"wrap"},children:n.companions.map((r,g)=>e.jsxs("span",{style:{background:"rgba(255,255,255,0.1)",padding:"2px 8px",borderRadius:"4px",fontSize:"0.7rem"},children:[r.img," ",r.name]},g))})]})]})]})]},n.id))})]})},we=[{id:"barbarian",name:"바바리안",icon:We,color:"#fca5a5"},{id:"bard",name:"바드",icon:Me,color:"#f9a8d4"},{id:"cleric",name:"클레릭",icon:Le,color:"#d1d5db"},{id:"druid",name:"드루이드",icon:Oe,color:"#bef264"},{id:"fighter",name:"파이터",icon:X,color:"#93c5fd"},{id:"monk",name:"몽크",icon:Pe,color:"#7dd3fc"},{id:"paladin",name:"팔라딘",icon:X,color:"#fbbf24"},{id:"ranger",name:"레인저",icon:Fe,color:"#86efac"},{id:"rogue",name:"로그",icon:Ue,color:"#cbd5e1"},{id:"sorcerer",name:"소서러",icon:He,color:"#c084fc"},{id:"warlock",name:"워락",icon:qe,color:"#e879f9"},{id:"wizard",name:"위자드",icon:$e,color:"#818cf8"}],T={width:"100%",padding:"16px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.1)",background:"rgba(0,0,0,0.2)",color:"white",marginBottom:"12px",fontSize:"1rem",transition:"border-color 0.2s, background 0.2s"},P={width:"100%",padding:"16px",borderRadius:"12px",border:"none",fontWeight:"bold",fontSize:"1.05rem",marginTop:"0",cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},xe=({selected:t,onSelect:i})=>e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px",maxHeight:"200px",overflowY:"auto",margin:"20px 0",padding:"5px"},children:we.map(c=>e.jsxs("button",{onClick:()=>i(c),type:"button",style:{padding:"12px 8px",borderRadius:"12px",border:t?.id===c.id?`2px solid ${c.color}`:"1px solid rgba(255,255,255,0.05)",background:t?.id===c.id?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.2)",color:"white",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",transition:"all 0.2s",cursor:"pointer",transform:t?.id===c.id?"scale(1.05)":"scale(1)"},children:[e.jsx(c.icon,{size:24,color:c.color}),e.jsx("span",{style:{fontSize:"0.75rem",fontWeight:t?.id===c.id?"bold":"normal"},children:c.name})]},c.id))}),ae=({children:t,title:i,sub:c,onClose:b,error:s})=>e.jsx("div",{className:"modal-overlay",onClick:b,children:e.jsxs("div",{className:"modal-content",onClick:p=>p.stopPropagation(),children:[e.jsx("button",{onClick:b,style:{position:"absolute",top:"20px",right:"20px",background:"rgba(255,255,255,0.1)",border:"none",borderRadius:"50%",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",cursor:"pointer",zIndex:10},children:e.jsx(Z,{size:18})}),e.jsxs("div",{style:{padding:"30px 20px",textAlign:"center"},children:[i&&e.jsx("h2",{style:{fontSize:"2rem",marginBottom:"8px",fontWeight:"800",background:"linear-gradient(to right, #fff, #aaa)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:i}),c&&e.jsx("p",{style:{opacity:.7,fontSize:"0.95rem",marginBottom:"30px"},children:c}),t,s&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.2)",color:"#fca5a5",padding:"12px",borderRadius:"10px",marginTop:"20px",fontSize:"0.9rem",border:"1px solid rgba(239, 68, 68, 0.3)"},children:["⚠️ ",s]})]})]})}),ge=({onComplete:t,initialData:i})=>{const[c,b]=d.useState(i?"profile_view":"landing"),[s,p]=d.useState(i?.nickname||""),[l,m]=d.useState(""),[n,r]=d.useState(i?we.find(x=>x.name===i.className):null),[g,o]=d.useState(""),[u,h]=d.useState(""),[f,y]=d.useState([]),[j,k]=d.useState(null),[S,A]=d.useState(!1),[E,a]=d.useState("");d.useEffect(()=>{i&&b("profile_view")},[i]);const v=()=>{p(""),m(""),r(null),o(""),h(""),k(null),a(""),y([])},C=()=>{a(""),b("landing")};d.useEffect(()=>{c==="join_camp"&&N()},[c]);const N=async()=>{A(!0);try{console.log("[Profile] Fetching active camps...");const I=(await oe(_(w,"camps"))).docs.map(z=>({id:z.id,...z.data()}));y(I),console.log("[Profile] Camps found:",I.length)}catch(x){console.error("[Profile] Error fetching camps:",x),a("영지 목록을 불러오는데 실패했습니다.")}finally{A(!1)}},R=async x=>{x.preventDefault(),A(!0),a("");try{console.log("[Auth] Attempting login for:",s);const I=await $(D(w,"users_v2",s));if(!I.exists())throw new Error("존재하지 않는 모험가입니다.");const z=I.data();if(z.password!==l)throw new Error("비밀번호가 일치하지 않습니다.");if(console.log("[Auth] Login successful:",z),z.campId)try{await G(D(w,"camps",z.campId),{members:ce(s)})}catch(L){console.error("[Auth] Failed to update camp member list:",L)}localStorage.setItem("bg3_user_profile",JSON.stringify(z)),t(z)}catch(I){console.error("[Auth] Login failed:",I),a(I.message)}finally{A(!1)}},W=async()=>{if(!s||!l||!n||!g||!u){a("모든 정보를 입력해주세요.");return}A(!0);try{console.log("[Camp] Creating new camp:",g);const x=D(w,"users_v2",s);if((await $(x)).exists())throw new Error("이미 존재하는 닉네임입니다.");const z=g.trim(),L=D(w,"camps",z);if((await $(L)).exists())throw new Error("이미 존재하는 영지 이름입니다.");const O={id:s,nickname:s,password:l,className:n.name,classId:n.id,isAdmin:!0,campId:z,createdAt:new Date().toISOString()},Se={id:z,name:g,password:u,leaderId:s,members:[s],createdAt:new Date().toISOString()};await ne(x,O),await ne(L,Se),console.log("[Camp] Camp and Admin created successfully"),localStorage.setItem("bg3_user_profile",JSON.stringify(O)),t(O)}catch(x){console.error("[Camp] Creation failed:",x),a(x.message)}finally{A(!1)}},B=async()=>{if(!s||!l||!n||!j||!u){a("모든 정보를 입력해주세요.");return}A(!0);try{console.log("[Camp] Joining camp:",j);const x=D(w,"users_v2",s);if((await $(x)).exists())throw new Error("이미 존재하는 닉네임입니다. (로그인 하세요)");const z=D(w,"camps",j),L=await $(z);if(!L.exists())throw new Error("영지가 존재하지 않습니다.");const V=L.data();if(V.password!==u)throw new Error("영지 입장 암호가 틀렸습니다.");if(V.members&&V.members.length>=4)throw new Error("영지 정원이 꽉 찼습니다. (최대 4명)");const O={id:s,nickname:s,password:l,className:n.name,classId:n.id,isAdmin:!1,campId:j,createdAt:new Date().toISOString()};await ne(x,O),await G(z,{members:ce(s)}),console.log("[Camp] Joined successfully"),localStorage.setItem("bg3_user_profile",JSON.stringify(O)),t(O)}catch(x){console.error("[Camp] Join failed:",x),a(x.message)}finally{A(!1)}},M=()=>{confirm("정말 로그아웃 하시겠습니까?")&&(localStorage.removeItem("bg3_user_profile"),t(null),b("landing"),v())};return c==="profile_view"&&i?e.jsxs("div",{className:"glass-panel",style:{maxWidth:"450px",margin:"40px auto",padding:"40px",textAlign:"center"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx("div",{style:{width:"100px",height:"100px",borderRadius:"50%",background:n?.color||"gray",margin:"0 auto 20px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 0 30px ${n?.color||"gray"}`},children:n&&e.jsx(n.icon,{size:50,color:"white"})}),e.jsx("h3",{style:{fontSize:"1.8rem",margin:"0 0 8px",fontWeight:"bold"},children:i.nickname}),e.jsx("span",{style:{fontSize:"0.95rem",opacity:.8,background:"rgba(255,255,255,0.1)",padding:"6px 12px",borderRadius:"20px"},children:i.className})]}),e.jsxs("div",{style:{textAlign:"left",background:"rgba(0,0,0,0.2)",padding:"25px",borderRadius:"16px"},children:[e.jsxs("p",{style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"15px",marginBottom:"15px"},children:[e.jsx("span",{style:{opacity:.6},children:"소속 야영지"}),e.jsx("b",{style:{fontSize:"1.1rem"},children:i.campId})]}),e.jsxs("p",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{opacity:.6},children:"직책"}),e.jsx("b",{style:{color:i.isAdmin?"#f87171":"#4ade80"},children:i.isAdmin?"영주 (Leader)":"대원 (Member)"})]})]}),e.jsxs("button",{onClick:M,style:{...P,background:"rgba(248, 113, 113, 0.1)",border:"1px solid rgba(248, 113, 113, 0.3)",color:"#f87171",marginTop:"40px"},children:[e.jsx(ue,{size:20}),"로그아웃"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"glass-panel",style:{maxWidth:"1000px",width:"95%",padding:"60px 60px",textAlign:"center",minHeight:"550px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center",gap:"60px",width:"100%"},children:[e.jsx("div",{style:{flex:"1 1 300px",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},children:e.jsxs("div",{className:"logo-wrapper",style:{position:"relative",maxWidth:"420px",width:"100%"},children:[e.jsx("img",{src:H,alt:"Logo",onClick:()=>window.location.reload(),title:"새로고침",style:{width:"100%",cursor:"pointer",transition:"transform 0.3s ease",display:"block"},onMouseOver:x=>x.currentTarget.style.transform="scale(1.03)",onMouseOut:x=>x.currentTarget.style.transform="scale(1)"}),e.jsx("div",{className:"logo-shine",style:{WebkitMaskImage:`url(${H})`,maskImage:`url(${H})`}})]})}),e.jsxs("div",{style:{flex:"1 1 300px",display:"flex",flexDirection:"column",gap:"20px",maxWidth:"350px",width:"100%"},children:[e.jsxs("button",{onClick:()=>{v(),b("login")},style:{...P,background:"rgba(255,255,255,0.08)",color:"white",border:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx(Je,{size:20}),"기존 모험가 로그인"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",opacity:.3,fontSize:"0.8rem"},children:[e.jsx("div",{style:{flex:1,height:"1px",background:"white"}}),e.jsx("span",{children:"OR"}),e.jsx("div",{style:{flex:1,height:"1px",background:"white"}})]}),e.jsxs("button",{onClick:()=>{v(),b("join_camp")},style:{...P,background:"linear-gradient(45deg, #7c3aed, #db2777)",color:"white",boxShadow:"0 4px 15px rgba(124, 58, 237, 0.3)"},children:[e.jsx(J,{size:20}),"야영지 합류하기 (일반)"]}),e.jsxs("button",{onClick:()=>{v(),b("create_camp")},style:{...P,background:"linear-gradient(45deg, #ef4444, #f97316)",color:"white",boxShadow:"0 4px 15px rgba(239, 68, 68, 0.3)"},children:[e.jsx(ve,{size:20}),"새 야영지 건설 (관리자)"]}),e.jsxs("p",{style:{marginTop:"10px",opacity:.6,fontSize:"0.85rem",lineHeight:"1.5",fontWeight:"400",textAlign:"center"},children:["동료들과 함께 나만의 이야기를 만들어보세요.",e.jsx("br",{}),e.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:"발더스 게이트 3 원정대"}),"를 위한",e.jsx("br",{}),"필수 컴패니언 앱"]})]})]})}),c==="login"&&e.jsx(ae,{title:"로그인",sub:"다시 오셨군요, 모험가님.",onClose:C,error:E,children:e.jsxs("form",{onSubmit:R,children:[e.jsx("input",{type:"text",placeholder:"닉네임",value:s,onChange:x=>p(x.target.value),style:T}),e.jsx("input",{type:"password",placeholder:"비밀번호",value:l,onChange:x=>m(x.target.value),style:T}),e.jsx("button",{type:"submit",style:{...P,background:"white",color:"black",marginTop:"20px"},disabled:S,children:S?"인증 확인 중...":"야영지 입장"})]})}),c==="create_camp"&&e.jsxs(ae,{title:"야영지 건설",sub:"당신만의 파티를 이끌어보세요.",onClose:C,error:E,children:[e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px"},children:[e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"10px",marginBottom:"15px"},children:[e.jsx("label",{style:{fontSize:"0.85rem",color:"#fca5a5",fontWeight:"bold",display:"block",marginBottom:"8px"},children:"관리자(영주) 정보"}),e.jsx("input",{type:"text",placeholder:"영주 닉네임",value:s,onChange:x=>p(x.target.value),style:T}),e.jsx("input",{type:"password",placeholder:"개인 비밀번호",value:l,onChange:x=>m(x.target.value),style:{...T,marginBottom:0}})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"10px",marginBottom:"15px"},children:[e.jsx("label",{style:{fontSize:"0.85rem",color:"#c4b5fd",fontWeight:"bold",display:"block",marginBottom:"8px"},children:"영지(Room) 설정"}),e.jsx("input",{type:"text",placeholder:"야영지 이름 (ID로 사용됨)",value:g,onChange:x=>o(x.target.value),style:T}),e.jsx("input",{type:"text",placeholder:"영지 입장 암호 (팀원 공유용)",value:u,onChange:x=>h(x.target.value),style:{...T,borderColor:"#818cf8",color:"#818cf8",marginBottom:0}})]}),e.jsx("label",{style:{fontSize:"0.9rem",color:"white",opacity:.8,marginTop:"5px",display:"block"},children:"나의 직업 선택"}),e.jsx(xe,{selected:n,onSelect:r})]}),e.jsx("button",{onClick:W,style:{...P,background:"#ef4444",color:"white"},disabled:S,children:S?"영토 선포 중...":"건설 완료 및 입장"})]}),c==="join_camp"&&e.jsxs(ae,{title:"야영지 합류",sub:"동료들이 기다리고 있습니다.",onClose:C,error:E,children:[e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px"},children:[!j&&e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("span",{style:{opacity:.7,fontSize:"0.9rem"},children:"참여 가능한 영지"}),e.jsxs("button",{onClick:N,style:{background:"none",border:"none",color:"var(--accent-color)",cursor:"pointer",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(je,{size:12})," 목록 갱신"]})]}),e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"12px",padding:"10px",background:"rgba(0,0,0,0.2)"},children:S&&f.length===0?e.jsx("p",{style:{textAlign:"center",opacity:.5,padding:"20px"},children:"탐색 중..."}):f.length===0?e.jsx("p",{style:{textAlign:"center",opacity:.5,padding:"20px"},children:"활성화된 영지가 없습니다."}):f.map(x=>e.jsxs("div",{onClick:()=>k(x.id),style:{padding:"16px",marginBottom:"8px",borderRadius:"10px",cursor:"pointer",background:"rgba(255,255,255,0.05)",border:"1px solid transparent",transition:"all 0.2s",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseOver:I=>{I.currentTarget.style.background="rgba(255,255,255,0.1)",I.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},onMouseOut:I=>{I.currentTarget.style.background="rgba(255,255,255,0.05)",I.currentTarget.style.borderColor="transparent"},children:[e.jsxs("span",{style:{fontWeight:"bold"},children:["🏰 ",x.name]}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.7,background:"rgba(0,0,0,0.3)",padding:"4px 8px",borderRadius:"4px"},children:[x.members?.length||0,"/4명"]})]},x.id))})]}),j&&e.jsxs("div",{style:{animation:"fadeIn 0.3s"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("button",{onClick:()=>k(null),style:{background:"none",border:"none",color:"white",opacity:.5,cursor:"pointer"},children:"←"}),e.jsx("h3",{style:{margin:0,fontSize:"1.2rem"},children:f.find(x=>x.id===j)?.name})]}),e.jsx("input",{type:"text",placeholder:"영지 입장 암호",value:u,onChange:x=>h(x.target.value),style:{...T,borderColor:"#818cf8",color:"#818cf8"}}),e.jsx("div",{style:{height:"10px"}}),e.jsx("input",{type:"text",placeholder:"내 닉네임",value:s,onChange:x=>p(x.target.value),style:T}),e.jsx("input",{type:"password",placeholder:"내 비밀번호",value:l,onChange:x=>m(x.target.value),style:T}),e.jsx("label",{style:{fontSize:"0.9rem",color:"white",opacity:.8,marginTop:"15px",display:"block"},children:"나의 직업 선택"}),e.jsx(xe,{selected:n,onSelect:r})]})]}),j&&e.jsx("button",{onClick:B,style:{...P,background:"var(--accent-color)",color:"white"},disabled:S,children:S?"입장 중...":"합류하기"})]})]})},lt=({user:t})=>{const[i,c]=d.useState([]),[b,s]=d.useState(!0);d.useEffect(()=>{if(!t?.campId)return;const m=F(_(w,"users_v2"),q("campId","==",t.campId)),n=K(m,r=>{const g=r.docs.map(o=>({id:o.id,...o.data()}));c(g),s(!1)});return()=>n()},[t?.campId]);const p=async m=>{if(window.confirm(`정말 '${m.nickname}' 님을 영지에서 추방하시겠습니까?`))try{await te(D(w,"users_v2",m.id));const n=D(w,"camps",t.campId);await G(n,{members:Ge(m.nickname)}),alert("추방되었습니다.")}catch(n){console.error("Kick failed:",n),alert("추방 실패: "+n.message)}},l=async()=>{if(!window.confirm(`⚠️ 경고: 영지를 폭파하면 모든 데이터와 멤버가 삭제됩니다.
정말 이 야영지를 해체하시겠습니까?`))return;if(prompt("영지를 삭제하려면 '영지 폭파'라고 입력하세요.")!=="영지 폭파")return alert("취소되었습니다.");try{s(!0);const r=Xe(w),g=D(w,"camps",t.campId);r.delete(g),i.forEach(h=>{const f=D(w,"users_v2",h.id);r.delete(f)});const o=F(_(w,"chats"),q("campId","==",t.campId));(await oe(o)).forEach(h=>{r.delete(h.ref)}),await r.commit(),alert("야영지가 역사 속으로 사라졌습니다."),window.location.reload()}catch(r){console.error("Destroy failed:",r),alert("삭제 실패: "+r.message)}finally{s(!1)}};return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",paddingBottom:"80px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"30px",marginBottom:"30px",border:"1px solid var(--accent-color)",background:"rgba(50, 0, 0, 0.3)"},children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"0 0 10px",color:"#fca5a5"},children:[e.jsx(X,{})," 영주 관리실 (Admin)"]}),e.jsxs("p",{style:{opacity:.8,fontSize:"0.9rem"},children:["현재 야영지: ",e.jsx("b",{children:t.campId})," ",e.jsx("br",{}),"권한: ",e.jsx("span",{style:{color:"var(--accent-color)"},children:"Master"})]})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"0",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"20px",background:"rgba(255,255,255,0.05)",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:e.jsxs("h3",{style:{margin:0,fontSize:"1.1rem"},children:["대원 목록 (",i.length,"/4)"]})}),i.map(m=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"45px",height:"45px",borderRadius:"50%",background:m.isAdmin?"var(--accent-color)":"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:m.isAdmin?e.jsx(ve,{size:22,color:"white"}):e.jsx(Ke,{size:22})}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold",display:"flex",alignItems:"center",gap:"8px",fontSize:"1.1rem"},children:[m.nickname,e.jsx("span",{style:{fontSize:"0.7rem",padding:"3px 8px",borderRadius:"6px",background:"rgba(255,255,255,0.1)",opacity:.8},children:m.className||"모험가"})]}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.5,marginTop:"4px"},children:m.isAdmin?"영주 (Leader)":"대원 (Member)"})]})]}),!m.isAdmin&&e.jsxs("button",{onClick:()=>p(m),style:{padding:"10px 15px",borderRadius:"8px",background:"rgba(248, 113, 113, 0.1)",border:"1px solid rgba(248, 113, 113, 0.3)",color:"#f87171",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(Ve,{size:16})," 추방"]})]},m.id)),i.length===0&&!b&&e.jsx("div",{style:{padding:"40px",textAlign:"center",opacity:.5},children:"멤버가 없습니다."})]}),e.jsxs("div",{style:{marginTop:"50px",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"30px"},children:[e.jsxs("h3",{style:{color:"#ef4444",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(Ye,{})," 위험 구역"]}),e.jsxs("div",{className:"glass-panel",style:{borderColor:"#ef4444",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 5px"},children:"영지 폭파"}),e.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:"이 야영지의 모든 데이터를 영구적으로 삭제합니다."})]}),e.jsx("button",{onClick:l,style:{background:"#ef4444",color:"white",border:"none",padding:"12px 20px",borderRadius:"8px",fontWeight:"bold",cursor:"pointer"},children:"폭파 실행"})]})]})]})},dt=({user:t})=>{const[i,c]=d.useState([]),[b,s]=d.useState(!1),[p,l]=d.useState({title:"",content:"",image:null}),m=d.useRef(null);d.useEffect(()=>{if(!t?.campId)return;const o=F(_(w,"tactics"),q("campId","==",t.campId),Q("createdAt","desc")),u=K(o,h=>{const f=h.docs.map(y=>({id:y.id,...y.data()}));c(f)});return()=>u()},[t?.campId]);const n=o=>{const u=o.target.files[0];if(u){if(u.size>1024*1024)return alert("이미지는 1MB 이하여야 합니다.");const h=new FileReader;h.onloadend=()=>{l(f=>({...f,image:h.result}))},h.readAsDataURL(u)}},r=async o=>{if(o.preventDefault(),!(!p.title||!t.campId))try{await ee(_(w,"tactics"),{...p,campId:t.campId,author:t.nickname,createdAt:le()}),s(!1),l({title:"",content:"",image:null})}catch(u){console.error(u),alert("게시 실패")}},g=async o=>{window.confirm("삭제하시겠습니까?")&&await te(D(w,"tactics",o))};return e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",paddingBottom:"80px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px",marginBottom:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("h2",{style:{display:"flex",alignItems:"center",gap:"10px",margin:0},children:[e.jsx(he,{className:"text-accent"})," 전술 게시판 (Tactics Board)"]}),e.jsx("p",{style:{margin:"5px 0 0",opacity:.7,fontSize:"0.9rem"},children:"공략과 팁을 공유하세요."})]}),e.jsxs("button",{onClick:()=>s(!0),style:{background:"var(--accent-color)",color:"white",border:"none",padding:"10px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(be,{size:18})," 전술 공유"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:i.map(o=>e.jsxs("div",{className:"glass-panel",style:{padding:"0",overflow:"hidden",display:"flex",flexDirection:"column"},children:[o.image&&e.jsx("div",{style:{width:"100%",height:"200px",overflow:"hidden",background:"#000"},children:e.jsx("img",{src:o.image,alt:"tactic",style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs("div",{style:{padding:"20px",flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"10px"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.2rem"},children:o.title}),(t.isAdmin||t.nickname===o.author)&&e.jsx("button",{onClick:()=>g(o.id),style:{background:"none",border:"none",color:"rgba(255,255,255,0.3)",cursor:"pointer"},children:e.jsx(de,{size:16})})]}),e.jsx("p",{style:{fontSize:"0.9rem",opacity:.8,whiteSpace:"pre-wrap",lineHeight:"1.5"},children:o.content})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"rgba(0,0,0,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.8rem",opacity:.6},children:[e.jsxs("span",{children:["by ",o.author]}),o.createdAt&&e.jsx("span",{children:new Date(o.createdAt?.toDate?o.createdAt.toDate():o.createdAt).toLocaleDateString()})]})]},o.id))}),b&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(5px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},onClick:()=>s(!1),children:e.jsxs("div",{className:"glass-panel",style:{width:"500px",padding:"30px"},onClick:o=>o.stopPropagation(),children:[e.jsx("h3",{style:{margin:"0 0 20px"},children:"새 전술 공유"}),e.jsxs("form",{onSubmit:r,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx("input",{placeholder:"제목 (예: 라파엘 전투 포지셔닝)",value:p.title,onChange:o=>l({...p,title:o.target.value}),required:!0,style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsx("textarea",{placeholder:"내용을 입력하세요...",value:p.content,onChange:o=>l({...p,content:o.target.value}),rows:5,style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px",resize:"vertical"}}),e.jsxs("div",{style:{border:"1px dashed rgba(255,255,255,0.3)",borderRadius:"8px",padding:"20px",textAlign:"center"},children:[p.image?e.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[e.jsx("img",{src:p.image,alt:"Preview",style:{maxHeight:"200px",maxWidth:"100%",borderRadius:"8px"}}),e.jsx("button",{type:"button",onClick:()=>l({...p,image:null}),style:{position:"absolute",top:-10,right:-10,background:"red",borderRadius:"50%",width:"24px",height:"24px",border:"none",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Z,{size:14})})]}):e.jsxs("button",{type:"button",onClick:()=>m.current.click(),style:{background:"none",border:"none",color:"var(--accent-color)",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[e.jsx(ye,{size:32}),e.jsx("span",{children:"이미지 추가 (스크린샷 등)"})]}),e.jsx("input",{type:"file",ref:m,onChange:n,accept:"image/*",style:{display:"none"}})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[e.jsx("button",{type:"button",onClick:()=>s(!1),style:{flex:1,padding:"12px",borderRadius:"8px",background:"transparent",border:"1px solid rgba(255,255,255,0.3)",color:"white",cursor:"pointer"},children:"취소"}),e.jsx("button",{type:"submit",style:{flex:1,padding:"12px",borderRadius:"8px",background:"var(--accent-color)",border:"none",color:"white",cursor:"pointer"},children:"게시"})]})]})]})})]})},ct=()=>{const[t,i]=d.useState("home"),[c,b]=d.useState(window.innerWidth<768),[s,p]=d.useState(()=>{try{return JSON.parse(localStorage.getItem("bg3_user_profile"))}catch{return null}});d.useEffect(()=>{const n=()=>b(window.innerWidth<768);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),d.useEffect(()=>{},[s]);const l=n=>{p(n)},m=()=>{switch(t){case"home":return e.jsx(re,{user:s,setActiveTab:i});case"chat":return e.jsx(at,{user:s});case"calendar":return e.jsx(it,{user:s});case"tactics":return e.jsx(dt,{user:s});case"save":return e.jsx(ot,{user:s});case"profile":return e.jsx(ge,{onComplete:l,initialData:s});case"admin":return s?.isAdmin?e.jsx(lt,{user:s}):e.jsx(re,{user:s});default:return e.jsx(re,{user:s})}};return s?e.jsxs("div",{style:{display:"flex",height:"100vh",overflow:"hidden",background:"var(--bg-color)",color:"white"},children:[e.jsx(rt,{activeTab:t,setActiveTab:i,isMobile:c,user:s}),e.jsx("main",{style:{flex:1,padding:0,height:"100vh",overflowY:"auto",position:"relative"},children:e.jsx("div",{style:{padding:c?"20px 20px 100px":"40px",maxWidth:t==="chat"?"100%":"1200px",margin:"0 auto",minHeight:"100%"},children:m()})})]}):e.jsx(ge,{onComplete:l})};function pt(){return e.jsx(ct,{})}class xt extends U.Component{constructor(i){super(i),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(i){return{hasError:!0}}componentDidCatch(i,c){this.setState({error:i,errorInfo:c}),console.error("Uncaught error:",i,c)}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"20px",color:"white",background:"#333"},children:[e.jsx("h1",{children:"Something went wrong."}),e.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),e.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"20px",padding:"10px"},children:"Reload"})]}):this.props.children}}Qe.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(xt,{children:e.jsx(pt,{})})}));
