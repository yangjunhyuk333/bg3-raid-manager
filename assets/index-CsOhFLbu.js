import{r as m,j as e,X as L,M as E,H as O,a as F,C as H,F as P,S as $,L as q,i as U,g as G,q as I,l as K,c as y,o as D,B as V,b as Y,d as M,s as W,f as S,e as J,h as R,k,m as X,U as Q,n as Z,p as ee,t as te,u as re,R as ne,v as se,w as ae,Y as ie,T as oe,x as le,y as de,z as B,A as ce,D as pe,E as xe,G as ge,I as T,J as me,K as ue,N as he,O as be,P as fe,Q as ye,V as je,W as ve,Z as Se,_ as we,$ as ke,a0 as Ce,a1 as ze,a2 as Re,a3 as Ie}from"./vendor-DIJLTz-E.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))p(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&p(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function p(r){if(r.ep)return;r.ep=!0;const l=o(r);fetch(r.href,l)}})();const De=({activeTab:t,setActiveTab:i,isMobile:o,onlineCount:p,user:r})=>{const[l,s]=m.useState(!1),g=[{id:"home",icon:O,label:"í™ˆ"},{id:"chat",icon:F,label:"íŒŒí‹° ì±„íŒ…"},{id:"calendar",icon:H,label:"ë ˆì´ë“œ ì¼ì •"},{id:"save",icon:P,label:"ì„¸ì´ë¸Œ ë¶„ì„"},{id:"settings",icon:$,label:"í™˜ê²½ ì„¤ì •"}],n=c=>{i(c),o&&s(!1)},d=()=>{confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í”„ë¡œí•„ ì •ë³´ê°€ ì‚­ì œë©ë‹ˆë‹¤.")&&(localStorage.removeItem("bg3_user_profile"),window.location.reload())};return e.jsxs(e.Fragment,{children:[o&&e.jsx("button",{onClick:()=>s(!l),style:{position:"fixed",top:"20px",left:"20px",zIndex:100,background:"rgba(0,0,0,0.5)",border:"none",color:"white",padding:"10px",borderRadius:"8px",backdropFilter:"blur(5px)"},children:l?e.jsx(L,{}):e.jsx(E,{})}),e.jsxs("div",{className:`glass-panel sidebar ${o&&!l?"closed":""}`,style:{width:"260px",height:o?"100%":"calc(100vh - 40px)",position:o?"fixed":"sticky",top:o?"0":"20px",left:o?l?"0":"-100%":"20px",margin:o?"0":"20px 0 20px 20px",display:"flex",flexDirection:"column",transition:"all 0.3s ease",zIndex:90},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("h1",{style:{fontSize:"1.5rem",margin:0,background:"linear-gradient(to right, #fff, #aaa)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"BG3 Manager"}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",marginTop:"10px",padding:"4px 10px",background:"rgba(16, 185, 129, 0.2)",borderRadius:"20px",border:"1px solid rgba(16, 185, 129, 0.4)",color:"#6ee7b7",fontSize:"0.8rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",background:"#34d399",borderRadius:"50%",boxShadow:"0 0 5px #34d399"}}),e.jsxs("span",{children:[p,"ëª… ì ‘ì† ì¤‘"]})]})]}),e.jsx("nav",{style:{flex:1,padding:"20px 10px"},children:g.map(c=>{const u=c.icon,h=t===c.id;return e.jsxs("button",{onClick:()=>n(c.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"15px",padding:"12px 15px",marginBottom:"8px",background:h?"var(--accent-color)":"transparent",border:"none",borderRadius:"12px",color:"white",fontSize:"1rem",cursor:"pointer",transition:"all 0.2s",textAlign:"left"},children:[e.jsx(u,{size:20,style:{opacity:h?1:.7}}),c.label]},c.id)})}),r&&e.jsxs("div",{style:{padding:"20px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1.2rem"},children:"ğŸ§™â€â™‚ï¸"}),e.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:r.nickname}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.6},children:r.className})]})]}),e.jsxs("button",{onClick:d,style:{width:"100%",padding:"8px",background:"rgba(255,255,255,0.05)",border:"none",borderRadius:"6px",color:"rgba(255,255,255,0.6)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"0.8rem"},children:[e.jsx(q,{size:14})," ë¡œê·¸ì•„ì›ƒ"]})]})]})]})},_=()=>e.jsxs("div",{className:"glass-panel",children:[e.jsx("h1",{children:"ë°œë”ìŠ¤ ê²Œì´íŠ¸ 3 íŒŒí‹° ê´€ë¦¬ì"}),e.jsx("p",{children:"í™˜ì˜í•©ë‹ˆë‹¤! íŒ€ì›ë“¤ê³¼ ì¼ì •ì„ ì¡°ìœ¨í•˜ê³  ëª¨í—˜ì„ ë– ë‚˜ì„¸ìš”."})]}),Be={apiKey:"AIzaSyAsbaWbo3DoSTrRFhkaf9XujWPpmeGSjAE",authDomain:"bg3-raid-manager.firebaseapp.com",projectId:"bg3-raid-manager",storageBucket:"bg3-raid-manager.firebasestorage.app",messagingSenderId:"773826713403",appId:"1:773826713403:web:c15fdfca708d47f4fcc91e"},Te=U(Be),b=G(Te);console.log("ğŸ”¥ Firebase Connected (Real DB Mode)");const _e=({user:t})=>{const[i,o]=m.useState([]),[p,r]=m.useState(""),[l,s]=m.useState(!0),g=m.useRef(null);m.useEffect(()=>{const d=I(y(b,"chats"),K(100)),c=D(d,u=>{const h=u.docs.map(a=>({id:a.id,...a.data(),timestamp:a.data().timestamp?.toDate().toISOString()||new Date().toISOString()}));h.sort((a,x)=>new Date(a.timestamp)-new Date(x.timestamp)),o(h),s(!1)});return()=>c()},[]),m.useEffect(()=>{g.current?.scrollIntoView({behavior:"smooth"})},[i]);const n=async d=>{if(d.preventDefault(),!p.trim())return;const c=p;r("");try{await M(y(b,"chats"),{text:c,sender:t?.nickname||"Anonymous",userClass:t?.className||"Unknown",uid:t?.id||"guest",timestamp:W()})}catch(u){console.error("Error sending message: ",u)}};return e.jsxs("div",{className:"glass-panel",style:{height:"calc(100vh - 120px)",display:"flex",flexDirection:"column",padding:0},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(V,{color:"#4fd1c5"})," íŒŒí‹° ì‘ì „ íšŒì˜ì‹¤"]}),e.jsx("span",{style:{fontSize:"0.8rem",opacity:.7},children:"ë ˆì´ë“œ ì¼ì •ê³¼ ì „ëµì„ ë…¼ì˜í•˜ì„¸ìš”."})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[l&&e.jsx("div",{style:{textAlign:"center",opacity:.5},children:"ë¡œë”© ì¤‘..."}),i.map(d=>{const c=d.uid===t?.id;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:c?"flex-end":"flex-start"},children:[e.jsx("div",{style:{fontSize:"0.8rem",marginBottom:"4px",opacity:.7,display:"flex",alignItems:"center",gap:"6px"},children:!c&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:["[",d.userClass,"]"]}),d.sender]})}),e.jsx("div",{style:{background:c?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(255, 255, 255, 0.1)",padding:"12px 16px",borderRadius:c?"16px 16px 0 16px":"16px 16px 16px 0",maxWidth:"75%",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.1)",wordBreak:"break-word"},children:d.text}),e.jsx("span",{style:{fontSize:"0.7rem",opacity:.4,marginTop:"4px"},children:new Date(d.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},d.id)}),e.jsx("div",{ref:g})]}),e.jsxs("form",{onSubmit:n,style:{padding:"20px",background:"rgba(0,0,0,0.2)",display:"flex",gap:"10px",borderRadius:"0 0 16px 16px"},children:[e.jsx("input",{type:"text",value:p,onChange:d=>r(d.target.value),placeholder:"ì‘ì „ì„ ì „ë‹¬í•˜ì„¸ìš”...",style:{flex:1,padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.05)",color:"white",outline:"none"}}),e.jsx("button",{type:"submit",style:{padding:"12px",borderRadius:"12px",background:"var(--accent-color)",color:"white",border:"none",cursor:"pointer",transition:"all 0.3s"},children:e.jsx(Y,{size:20})})]})]})},Ae=()=>{const[t,i]=m.useState([]),[o,p]=m.useState(new Date),[r,l]=m.useState(!1),[s,g]=m.useState({title:"",time:"20:00",type:"raid",members:""});m.useEffect(()=>{const a=I(y(b,"schedules")),x=D(a,f=>{const v=f.docs.map(j=>({id:j.id,...j.data()}));i(v)});return()=>x()},[]);const n=S(o,"yyyy-MM-dd"),d=t.filter(a=>a.date===n),c=async a=>{a.preventDefault();try{await M(y(b,"schedules"),{...s,date:n,members:s.members.split(",").map(x=>x.trim()).filter(x=>x)}),l(!1),g({title:"",time:"20:00",type:"raid",members:""})}catch(x){console.error("Error adding schedule: ",x),alert("ì¼ì • ì¶”ê°€ ì‹¤íŒ¨!")}},u=async a=>{window.confirm("ì¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&await R(k(b,"schedules",a))},h=({date:a,view:x})=>{if(x==="month"){const f=S(a,"yyyy-MM-dd");if(t.some(j=>j.date===f))return e.jsx("div",{style:{height:"6px",width:"6px",background:"var(--accent-color)",borderRadius:"50%",margin:"2px auto"}})}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",gap:"30px",flexDirection:"column"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsx("style",{children:`
                    .react-calendar { background: transparent; border: none; width: 100%; color: white; font-family: inherit; }
                    .react-calendar__navigation button { color: white; min-width: 44px; background: none; font-size: 1.2rem; }
                    .react-calendar__navigation button:enabled:hover, .react-calendar__navigation button:enabled:focus { background-color: rgba(255,255,255,0.1); }
                    .react-calendar__month-view__weekdays { text-align: center; text-transform: uppercase; font-weight: bold; font-size: 0.8em; opacity: 0.7; }
                    .react-calendar__month-view__days__day { color: white; padding: 10px; background: transparent; border: none; }
                    .react-calendar__tile:enabled:hover, .react-calendar__tile:enabled:focus { background-color: rgba(255,255,255,0.1); border-radius: 8px; }
                    .react-calendar__tile--now { background: rgba(255,255,255,0.2) !important; border-radius: 8px; }
                    .react-calendar__tile--active { background: var(--accent-color) !important; color: white !important; border-radius: 8px; }
                    abbr[title] { text-decoration: none; }
                `}),e.jsx(J,{onChange:p,value:o,locale:"ko-KR",tileContent:h})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"20px",minHeight:"200px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsxs("h3",{style:{margin:0},children:[S(o,"Mì›” dì¼ (E)",{locale:X})," ì¼ì •"]}),e.jsx("button",{onClick:()=>l(!0),style:{background:"var(--accent-color)",border:"none",color:"white",padding:"8px 16px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:"+ ì¼ì • ì¶”ê°€"})]}),d.length===0?e.jsx("div",{style:{textAlign:"center",padding:"30px",opacity:.5},children:"ë“±ë¡ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:d.map(a=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",borderLeft:`4px solid ${a.type==="raid"?"#f87171":"#60a5fa"}`},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold"},children:a.title}),e.jsxs("div",{style:{fontSize:"0.9rem",opacity:.7,marginTop:"4px"},children:["â° ",a.time," | ğŸ‘¥ ",a.members?.join(", ")||"-"]})]}),e.jsx("button",{onClick:()=>u(a.id),style:{background:"transparent",border:"none",color:"rgba(255,255,255,0.3)",cursor:"pointer"},children:"ì‚­ì œ"})]},a.id))})]}),r&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",backdropFilter:"blur(5px)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},onClick:()=>l(!1),children:e.jsxs("div",{className:"glass-panel",style:{width:"350px",padding:"30px"},onClick:a=>a.stopPropagation(),children:[e.jsx("h3",{children:"ğŸ“… ìƒˆ ì¼ì • ë“±ë¡"}),e.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"20px"},children:[S(o,"yyyyë…„ Mì›” dì¼"),"ì— ì¼ì •ì„ ì¶”ê°€í•©ë‹ˆë‹¤."]}),e.jsxs("form",{onSubmit:c,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx("input",{placeholder:"ì¼ì • ì œëª© (ì˜ˆ: ë¼íŒŒì—˜ ì§‘ë“¤ì´)",value:s.title,onChange:a=>g({...s,title:a.target.value}),required:!0,style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("input",{type:"time",value:s.time,onChange:a=>g({...s,time:a.target.value}),required:!0,style:{flex:1,padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsxs("select",{value:s.type,onChange:a=>g({...s,type:a.target.value}),style:{flex:1,padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"},children:[e.jsx("option",{value:"raid",style:{color:"black"},children:"âš”ï¸ ë ˆì´ë“œ"}),e.jsx("option",{value:"story",style:{color:"black"},children:"ğŸ“œ ìŠ¤í† ë¦¬"})]})]}),e.jsx("input",{placeholder:"ì°¸ì—¬ ë©¤ë²„ (ì‰¼í‘œ êµ¬ë¶„)",value:s.members,onChange:a=>g({...s,members:a.target.value}),style:{padding:"12px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",borderRadius:"8px"}}),e.jsx("button",{type:"submit",style:{marginTop:"10px",padding:"12px",borderRadius:"8px",background:"var(--accent-color)",border:"none",color:"white",cursor:"pointer",fontWeight:"bold"},children:"ë“±ë¡í•˜ê¸°"})]})]})})]})},Me=t=>{const i=t.name,o=i.includes("Honour")||i.includes("Honor");let p=0;for(let x=0;x<i.length;x++)p+=i.charCodeAt(x);const r=()=>(p=(p*9301+49297)%233280,p/233280),l=Math.floor(r()*100)+10,s=Math.min(12,Math.floor(l/5)+1),g=[{name:"ì„€ë„í•˜íŠ¸",id:"shadowheart",score:Math.floor(r()*100),avatar:"ğŸ–¤"},{name:"ì•„ìŠ¤íƒ€ë¦¬ì˜¨",id:"astarion",score:Math.floor(r()*100),avatar:"ğŸ§›"},{name:"ë ˆì´ì ¤",id:"laezel",score:Math.floor(r()*100),avatar:"ğŸ‘½"},{name:"ê²Œì¼",id:"gale",score:Math.floor(r()*100),avatar:"ğŸ§™â€â™‚ï¸"},{name:"ìœŒ",id:"wyll",score:Math.floor(r()*100),avatar:"ğŸ˜ˆ"},{name:"ì¹´ë¥¼ë¼í¬",id:"karlach",score:Math.floor(r()*100),avatar:"â¤ï¸â€ğŸ”¥"}].sort((x,f)=>f.score-x.score),n=x=>x>=90?"ì—°ì¸ (ë§¤ìš° ë†’ìŒ)":x>=70?"ì‹ ë¢° (ë†’ìŒ)":x>=40?"ìš°í˜¸ (ë³´í†µ)":x>=20?"ì¤‘ë¦½ (ë‚®ìŒ)":"ì ëŒ€ (ë§¤ìš° ë‚®ìŒ)",d=Math.floor(r()*2e4)+500,c=Math.floor(r()*2e3),u=Math.floor(r()*300)+50,h=[];u>200&&h.push("ì¸ë²¤í† ë¦¬ê°€ ë„ˆë¬´ ë¬´ê²ìŠµë‹ˆë‹¤! 'ì¡ë™ì‚¬ë‹ˆ' ì•„ì´í…œì„ ìƒì¸ì—ê²Œ ì²˜ë¶„í•˜ì„¸ìš”."),c<100&&h.push("ì•¼ì˜ì§€ ë¬¼ìê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ê¸´ íœ´ì‹ì„ ìœ„í•´ ìŒì‹ì„ ëª¨ìœ¼ì„¸ìš”."),d>1e4&&h.push("ê³¨ë“œê°€ ì¶©ë¶„í•©ë‹ˆë‹¤. ìœ„ë”ìŠ¤ì—ê²Œ ìš©ë³‘ì„ ê³ ìš©í•˜ê±°ë‚˜ ì „ì„¤ ì•„ì´í…œì„ êµ¬ë§¤í•´ë³´ì„¸ìš”.");const a=g[g.length-1];return a.score<30&&h.push(`${a.name}ì˜ í˜¸ê°ë„ê°€ ìœ„í—˜ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ëŒ€í™”ë¥¼ ì‹œë„í•˜ì„¸ìš”.`),{meta:{filename:i,playtime:`${l}ì‹œê°„ ${Math.floor(r()*60)}ë¶„`,level:s,mode:o?"ëª…ì˜ˆ ëª¨ë“œ":"ì „ìˆ ê°€/ì¼ë°˜",lastSave:new Date().toLocaleString(),location:["ë¦¬ë¹™í„´","í•˜ë¶€ ë„ì‹œ","ì—ë©”ë„ë“œ ìˆ²","ê·¸ë¦¼í¬ì§€"][Math.floor(r()*4)]},companions:g.map(x=>({...x,relation:n(x.score)})),economy:{gold:d,campSupplies:c,weight:u,legendaryItems:Math.floor(r()*5),trashValue:Math.floor(r()*1e3)},advices:h}},We=()=>{const[t,i]=m.useState(null),[o,p]=m.useState(!1),[r,l]=m.useState("summary"),s=n=>{n.preventDefault();const d=n.dataTransfer?n.dataTransfer.files:n.target.files;d&&d.length>0&&g(d[0])},g=n=>{if(!n.name.endsWith(".lsv")&&!n.name.endsWith(".save")){alert("ìœ íš¨í•œ ë°œë”ìŠ¤ ê²Œì´íŠ¸ 3 ì„¸ì´ë¸Œ íŒŒì¼(.lsv)ì´ ì•„ë‹™ë‹ˆë‹¤.");return}p(!0),setTimeout(()=>{const d=Me(n);i(d),p(!1)},1500)};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{className:"glass-panel",onDragOver:n=>n.preventDefault(),onDrop:s,style:{padding:"40px",textAlign:"center",border:"2px dashed rgba(255,255,255,0.2)",cursor:"pointer",transition:"all 0.3s"},children:[e.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},accept:".lsv,.save",onChange:s}),!t&&!o&&e.jsxs("label",{htmlFor:"fileInput",style:{cursor:"pointer",display:"block"},children:[e.jsx(Q,{size:48,style:{opacity:.5,marginBottom:"15px"}}),e.jsx("h2",{style:{margin:"0 0 10px 0"},children:"ì„¸ì´ë¸Œ íŒŒì¼ ì—…ë¡œë“œ"}),e.jsxs("p",{style:{opacity:.6},children:[".lsv íŒŒì¼ì„ ì´ê³³ì— ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”.",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.8rem"},children:"(íŒŒì¼ì€ ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•Šê³  ë¸Œë¼ìš°ì €ì—ì„œ ì•ˆì „í•˜ê²Œ ë¶„ì„ë©ë‹ˆë‹¤)"})]})]}),o&&e.jsxs("div",{children:[e.jsx("div",{className:"spinner",style:{width:"40px",height:"40px",border:"4px solid rgba(255,255,255,0.1)",borderTop:"4px solid var(--accent-color)",borderRadius:"50%",margin:"0 auto 20px auto",animation:"spin 1s linear infinite"}}),e.jsx("h3",{children:"ë§ˆì¸ë“œ í”Œë ˆì´ì–´ ê¸°ìƒì¶©ì´ ê¸°ì–µì„ ì½ëŠ” ì¤‘..."})]}),t&&!o&&e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"20px"},children:[e.jsx("div",{style:{fontSize:"3rem"},children:"ğŸ“œ"}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("h2",{style:{margin:0},children:t.meta.filename}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginTop:"5px"},children:[e.jsx("span",{style:{background:"rgba(251, 191, 36, 0.2)",color:"#fbbf24",padding:"2px 8px",borderRadius:"4px",fontSize:"0.9rem",border:"1px solid rgba(251, 191, 36, 0.4)"},children:"âš ï¸ ì‹œë®¬ë ˆì´ì…˜ ë¶„ì„"}),e.jsxs("p",{style:{margin:0,opacity:.7},children:[t.meta.mode," â€¢ Lv.",t.meta.level," â€¢ ",t.meta.playtime]})]})]}),e.jsx("button",{onClick:()=>i(null),style:{marginLeft:"20px",padding:"8px 16px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",borderRadius:"6px",cursor:"pointer"},children:"ë‹¤ë¥¸ íŒŒì¼ ë¶„ì„"})]})]}),t&&!o&&e.jsxs("div",{className:"glass-panel",style:{minHeight:"500px",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{display:"flex",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[{id:"summary",label:"ëª¨í—˜ ìš”ì•½",icon:Z},{id:"companions",label:"ë™ë£Œ í˜¸ê°ë„",icon:ee},{id:"economy",label:"ê²½ì œ/ì¸ë²¤í† ë¦¬",icon:te}].map(n=>e.jsxs("button",{onClick:()=>l(n.id),style:{flex:1,padding:"20px",background:r===n.id?"var(--accent-color)":"transparent",border:"none",color:"white",fontSize:"1rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer",transition:"all 0.2s",borderBottom:r===n.id?"2px solid white":"none"},children:[e.jsx(n.icon,{size:18})," ",n.label]},n.id))}),e.jsxs("div",{style:{padding:"30px"},children:[r==="summary"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"30px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)",paddingBottom:"10px"},children:"í˜„ì¬ ìƒíƒœ"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px",marginTop:"15px"},children:[e.jsx(w,{label:"í˜„ì¬ ìœ„ì¹˜",value:t.meta.location}),e.jsx(w,{label:"í”Œë ˆì´ íƒ€ì„",value:t.meta.playtime}),e.jsx(w,{label:"íŒŒí‹° ë ˆë²¨",value:`Lv. ${t.meta.level}`}),e.jsx(w,{label:"ë‚œì´ë„",value:t.meta.mode})]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"12px"},children:[e.jsxs("h3",{style:{marginTop:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(re,{size:20,color:"#fbbf24"})," ìœ„ë”ìŠ¤ì˜ ì¡°ì–¸"]}),e.jsx("ul",{style:{paddingLeft:"20px",lineHeight:"1.6",fontSize:"0.9rem"},children:t.advices&&t.advices.map((n,d)=>e.jsx("li",{style:{marginBottom:"5px"},children:n},d))})]})]}),r==="companions"&&e.jsxs("div",{style:{height:"400px"},children:[e.jsx(ne,{width:"100%",height:"100%",children:e.jsxs(se,{data:t.companions,layout:"vertical",margin:{left:20},children:[e.jsx(ae,{type:"number",domain:[0,100],hide:!0}),e.jsx(ie,{dataKey:"name",type:"category",width:80,tick:{fill:"white"}}),e.jsx(oe,{contentStyle:{background:"#1a1c2c",border:"none",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.1)"}}),e.jsx(le,{dataKey:"score",radius:[0,4,4,0],children:t.companions.map((n,d)=>e.jsx(de,{fill:n.score>80?"#ec4899":n.score>40?"#3b82f6":"#ef4444"},`cell-${d}`))})]})}),e.jsx("div",{style:{display:"flex",gap:"10px",marginTop:"20px",justifyContent:"center",flexWrap:"wrap"},children:t.companions.map(n=>e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"8px 12px",borderRadius:"20px",fontSize:"0.9rem"},children:[n.avatar," ",n.name,": ",e.jsxs("span",{style:{color:n.score>50?"#4ade80":"#f87171"},children:[n.relation," (",n.score,")"]})]},n.id))})]}),r==="economy"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[e.jsx(z,{icon:"ğŸ’°",title:"ì†Œì§€ê¸ˆ",value:`${t.economy.gold.toLocaleString()} G`,sub:"íŒŒí‹° ì „ì²´ í•©ê³„"}),e.jsx(z,{icon:"ğŸ",title:"ì•¼ì˜ì§€ ë¬¼ì",value:t.economy.campSupplies,sub:"ê¸´ íœ´ì‹ ê°€ëŠ¥"}),e.jsx(z,{icon:"âš–ï¸",title:"ì´ ë¬´ê²Œ",value:`${t.economy.weight} kg`,sub:`ì¡ë™ì‚¬ë‹ˆ ê°€ì¹˜: ${t.economy.trashValue} G`}),e.jsxs("div",{style:{gridColumn:"1 / -1",marginTop:"20px",background:"rgba(255,255,255,0.05)",padding:"20px",borderRadius:"12px",textAlign:"left"},children:[e.jsx("h3",{children:"ğŸ’¡ ê²½ì œ í™œë™ íŒ"}),e.jsxs("p",{children:["í˜„ì¬ ë³´ìœ í•œ ì¡ë™ì‚¬ë‹ˆë§Œ íŒ”ì•„ë„ ",e.jsxs("strong",{children:[t.economy.trashValue," ê³¨ë“œ"]}),"ë¥¼ ë²Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤."]}),e.jsx("p",{children:"ê°€ì¥ ê°€ê¹Œìš´ ìƒì¸ì—ê²Œ ì´ë™í•˜ì—¬ 'ì¡ë™ì‚¬ë‹ˆ íŒë§¤' ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”."})]})]})]})]})]})},w=({label:t,value:i})=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"8px"},children:[e.jsx("span",{style:{opacity:.6},children:t}),e.jsx("span",{style:{fontWeight:"bold"},children:i})]}),z=({icon:t,title:i,value:o,sub:p})=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:"20px",borderRadius:"12px"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"10px"},children:t}),e.jsx("div",{style:{opacity:.7,fontSize:"0.9rem"},children:i}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",margin:"5px 0"},children:o}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.5},children:p})]}),Ne=({user:t})=>{const[i,o]=m.useState(!1),[p,r]=m.useState(0),l=()=>{window.confirm("í˜„ì¬ í”„ë¡œí•„ì„ ì‚­ì œí•˜ê³  ì²˜ìŒ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(localStorage.removeItem("bg3_user_profile"),window.location.reload())},s=async()=>{o(!0);try{const n=(await T(y(b,"chats"))).docs.map(u=>R(k(b,"chats",u.id))),c=(await T(y(b,"schedules"))).docs.map(u=>R(k(b,"schedules",u.id)));await Promise.all([...n,...c]),r(2)}catch(g){console.error("Error resetting world:",g),alert("ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+g.message)}finally{o(!1)}};return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsxs("h1",{style:{fontSize:"1.5rem",margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(B,{})," í™˜ê²½ ì„¤ì •"]}),e.jsx("p",{style:{opacity:.7,marginTop:"5px"},children:"ì• í”Œë¦¬ì¼€ì´ì…˜ í™˜ê²½ì„ ê´€ë¦¬í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"30px"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:"0 0 20px 0",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"10px"},children:[e.jsx(ce,{size:20,style:{verticalAlign:"middle",marginRight:"8px"}}),"ë‚˜ì˜ ëª¨í—˜ê°€ ì •ë³´"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px",marginBottom:"30px"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"2rem"},children:"ğŸ§™â€â™‚ï¸"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:t.nickname}),e.jsx("div",{style:{fontSize:"1rem",opacity:.7,color:"var(--accent-color)"},children:t.className})]})]}),e.jsxs("button",{onClick:l,style:{padding:"12px 20px",borderRadius:"8px",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},children:[e.jsx(B,{size:16})," ë‹¤ë¥¸ ì‹ ë¶„ìœ¼ë¡œ ë‹¤ì‹œ ì‹œì‘í•˜ê¸° (ë¡œê·¸ì•„ì›ƒ)"]})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"30px",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:"0 0 20px 0",color:"#f87171",borderBottom:"1px solid rgba(239, 68, 68, 0.2)",paddingBottom:"10px"},children:[e.jsx(pe,{size:20,style:{verticalAlign:"middle",marginRight:"8px"}}),"ì„œë²„ ë°ì´í„° ê´€ë¦¬ (ìœ„í—˜)"]}),e.jsxs("p",{style:{opacity:.8,marginBottom:"20px"},children:["ì„œë²„ì— ì €ì¥ëœ ",e.jsx("strong",{children:"ëª¨ë“  ì±„íŒ… ë‚´ì—­ê³¼ ë ˆì´ë“œ ì¼ì •"}),"ì„ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œí•©ë‹ˆë‹¤.",e.jsx("br",{}),"ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë‹ˆ íŒŒí‹°ì›ë“¤ê³¼ ìƒì˜ í›„ ì§„í–‰í•˜ì„¸ìš”."]}),p===0&&e.jsxs("button",{onClick:()=>r(1),style:{padding:"12px 20px",borderRadius:"8px",background:"#ef4444",border:"none",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontWeight:"bold"},children:[e.jsx(xe,{size:16})," ì›”ë“œ ë°ì´í„° ì´ˆê¸°í™” (Reset World)"]}),p===1&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",padding:"20px",borderRadius:"8px"},children:[e.jsx("p",{style:{color:"#fca5a5",fontWeight:"bold",marginBottom:"15px"},children:"âš ï¸ ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:s,disabled:i,style:{flex:1,padding:"10px",borderRadius:"6px",background:"#ef4444",border:"none",color:"white",fontWeight:"bold",cursor:"pointer"},children:i?"ì´ˆê¸°í™” ì¤‘...":"ë„¤, ëª¨ë‘ ì‚­ì œí•©ë‹ˆë‹¤"}),e.jsx("button",{onClick:()=>r(0),disabled:i,style:{flex:1,padding:"10px",borderRadius:"6px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:"ì·¨ì†Œ"})]})]}),p===2&&e.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#4ade80"},children:[e.jsx(ge,{size:40,style:{marginBottom:"10px"}}),e.jsx("div",{children:"ì´ˆê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsx("button",{onClick:()=>r(0),style:{marginTop:"15px",padding:"8px 16px",borderRadius:"6px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:"ëŒì•„ê°€ê¸°"})]})]})]})},A=[{id:"barbarian",name:"ë°”ë°”ë¦¬ì•ˆ",icon:me,color:"#ef4444"},{id:"bard",name:"ë°”ë“œ",icon:ue,color:"#ec4899"},{id:"cleric",name:"í´ë ˆë¦­",icon:he,color:"#fbbf24"},{id:"druid",name:"ë“œë£¨ì´ë“œ",icon:be,color:"#22c55e"},{id:"fighter",name:"íŒŒì´í„°",icon:fe,color:"#f59e0b"},{id:"monk",name:"ëª½í¬",icon:ye,color:"#3b82f6"},{id:"paladin",name:"íŒ”ë¼ë”˜",icon:je,color:"#eab308"},{id:"ranger",name:"ë ˆì¸ì €",icon:ve,color:"#10b981"},{id:"rogue",name:"ë¡œê·¸",icon:Se,color:"#64748b"},{id:"sorcerer",name:"ì†Œì„œëŸ¬",icon:we,color:"#06b6d4"},{id:"warlock",name:"ì›Œë½",icon:ke,color:"#a855f7"},{id:"wizard",name:"ìœ„ìë“œ",icon:Ce,color:"#6366f1"}],Le=({onComplete:t})=>{const[i,o]=m.useState(""),[p,r]=m.useState(A[0]),l=s=>{if(s.preventDefault(),!i.trim())return;const g={id:"user_"+Date.now()+Math.random().toString(36).substr(2,9),nickname:i.trim(),classId:p.id,className:p.name,createdAt:new Date().toISOString()};localStorage.setItem("bg3_user_profile",JSON.stringify(g)),t(g)};return e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px",background:"linear-gradient(135deg, #1a1c2c 0%, #4a192c 100%)",color:"white"},children:e.jsxs("div",{className:"glass-panel",style:{width:"100%",maxWidth:"400px",padding:"40px"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[e.jsx(ze,{size:48,color:"#fbbf24",style:{marginBottom:"10px"}}),e.jsx("h1",{style:{fontSize:"1.8rem",margin:"0 0 10px 0"},children:"ëª¨í—˜ê°€ ë“±ë¡"}),e.jsxs("p",{style:{opacity:.7},children:["ë°œë”ìŠ¤ ê²Œì´íŠ¸ë¡œ ë– ë‚˜ê¸° ì „,",e.jsx("br",{}),"ì‹ ë¶„ì„ ì¦ëª…í•˜ì‹­ì‹œì˜¤."]})]}),e.jsxs("form",{onSubmit:l,style:{display:"flex",flexDirection:"column",gap:"25px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",fontSize:"0.9rem",opacity:.8},children:"ë‹‰ë„¤ì„"}),e.jsx("input",{type:"text",value:i,onChange:s=>o(s.target.value),placeholder:"ì˜ˆ: íƒ€ë¸Œ, ì–´ë‘ìš´ì¶©ë™",required:!0,maxLength:10,style:{width:"100%",padding:"12px",boxSizing:"border-box",background:"rgba(255,255,255,0.1)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px",color:"white",fontSize:"1rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"10px",fontSize:"0.9rem",opacity:.8},children:"ì§ì—… ì„ íƒ"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},children:A.map(s=>{const g=s.icon,n=p.id===s.id;return e.jsxs("div",{onClick:()=>r(s),style:{border:n?`2px solid ${s.color}`:"1px solid rgba(255,255,255,0.1)",background:n?"rgba(255,255,255,0.1)":"transparent",borderRadius:"8px",padding:"10px",cursor:"pointer",textAlign:"center",transition:"all 0.2s"},children:[e.jsx(g,{size:24,color:s.color,style:{marginBottom:"5px"}}),e.jsx("div",{style:{fontSize:"0.8rem"},children:s.name})]},s.id)})})]}),e.jsx("button",{type:"submit",style:{marginTop:"20px",padding:"15px",borderRadius:"8px",background:"var(--accent-color)",border:"none",color:"white",fontSize:"1rem",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",background:"linear-gradient(90deg, #d97706 0%, #b45309 100%)"},children:"ëª¨í—˜ ì‹œì‘í•˜ê¸° âš”ï¸"})]})]})})},Ee=()=>{const[t,i]=m.useState(null),[o,p]=m.useState(1),[r,l]=m.useState("home"),[s,g]=m.useState(window.innerWidth<768);m.useEffect(()=>{const c=localStorage.getItem("bg3_user_profile");c&&i(JSON.parse(c));const u=()=>g(window.innerWidth<768);return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[]),m.useEffect(()=>{if(!t)return;const c=async()=>{try{await Re(k(b,"online_users",t.id),{nickname:t.nickname,classId:t.classId||"unknown",lastSeen:W()},{merge:!0})}catch(x){console.error("Heartbeat fail:",x)}};c();const u=setInterval(c,3e4),h=I(y(b,"online_users")),a=D(h,x=>{const f=Date.now(),v=x.docs.filter(j=>{const C=j.data();if(!C.lastSeen)return!1;const N=C.lastSeen.toDate?C.lastSeen.toDate().getTime():0;return f-N<12e4});p(v.length)});return()=>{clearInterval(u),a()}},[t]);const n=c=>{i(c)},d=()=>{switch(r){case"home":return e.jsx(_,{user:t});case"chat":return e.jsx(_e,{user:t});case"calendar":return e.jsx(Ae,{user:t});case"save":return e.jsx(We,{user:t});case"settings":return e.jsx(Ne,{user:t});default:return e.jsx(_,{user:t})}};return t?e.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"var(--bg-color)"},children:[e.jsx(De,{activeTab:r,setActiveTab:l,isMobile:s,onlineCount:o,user:t}),e.jsx("main",{style:{flex:1,padding:s?"80px 20px 20px":"20px",overflowY:"auto",position:"relative"},children:d()})]}):e.jsx(Le,{onComplete:n})};function Oe(){return e.jsx(Ee,{})}Ie.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(Oe,{})}));
