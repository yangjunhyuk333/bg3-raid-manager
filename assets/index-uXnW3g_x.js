import{r as g,H as U,M as P,C as L,F as M,S as $,a as I,j as e,X as _,b as H,L as N,i as K,g as q,q as A,l as G,c as w,o as R,B as J,d as X,e as Y,s as B,f as V,U as E,h as O,k,m as T,n as Z,p as Q,t as ee,u as F,T as te,v as se,w as ne,x as re,y as C,z as ie,A as ae,D as oe,E as le,G as de,I as ce,J as pe,K as xe,Z as ge,W as ue,N as he,O as W,P as me}from"./vendor-Dt2e1p0b.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))l(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function p(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerPolicy&&(i.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?i.credentials="include":d.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(d){if(d.ep)return;d.ep=!0;const i=p(d);fetch(d.href,i)}})();const fe=({activeTab:s,setActiveTab:c,isMobile:p,onlineCount:l,user:d})=>{const[i,u]=g.useState(!1),o=[{id:"home",icon:U,label:"í™ˆ"},{id:"chat",icon:P,label:"íŒŒí‹° ì±„íŒ…"},{id:"calendar",icon:L,label:"ë ˆì´ë“œ ì¼ì •"},{id:"save",icon:M,label:"ì„¸ì´ë¸Œ ë¶„ì„"},{id:"settings",icon:$,label:"í™˜ê²½ ì„¤ì •"},...d?.isAdmin?[{id:"admin",icon:I,label:"ë‚˜ì˜ ì˜ì§€ (ê´€ë¦¬)"}]:[]],y=t=>{c(t),p&&u(!1)},r=()=>{confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í”„ë¡œí•„ ì •ë³´ê°€ ì‚­ì œë©ë‹ˆë‹¤.")&&(localStorage.removeItem("bg3_user_profile"),window.location.reload())};return e.jsxs(e.Fragment,{children:[p&&e.jsx("button",{onClick:()=>u(!i),style:{position:"fixed",top:"20px",left:"20px",zIndex:100,background:"rgba(0,0,0,0.5)",border:"none",color:"white",padding:"10px",borderRadius:"8px",backdropFilter:"blur(5px)"},children:i?e.jsx(_,{}):e.jsx(H,{})}),e.jsxs("div",{className:`glass-panel sidebar ${p&&!i?"closed":""}`,style:{width:"260px",height:p?"100%":"calc(100vh - 40px)",position:p?"fixed":"sticky",top:p?"0":"20px",left:p?i?"0":"-100%":"20px",margin:p?"0":"20px 0 20px 20px",display:"flex",flexDirection:"column",transition:"all 0.3s ease",zIndex:90},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsx("h1",{style:{fontSize:"1.5rem",margin:0,background:"linear-gradient(to right, #fff, #aaa)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"BG3 Manager"}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",marginTop:"10px",padding:"4px 10px",background:"rgba(16, 185, 129, 0.2)",borderRadius:"20px",border:"1px solid rgba(16, 185, 129, 0.4)",color:"#6ee7b7",fontSize:"0.8rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",background:"#34d399",borderRadius:"50%",boxShadow:"0 0 5px #34d399"}}),e.jsxs("span",{children:[l,"ëª… ì ‘ì† ì¤‘"]})]})]}),e.jsx("nav",{style:{flex:1,padding:"20px 10px"},children:o.map(t=>{const b=t.icon,h=s===t.id;return e.jsxs("button",{onClick:()=>y(t.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"15px",padding:"12px 15px",marginBottom:"8px",background:h?"var(--accent-color)":"transparent",border:"none",borderRadius:"12px",color:"white",fontSize:"1rem",cursor:"pointer",transition:"all 0.2s",textAlign:"left"},children:[e.jsx(b,{size:20,style:{opacity:h?1:.7}}),t.label]},t.id)})}),d&&e.jsxs("div",{style:{padding:"20px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1.2rem"},children:"ðŸ§™â€â™‚ï¸"}),e.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:d.nickname}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.6},children:d.className})]})]}),e.jsxs("button",{onClick:r,style:{width:"100%",padding:"8px",background:"rgba(255,255,255,0.05)",border:"none",borderRadius:"6px",color:"rgba(255,255,255,0.6)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"0.8rem"},children:[e.jsx(N,{size:14})," ë¡œê·¸ì•„ì›ƒ"]})]})]})]})},D=()=>e.jsxs("div",{className:"glass-panel",children:[e.jsx("h1",{children:"ë°œë”ìŠ¤ ê²Œì´íŠ¸ 3 íŒŒí‹° ê´€ë¦¬ìž"}),e.jsx("p",{children:"í™˜ì˜í•©ë‹ˆë‹¤! íŒ€ì›ë“¤ê³¼ ì¼ì •ì„ ì¡°ìœ¨í•˜ê³  ëª¨í—˜ì„ ë– ë‚˜ì„¸ìš”."})]}),be={apiKey:"AIzaSyAsbaWbo3DoSTrRFhkaf9XujWPpmeGSjAE",authDomain:"bg3-raid-manager.firebaseapp.com",projectId:"bg3-raid-manager",storageBucket:"bg3-raid-manager.firebasestorage.app",messagingSenderId:"773826713403",appId:"1:773826713403:web:c15fdfca708d47f4fcc91e"},ye=K(be),v=q(ye);console.log("ðŸ”¥ Firebase Connected (Real DB Mode)");const je=({user:s})=>{const[c,p]=g.useState([]),[l,d]=g.useState(""),[i,u]=g.useState(!0),o=g.useRef(null);g.useEffect(()=>{const r=A(w(v,"chats"),G(100)),t=R(r,b=>{const h=b.docs.map(j=>({id:j.id,...j.data(),timestamp:j.data().timestamp?.toDate().toISOString()||new Date().toISOString()}));h.sort((j,a)=>new Date(j.timestamp)-new Date(a.timestamp)),p(h),u(!1)});return()=>t()},[]),g.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[c]);const y=async r=>{if(r.preventDefault(),!l.trim())return;const t=l;d("");try{await Y(w(v,"chats"),{text:t,sender:s?.nickname||"Anonymous",userClass:s?.className||"Unknown",uid:s?.id||"guest",timestamp:B()})}catch(b){console.error("Error sending message: ",b)}};return e.jsxs("div",{className:"glass-panel",style:{height:"calc(100vh - 120px)",display:"flex",flexDirection:"column",padding:0},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(J,{color:"#4fd1c5"})," íŒŒí‹° ìž‘ì „ íšŒì˜ì‹¤"]}),e.jsx("span",{style:{fontSize:"0.8rem",opacity:.7},children:"ë ˆì´ë“œ ì¼ì •ê³¼ ì „ëžµì„ ë…¼ì˜í•˜ì„¸ìš”."})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[i&&e.jsx("div",{style:{textAlign:"center",opacity:.5},children:"ë¡œë”© ì¤‘..."}),c.map(r=>{const t=r.uid===s?.id;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:t?"flex-end":"flex-start"},children:[e.jsx("div",{style:{fontSize:"0.8rem",marginBottom:"4px",opacity:.7,display:"flex",alignItems:"center",gap:"6px"},children:!t&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:["[",r.userClass,"]"]}),r.sender]})}),e.jsx("div",{style:{background:t?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(255, 255, 255, 0.1)",padding:"12px 16px",borderRadius:t?"16px 16px 0 16px":"16px 16px 16px 0",maxWidth:"75%",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.1)",wordBreak:"break-word"},children:r.text}),e.jsx("span",{style:{fontSize:"0.7rem",opacity:.4,marginTop:"4px"},children:new Date(r.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},r.id)}),e.jsx("div",{ref:o})]}),e.jsxs("form",{onSubmit:y,style:{padding:"20px",background:"rgba(0,0,0,0.2)",display:"flex",gap:"10px",borderRadius:"0 0 16px 16px"},children:[e.jsx("input",{type:"text",value:l,onChange:r=>d(r.target.value),placeholder:"ìž‘ì „ì„ ì „ë‹¬í•˜ì„¸ìš”...",style:{flex:1,padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.05)",color:"white",outline:"none"}}),e.jsx("button",{type:"submit",style:{padding:"12px",borderRadius:"12px",background:"var(--accent-color)",color:"white",border:"none",cursor:"pointer",transition:"all 0.3s"},children:e.jsx(X,{size:20})})]})]})},ve=({user:s})=>{const c=()=>{const a=[];for(let m=0;m<7;m++){const n=new Date;n.setDate(n.getDate()+m),a.push(n.toISOString().split("T")[0])}return a},p=()=>[18,19,20,21,22,23,0,1,2],[l,d]=g.useState(new Date().toISOString().split("T")[0]),[i,u]=g.useState([]),[o,y]=g.useState([]),[r,t]=g.useState(c()),b=p();g.useEffect(()=>{const a=A(w(v,"schedules")),m=R(a,n=>{const f=n.docs.map(S=>({id:S.id,...S.data()}));y(f);const x=f.filter(S=>S.userId===s.id);u(x)});return()=>m()},[s]);const h=async(a,m)=>{const n=`${a}_${s.id}`,f=i.find(S=>S.id===n);let x=f?f.times:[];x.includes(m)?x=x.filter(S=>S!==m):x=[...x,m],x.length===0?f&&await O(k(v,"schedules",n)):await T(k(v,"schedules",n),{userId:s.id,nickname:s.nickname,date:a,times:x,updatedAt:new Date().toISOString()})},j=(a,m)=>{const n=o.filter(f=>f.date===a&&f.times.includes(m)).map(f=>f.nickname);return{count:n.length,names:n}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsx("div",{className:"glass-panel",style:{padding:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsxs("div",{children:[e.jsxs("h2",{style:{margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(L,{})," ë ˆì´ë“œ ì‹œê°„í‘œ ì¡°ì •"]}),e.jsx("p",{style:{margin:"5px 0 0 0",opacity:.7},children:"ê°€ëŠ¥í•œ ì‹œê°„ì„ ì²´í¬í•˜ë©´, ëª¨ë“  íŒŒí‹°ì›ì´ ê²¹ì¹˜ëŠ” 'Golden Time'ì„ ì°¾ì•„ì¤ë‹ˆë‹¤."})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"20px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsx("h3",{style:{marginTop:0},children:"ðŸ“… ë‚ ì§œ ì„ íƒ"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"5px",marginBottom:"20px"},children:r.map(a=>e.jsxs("button",{onClick:()=>d(a),style:{padding:"12px",borderRadius:"8px",border:"none",background:l===a?"var(--accent-color)":"rgba(255,255,255,0.05)",color:"white",cursor:"pointer",textAlign:"left",fontWeight:l===a?"bold":"normal",display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:a}),i.find(m=>m.date===a)&&e.jsx(V,{size:16})]},a))}),e.jsxs("h3",{style:{marginTop:0},children:["â±ï¸ ",l," ê°€ëŠ¥ ì‹œê°„"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:b.map(a=>{const m=i.find(n=>n.date===l)?.times.includes(a);return e.jsx("button",{onClick:()=>h(l,a),style:{padding:"10px",borderRadius:"6px",border:"1px solid "+(m?"var(--accent-color)":"rgba(255,255,255,0.2)"),background:m?"rgba(99, 102, 241, 0.3)":"transparent",color:m?"white":"rgba(255,255,255,0.6)",cursor:"pointer"},children:a<10?`0${a}:00`:`${a}:00`},a)})})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsxs("h3",{style:{marginTop:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(E,{})," íŒŒí‹° í•©ë¥˜ í˜„í™©",e.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"normal",opacity:.6},children:"(ì´ˆë¡ìƒ‰ì´ ë² ìŠ¤íŠ¸ íƒ€ìž„!)"})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:"ì‹œê°„"}),r.map(a=>e.jsx("th",{style:{padding:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:a.slice(5)},a))]})}),e.jsx("tbody",{children:b.map(a=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px",borderBottom:"1px solid rgba(255,255,255,0.05)",fontWeight:"bold",color:"rgba(255,255,255,0.7)"},children:a<10?`0${a}:00`:`${a}:00`}),r.map(m=>{const{count:n,names:f}=j(m,a);let x="transparent";return n===4?x="rgba(74, 222, 128, 0.6)":n===3?x="rgba(251, 191, 36, 0.4)":n>0&&(x="rgba(239, 68, 68, 0.2)"),e.jsx("td",{style:{background:x,borderBottom:"1px solid rgba(255,255,255,0.05)",textAlign:"center",cursor:"grab"},title:n>0?`${f.join(", ")} ê°€ëŠ¥`:"",children:n>0&&n},m+a)})]},a))})]})}),e.jsx("div",{style:{marginTop:"20px",fontSize:"0.8rem",opacity:.6,textAlign:"center"},children:"ê° ì¹¸ì˜ ìˆ«ìžëŠ” í•´ë‹¹ ì‹œê°„ì— ì°¸ì—¬ ê°€ëŠ¥í•œ ì¸ì› ìˆ˜ìž…ë‹ˆë‹¤. ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ëˆ„êµ¬ì¸ì§€ ë³´ìž…ë‹ˆë‹¤."})]})]})]})},Se=new TextDecoder("utf-8"),we=async s=>new Promise((c,p)=>{const l=new FileReader;l.onload=d=>{try{const i=d.target.result,u=new DataView(i),o=i.byteLength;if(String.fromCharCode(u.getUint8(0),u.getUint8(1),u.getUint8(2),u.getUint8(3))!=="LSPK")throw new Error("ìœ íš¨í•œ BG3 ì„¸ì´ë¸Œ íŒŒì¼(LSPK)ì´ ì•„ë‹™ë‹ˆë‹¤.");const r=u.getUint32(4,!0),t=Math.min(o,20*1024*1024),b=new Uint8Array(i,0,t);let h="";try{h=Se.decode(b)}catch{h=Array.from(b).map(S=>String.fromCharCode(S)).join("")}let j="ì•Œ ìˆ˜ ì—†ìŒ";h.includes("Honour")?j="ëª…ì˜ˆ (Honour)":h.includes("Tactician")?j="ì „ìˆ ê°€ (Tactician)":h.includes("Balancer")||h.includes("Balanced")?j="ê· í˜• (Balanced)":(h.includes("Story")||h.includes("Explorer"))&&(j="íƒí—˜ê°€ (Explorer)");const a={Shadowheart:{name:"ì„€ë„í•˜íŠ¸",id:"shadowheart",avatar:"ðŸ–¤"},Astarion:{name:"ì•„ìŠ¤íƒ€ë¦¬ì˜¨",id:"astarion",avatar:"ðŸ§›"},"Lae'zel":{name:"ë ˆì´ì ¤",id:"laezel",avatar:"ðŸ‘½"},Gale:{name:"ê²Œì¼",id:"gale",avatar:"ðŸ§™â€â™‚ï¸"},Wyll:{name:"ìœŒ",id:"wyll",avatar:"ðŸ˜ˆ"},Karlach:{name:"ì¹´ë¥¼ë¼í¬",id:"karlach",avatar:"â¤ï¸â€ðŸ”¥"},Halsin:{name:"í• ì‹ ",id:"halsin",avatar:"ðŸ»"},Minthara:{name:"ë¯¼íƒ€ë¼",id:"minthara",avatar:"ðŸ§â€â™€ï¸"},Jaheira:{name:"ìží—¤ì´ë¼",id:"jaheira",avatar:"ðŸŒ¿"},Minsc:{name:"ë¯¼ìŠ¤í¬",id:"minsc",avatar:"ðŸ¹"}},m=[];Object.keys(a).forEach(x=>{h.includes(x)&&m.push(a[x])});const n=h.includes("GustavDev")?"ë°”ë‹ë¼/ê³µì‹":"ëª¨ë“œ ê°ì§€ë¨",f={meta:{filename:s.name,version:`LSPK v${r}`,mode:j,lastSave:new Date(s.lastModified).toLocaleString(),size:`${(o/(1024*1024)).toFixed(2)} MB`,isModded:n},companions:m.map(x=>({...x,relation:"íŒŒí‹° í•©ë¥˜ í™•ì¸ë¨"})),rawScanSuccess:!0,playtime:null,level:null,gold:null};c(f)}catch(i){p(i)}},l.onerror=()=>p(l.error),l.readAsArrayBuffer(s)}),ke=({user:s})=>{const[c,p]=g.useState(null),[l,d]=g.useState(!1),[i,u]=g.useState(null),o=r=>{r.preventDefault();const t=r.dataTransfer?r.dataTransfer.files:r.target.files;t&&t.length>0&&y(t[0])},y=async r=>{if(!r.name.endsWith(".lsv")&&!r.name.endsWith(".save")){alert("ìœ íš¨í•œ ë°œë”ìŠ¤ ê²Œì´íŠ¸ 3 ì„¸ì´ë¸Œ íŒŒì¼(.lsv)ì´ ì•„ë‹™ë‹ˆë‹¤.");return}d(!0),u(null),p(null);try{const t=await we(r);p(t)}catch(t){console.error(t),u(t.message||"íŒŒì¼ ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{d(!1)}};return e.jsx("div",{style:{maxWidth:"800px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"20px"},children:e.jsxs("div",{className:"glass-panel",onDragOver:r=>r.preventDefault(),onDrop:o,style:{padding:"40px",textAlign:"center",border:"2px dashed rgba(255,255,255,0.2)",cursor:"pointer",transition:"all 0.3s"},children:[e.jsx("input",{type:"file",id:"fileInput",style:{display:"none"},accept:".lsv,.save",onChange:o}),!c&&!l&&e.jsxs("label",{htmlFor:"fileInput",style:{cursor:"pointer",display:"block"},children:[e.jsx(Z,{size:48,style:{opacity:.5,marginBottom:"15px"}}),e.jsx("h2",{style:{margin:"0 0 10px 0"},children:"ì„¸ì´ë¸Œ íŒŒì¼ ì •ë°€ ë¶„ì„ (Real Scan)"}),e.jsxs("p",{style:{opacity:.6},children:[".lsv íŒŒì¼ì„ ì´ê³³ì— ë“œëž˜ê·¸í•˜ì„¸ìš”.",e.jsx("br",{}),e.jsx("span",{style:{fontSize:"0.8rem",color:"#fbbf24"},children:"(ì£¼ì˜: íŒŒì¼ ë³€ì¡° ì—†ì´ ì½ê¸° ì „ìš©ìœ¼ë¡œ í—¤ë”ì™€ í…ìŠ¤íŠ¸ë§Œ ìŠ¤ìº”í•©ë‹ˆë‹¤)"})]}),i&&e.jsxs("div",{style:{color:"#ef4444",marginTop:"10px"},children:["âš ï¸ ",i]})]}),l&&e.jsxs("div",{children:[e.jsx("div",{className:"spinner",style:{width:"40px",height:"40px",border:"4px solid rgba(255,255,255,0.1)",borderTop:"4px solid var(--accent-color)",borderRadius:"50%",margin:"0 auto 20px auto",animation:"spin 1s linear infinite"}}),e.jsx("h3",{children:"LSPK íŒ¨í‚¤ì§€ êµ¬ì¡° ìŠ¤ìº” ì¤‘..."})]}),c&&!l&&e.jsxs("div",{style:{padding:"20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"15px",marginBottom:"20px"},children:[e.jsx("div",{style:{fontSize:"2.5rem"},children:"ðŸ’¾"}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("h2",{style:{margin:0},children:c.meta.filename}),e.jsxs("p",{style:{margin:0,opacity:.7},children:[c.meta.version," â€¢ ",c.meta.size]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",textAlign:"left"},children:[e.jsx(z,{title:"ê²Œìž„ ëª¨ë“œ",value:c.meta.mode,icon:e.jsx(Target,{size:18})}),e.jsx(z,{title:"ë§ˆì§€ë§‰ ì €ìž¥",value:c.meta.lastSave,icon:e.jsx(Q,{size:18})}),e.jsx(z,{title:"ëª¨ë“œ(Mod) ì—¬ë¶€",value:c.meta.isModded,icon:e.jsx(ee,{size:18})}),e.jsx(z,{title:"ë™ë£Œ ìˆ˜",value:`${c.companions.length}ëª… ê°ì§€ë¨`,icon:e.jsx(E,{size:18})})]}),e.jsxs("div",{style:{marginTop:"30px",textAlign:"left"},children:[e.jsx("h3",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"10px"},children:"ê°ì§€ëœ ë™ë£Œ í‚¤ì›Œë“œ"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"15px"},children:c.companions.length>0?c.companions.map(r=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"8px 12px",borderRadius:"8px",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:r.avatar}),e.jsx("span",{children:r.name})]},r.id)):e.jsx("div",{style:{opacity:.5},children:"í…ìŠ¤íŠ¸ ë‚´ ë™ë£Œ í‚¤ì›Œë“œ ì—†ìŒ"})})]}),e.jsxs("div",{style:{marginTop:"30px",background:"rgba(0,0,0,0.2)",padding:"15px",borderRadius:"8px",fontSize:"0.85rem",color:"#94a3b8",textAlign:"left",display:"flex",gap:"10px"},children:[e.jsx(F,{size:20}),e.jsxs("div",{children:[e.jsx("strong",{children:"ë°ì´í„° ì•”í˜¸í™” ì•Œë¦¼"}),e.jsx("br",{}),"ê³¨ë“œ, ê²½í—˜ì¹˜, ì•„ì´í…œ ìƒì„¸ ì •ë³´ëŠ” ë°”ì´ë„ˆë¦¬(LSF) ë‚´ë¶€ì— ì••ì¶•/ì•”í˜¸í™”ë˜ì–´ ìžˆì–´, ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œëŠ” ì •í™•í•œ ì¶”ì¶œì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. (ì¶”ì •ì¹˜ ì œê³µ ì¤‘ë‹¨)"]})]}),e.jsx("button",{onClick:()=>p(null),style:{marginTop:"30px",padding:"10px 20px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",borderRadius:"6px",cursor:"pointer"},children:"ë‹¤ë¥¸ íŒŒì¼ ë¶„ì„"})]})]})})},z=({icon:s,title:c,value:p})=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"10px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("div",{style:{opacity:.7},children:s}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.8rem",opacity:.5},children:c}),e.jsx("div",{style:{fontWeight:"bold"},children:p})]})]}),Ce=({user:s})=>{const[c,p]=g.useState(0),[l,d]=g.useState(!1),i=()=>{confirm("ì •ë§ ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ê¸°ê¸°ì˜ í”„ë¡œí•„ ì •ë³´ê°€ ì‚­ì œë©ë‹ˆë‹¤.")&&(localStorage.removeItem("bg3_user_profile"),window.location.reload())},u=async()=>{d(!0);try{const o=re(v);(await C(w(v,"chats"))).forEach(t=>{o.delete(t.ref)}),(await C(w(v,"schedules"))).forEach(t=>{o.delete(t.ref)}),await o.commit(),p(2)}catch(o){console.error(o),alert("ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+o.message),p(0)}finally{d(!1)}};return e.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[e.jsx("h1",{style:{marginBottom:"30px"},children:"âš™ï¸ í™˜ê²½ ì„¤ì •"}),e.jsxs("div",{className:"glass-panel",style:{padding:"30px",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"1.2rem",margin:"0 0 20px 0"},children:"ë‚´ ëª¨í—˜ê°€ ì¹´ë“œ"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"#333",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2rem"},children:"ðŸ‘¤"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:s.nickname}),e.jsxs("div",{style:{opacity:.7},children:["Level 1 â€¢ ",s.className]}),s.isAdmin&&e.jsx("div",{style:{color:"#fbbf24",fontSize:"0.9rem",marginTop:"5px"},children:"ðŸ‘‘ Party Leader (Admin)"})]})]})]}),s.isAdmin&&e.jsxs("div",{className:"glass-panel",style:{padding:"30px",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:"0 0 20px 0",color:"#f87171",borderBottom:"1px solid rgba(239, 68, 68, 0.2)",paddingBottom:"10px"},children:[e.jsx(te,{size:20,style:{verticalAlign:"middle",marginRight:"8px"}}),"ì„œë²„ ë°ì´í„° ê´€ë¦¬ (ìœ„í—˜)"]}),e.jsxs("p",{style:{opacity:.8,marginBottom:"20px"},children:["ì„œë²„ì— ì €ìž¥ëœ ",e.jsx("strong",{children:"ëª¨ë“  ì±„íŒ… ë‚´ì—­ê³¼ ë ˆì´ë“œ ì¼ì •"}),"ì„ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œí•©ë‹ˆë‹¤.",e.jsx("br",{}),"ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë‹ˆ íŒŒí‹°ì›ë“¤ê³¼ ìƒì˜ í›„ ì§„í–‰í•˜ì„¸ìš”."]}),c===0&&e.jsxs("button",{onClick:()=>p(1),style:{background:"rgba(239, 68, 68, 0.2)",color:"#fca5a5",border:"1px solid rgba(239, 68, 68, 0.4)",padding:"12px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(se,{size:18})," ì›”ë“œ ë°ì´í„° ì´ˆê¸°í™”"]}),c===1&&e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"20px",borderRadius:"8px",border:"1px solid #f87171"},children:[e.jsx("div",{style:{color:"#fca5a5",fontWeight:"bold",marginBottom:"15px"},children:"ì •ë§ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>p(0),disabled:l,style:{flex:1,padding:"10px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",borderRadius:"6px",cursor:"pointer"},children:"ì·¨ì†Œ"}),e.jsx("button",{onClick:u,disabled:l,style:{flex:1,padding:"10px",background:"#ef4444",border:"none",color:"white",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:l?"ì‚­ì œ ì¤‘...":"ë„¤, ì‚­ì œí•©ë‹ˆë‹¤"})]})]}),c===2&&e.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#4ade80"},children:[e.jsx(ne,{size:40,style:{marginBottom:"10px"}}),e.jsx("div",{children:"ì´ˆê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsx("button",{onClick:()=>p(0),style:{marginTop:"15px",padding:"8px 16px",borderRadius:"6px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:"ëŒì•„ê°€ê¸°"})]})]}),e.jsxs("button",{onClick:i,style:{width:"100%",padding:"20px",borderRadius:"12px",marginTop:"20px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer"},children:[e.jsx(N,{size:20})," ë¡œê·¸ì•„ì›ƒ (í”„ë¡œí•„ ìž¬ì„¤ì •)"]})]})},ze=({user:s})=>{const[c,p]=g.useState([]),[l,d]=g.useState(!0);if(!s.isAdmin)return e.jsx("div",{style:{padding:"50px",textAlign:"center"},children:"ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."});const i=async()=>{d(!0);try{const o=await C(w(v,"users"));p(o.docs.map(y=>y.data()))}catch(o){console.error(o)}finally{d(!1)}};g.useEffect(()=>{i()},[]);const u=async o=>{if(o.nickname==="ì¤€í˜"){alert("ê´€ë¦¬ìž ìžì‹ ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}if(confirm(`ì •ë§ë¡œ '${o.nickname}'ë‹˜ì„ íŒŒí‹°ì—ì„œ ì¶”ë°©í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.`))try{await O(k(v,"users",o.nickname)),alert("ì¶”ë°©ë˜ì—ˆìŠµë‹ˆë‹¤."),i()}catch(y){alert("ì˜¤ë¥˜ ë°œìƒ: "+y.message)}};return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(I,{size:24,color:"#fca5a5"}),e.jsx("h2",{style:{margin:0},children:"ê´€ë¦¬ìž ëŒ€ì‹œë³´ë“œ"})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"30px"},children:[e.jsxs("h3",{style:{margin:"0 0 20px 0"},children:["ë“±ë¡ëœ íŒŒí‹°ì› ê´€ë¦¬ (",c.length,"/4)"]}),l?e.jsx("div",{children:"ë¡œë”© ì¤‘..."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:c.map(o=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#333",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:o.isAdmin?"ðŸ‘‘":"ðŸ‘¤"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold"},children:[o.nickname," ",o.isAdmin&&e.jsx("span",{style:{color:"#fbbf24",fontSize:"0.8rem"},children:"(Admin)"})]}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:["Class: ",o.className]})]})]}),!o.isAdmin&&e.jsxs("button",{onClick:()=>u(o),style:{background:"rgba(239, 68, 68, 0.2)",color:"#fca5a5",border:"1px solid rgba(239, 68, 68, 0.4)",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(ie,{size:16})," ì¶”ë°©"]})]},o.id))})]})]})},Ie=[{id:"barbarian",name:"ë°”ë°”ë¦¬ì•ˆ",icon:ae,color:"#fca5a5"},{id:"bard",name:"ë°”ë“œ",icon:oe,color:"#f9a8d4"},{id:"cleric",name:"í´ë ˆë¦­",icon:le,color:"#d1d5db"},{id:"druid",name:"ë“œë£¨ì´ë“œ",icon:de,color:"#bef264"},{id:"fighter",name:"íŒŒì´í„°",icon:I,color:"#93c5fd"},{id:"monk",name:"ëª½í¬",icon:ce,color:"#7dd3fc"},{id:"paladin",name:"íŒ”ë¼ë”˜",icon:I,color:"#fbbf24"},{id:"ranger",name:"ë ˆì¸ì €",icon:pe,color:"#86efac"},{id:"rogue",name:"ë¡œê·¸",icon:xe,color:"#cbd5e1"},{id:"sorcerer",name:"ì†Œì„œëŸ¬",icon:ge,color:"#c084fc"},{id:"warlock",name:"ì›Œë½",icon:ue,color:"#e879f9"},{id:"wizard",name:"ìœ„ìžë“œ",icon:he,color:"#818cf8"}],De=({onComplete:s})=>{const[c,p]=g.useState("check"),[l,d]=g.useState(""),[i,u]=g.useState(""),[o,y]=g.useState(null),[r,t]=g.useState(!1),[b,h]=g.useState(""),j=async n=>{if(n.preventDefault(),!!l.trim()){t(!0),h("");try{if((await W(k(v,"users",l))).exists())p("login");else{if((await C(w(v,"users"))).size>=4){h("ì£„ì†¡í•©ë‹ˆë‹¤. íŒŒí‹°ì› ì •ì›(4ëª…)ì´ ê½‰ ì°¼ìŠµë‹ˆë‹¤. ê´€ë¦¬ìžì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”."),t(!1);return}p("signup")}}catch(f){console.error(f),h("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{t(!1)}}},a=async n=>{n.preventDefault(),t(!0);try{const x=(await W(k(v,"users",l))).data();x.password===i?(localStorage.setItem("bg3_user_profile",JSON.stringify(x)),s(x)):h("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")}catch{h("ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{t(!1)}},m=async()=>{if(!o||!i){h("í´ëž˜ìŠ¤ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ìž…ë ¥í•´ì£¼ì„¸ìš”.");return}t(!0);try{if((await C(w(v,"users"))).size>=4)throw new Error("ê·¸ ì‚¬ì´ì— ì •ì›ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.");const f=l==="ì¤€í˜",x={id:l,nickname:l,password:i,className:o.name,classId:o.id,isAdmin:f,createdAt:B()};await T(k(v,"users",l),x),localStorage.setItem("bg3_user_profile",JSON.stringify(x)),s(x)}catch(n){console.error(n),h(n.message||"ê°€ìž… ì‹¤íŒ¨")}finally{t(!1)}};return e.jsxs("div",{className:"glass-panel",style:{maxWidth:"500px",margin:"100px auto",padding:"40px",textAlign:"center",position:"relative",overflow:"hidden"},children:[e.jsx("h1",{style:{marginBottom:"10px"},children:"âš”ï¸ ëª¨í—˜ê°€ ë“±ë¡"}),b&&e.jsx("div",{style:{color:"#ef4444",marginBottom:"15px",fontWeight:"bold"},children:b}),c==="check"&&e.jsxs("form",{onSubmit:j,children:[e.jsxs("p",{style:{opacity:.7,marginBottom:"30px"},children:["ì‚¬ìš©í•˜ì‹¤ ë‹‰ë„¤ìž„ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.",e.jsx("br",{}),"(ì´ 4ëª…ì˜ íŒŒí‹°ì›ë§Œ ë“±ë¡ ê°€ëŠ¥í•©ë‹ˆë‹¤)"]}),e.jsx("input",{type:"text",value:l,onChange:n=>d(n.target.value),placeholder:"ë‹‰ë„¤ìž„ (ì˜ˆ: ì¤€í˜)",style:{width:"100%",padding:"15px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.2)",color:"white",fontSize:"1.1rem",marginBottom:"20px",textAlign:"center"}}),e.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"15px",borderRadius:"12px",background:"var(--accent-color)",border:"none",color:"white",fontWeight:"bold"},children:r?"í™•ì¸ ì¤‘...":"ë‹¤ìŒ"})]}),c==="login"&&e.jsxs("form",{onSubmit:a,children:[e.jsxs("p",{style:{marginBottom:"20px"},children:[e.jsx("strong",{children:l}),"ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!",e.jsx("br",{}),"ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì—¬ íŒŒí‹°ì— í•©ë¥˜í•˜ì„¸ìš”."]}),e.jsx("input",{type:"password",value:i,onChange:n=>u(n.target.value),placeholder:"ë¹„ë°€ë²ˆí˜¸",style:{width:"100%",padding:"15px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.2)",color:"white",fontSize:"1.1rem",marginBottom:"20px",textAlign:"center"}}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{type:"button",onClick:()=>p("check"),style:{flex:1,padding:"15px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"none",color:"white"},children:"ë’¤ë¡œ"}),e.jsx("button",{type:"submit",disabled:r,style:{flex:2,padding:"15px",borderRadius:"12px",background:"var(--accent-color)",border:"none",color:"white",fontWeight:"bold"},children:r?"ë¡œê·¸ì¸ ì¤‘...":"ëª¨í—˜ ì‹œìž‘"})]})]}),c==="signup"&&e.jsxs("div",{children:[e.jsxs("p",{style:{marginBottom:"20px"},children:["ì‹ ê·œ ë“±ë¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤!",e.jsx("br",{}),"í´ëž˜ìŠ¤ì™€ ì‚¬ìš©í•  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•˜ì„¸ìš”."]}),e.jsxs("div",{style:{position:"relative",marginBottom:"20px"},children:[e.jsx(F,{size:16,style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",opacity:.5}}),e.jsx("input",{type:"password",value:i,onChange:n=>u(n.target.value),placeholder:"ì‚¬ìš©í•  ë¹„ë°€ë²ˆí˜¸ ì„¤ì •",style:{width:"100%",padding:"12px 12px 12px 40px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.2)",color:"white",fontSize:"1rem",textAlign:"left"}})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px",maxHeight:"300px",overflowY:"auto",marginBottom:"20px",paddingRight:"5px"},children:Ie.map(n=>{const f=n.icon;return e.jsxs("button",{onClick:()=>y(n),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",padding:"10px",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)",background:o?.id===n.id?n.color:"rgba(255,255,255,0.05)",color:o?.id===n.id?"black":"white",cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(f,{size:24}),e.jsx("span",{style:{fontSize:"0.7rem"},children:n.name})]},n.id)})}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>p("check"),style:{flex:1,padding:"15px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"none",color:"white"},children:"ë’¤ë¡œ"}),e.jsx("button",{onClick:m,disabled:r,style:{flex:2,padding:"15px",borderRadius:"12px",background:"var(--accent-color)",border:"none",color:"white",fontWeight:"bold"},children:r?"ë“±ë¡ ì¤‘...":"ë“±ë¡ ì™„ë£Œ"})]})]})]})},Ae=()=>{const[s,c]=g.useState(null),[p,l]=g.useState(1),[d,i]=g.useState("home"),[u,o]=g.useState(window.innerWidth<768);g.useEffect(()=>{const t=localStorage.getItem("bg3_user_profile");t&&c(JSON.parse(t));const b=()=>o(window.innerWidth<768);return window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]),g.useEffect(()=>{if(!s)return;const t=async()=>{try{await T(k(v,"online_users",s.id),{nickname:s.nickname,classId:s.classId||"unknown",lastSeen:B()},{merge:!0})}catch(a){console.error("Heartbeat fail:",a)}};t();const b=setInterval(t,3e4),h=A(w(v,"online_users")),j=R(h,a=>{const m=Date.now(),n=a.docs.filter(f=>{const x=f.data();if(!x.lastSeen)return!1;const S=x.lastSeen.toDate?x.lastSeen.toDate().getTime():0;return m-S<12e4});l(n.length)});return()=>{clearInterval(b),j()}},[s]);const y=t=>{c(t)},r=()=>{switch(d){case"home":return e.jsx(D,{user:s});case"chat":return e.jsx(je,{user:s});case"calendar":return e.jsx(ve,{user:s});case"save":return e.jsx(ke,{user:s});case"settings":return e.jsx(Ce,{user:s});case"admin":return s.isAdmin?e.jsx(ze,{user:s}):e.jsx(D,{user:s});default:return e.jsx(D,{user:s})}};return s?e.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"var(--bg-color)"},children:[e.jsx(fe,{activeTab:d,setActiveTab:i,isMobile:u,onlineCount:p,user:s}),e.jsx("main",{style:{flex:1,padding:u?"80px 20px 20px":"20px",overflowY:"auto",position:"relative"},children:r()})]}):e.jsx(De,{onComplete:y})};function Re(){return e.jsx(Ae,{})}me.createRoot(document.getElementById("root")).render(e.jsx(g.StrictMode,{children:e.jsx(Re,{})}));
