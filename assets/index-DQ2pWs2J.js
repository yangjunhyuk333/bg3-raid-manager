import{r as g,H as Y,M as O,C as T,F as G,S as q,a as I,j as e,b as K,X,L as F,i as V,g as J,c as C,d as S,q as z,l as U,o as H,e as D,A as Q,f as Z,B as ee,h as te,k as P,s as R,m as se,U as M,n as E,p as k,t as W,u as ne,v as re,D as ie,w as ae,x as _,T as oe,y as le,z as de,E as ce,G as pe,I as xe,J as ge,K as ue,N as he,O as me,P as fe,Q as ye,R as be,Z as je,W as ve,V as Se,Y as N,_ as we}from"./vendor-B4LJ9yox.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))p(d);new MutationObserver(d=>{for(const o of d)if(o.type==="childList")for(const x of o.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&p(x)}).observe(document,{childList:!0,subtree:!0});function l(d){const o={};return d.integrity&&(o.integrity=d.integrity),d.referrerPolicy&&(o.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?o.credentials="include":d.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function p(d){if(d.ep)return;d.ep=!0;const o=l(d);fetch(d.href,o)}})();const ke=({activeTab:s,setActiveTab:c,isMobile:l,onlineCount:p,user:d})=>{const[o,x]=g.useState(!1),n=[{id:"home",icon:Y,label:"í™ˆ"},{id:"chat",icon:O,label:"íŒŒí‹° ì±„íŒ…"},{id:"calendar",icon:T,label:"ë ˆì´ë“œ ì¼ì •"},{id:"save",icon:G,label:"ì„¸ì´ë¸Œ ë¶„ì„"},{id:"settings",icon:q,label:"í™˜ê²½ ì„¤ì •"},...d?.isAdmin?[{id:"admin",icon:I,label:"ë‚˜ì˜ ì˜ì§€ (ê´€ë¦¬)"}]:[]],j=i=>{c(i),l&&x(!1)},u=()=>{confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í”„ë¡œí•„ ì •ë³´ê°€ ì‚­ì œë©ë‹ˆë‹¤.")&&(localStorage.removeItem("bg3_user_profile"),window.location.reload())};return e.jsxs(e.Fragment,{children:[l&&!o&&e.jsx("button",{onClick:()=>x(!0),style:{position:"fixed",top:"20px",left:"20px",zIndex:100,background:"rgba(0,0,0,0.5)",border:"none",color:"white",padding:"10px",borderRadius:"8px",backdropFilter:"blur(5px)"},children:e.jsx(K,{})}),e.jsxs("div",{className:`glass-panel sidebar ${l&&!o?"closed":""}`,style:{width:"260px",height:l?"100%":"calc(100vh - 40px)",position:l?"fixed":"sticky",top:l?"0":"20px",left:l?o?"0":"-100%":"20px",margin:l?"0":"20px 0 20px 20px",display:"flex",flexDirection:"column",transition:"all 0.3s ease",zIndex:90,background:l?"rgba(10, 10, 15, 0.95)":void 0,boxShadow:l?"5px 0 15px rgba(0,0,0,0.5)":void 0},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)",position:"relative"},children:[l&&e.jsx("button",{onClick:()=>x(!1),style:{position:"absolute",top:"20px",right:"15px",background:"transparent",border:"none",color:"white"},children:e.jsx(X,{})}),e.jsx("h1",{style:{fontSize:"1.5rem",margin:0,background:"linear-gradient(to right, #fff, #aaa)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",paddingRight:"40px"},children:"BG3 Manager"}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"6px",marginTop:"10px",padding:"4px 10px",background:"rgba(16, 185, 129, 0.2)",borderRadius:"20px",border:"1px solid rgba(16, 185, 129, 0.4)",color:"#6ee7b7",fontSize:"0.8rem"},children:[e.jsx("div",{style:{width:"8px",height:"8px",background:"#34d399",borderRadius:"50%",boxShadow:"0 0 5px #34d399"}}),e.jsxs("span",{children:[p,"ëª… ì ‘ì† ì¤‘"]})]})]}),e.jsx("nav",{style:{flex:1,padding:"20px 10px"},children:n.map(i=>{const m=i.icon,f=s===i.id;return e.jsxs("button",{onClick:()=>j(i.id),style:{width:"100%",display:"flex",alignItems:"center",gap:"15px",padding:"12px 15px",marginBottom:"8px",background:f?"var(--accent-color)":"transparent",border:"none",borderRadius:"12px",color:"white",fontSize:"1rem",cursor:"pointer",transition:"all 0.2s",textAlign:"left"},children:[e.jsx(m,{size:20,style:{opacity:f?1:.7}}),i.label]},i.id)})}),d&&e.jsxs("div",{style:{padding:"20px",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1.2rem"},children:"ðŸ§™â€â™‚ï¸"}),e.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:d.nickname}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.6},children:d.className})]})]}),e.jsxs("button",{onClick:u,style:{width:"100%",padding:"8px",background:"rgba(255,255,255,0.05)",border:"none",borderRadius:"6px",color:"rgba(255,255,255,0.6)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"0.8rem"},children:[e.jsx(F,{size:14})," ë¡œê·¸ì•„ì›ƒ"]})]})]})]})},Ce={apiKey:"AIzaSyAsbaWbo3DoSTrRFhkaf9XujWPpmeGSjAE",authDomain:"bg3-raid-manager.firebaseapp.com",projectId:"bg3-raid-manager",storageBucket:"bg3-raid-manager.firebasestorage.app",messagingSenderId:"773826713403",appId:"1:773826713403:web:c15fdfca708d47f4fcc91e"},ze=V(Ce),v=J(ze);console.log("ðŸ”¥ Firebase Connected (Real DB Mode)");const B=({setActiveTab:s})=>{const[c,l]=g.useState({userCount:0,recentChats:[],upcomingRaid:null}),[p,d]=g.useState(!0);g.useEffect(()=>{C(S(v,"users")).then(i=>{l(m=>({...m,userCount:i.size}))});const x=z(S(v,"chats"),H("timestamp","desc"),U(3)),n=D(x,i=>{const m=i.docs.map(f=>f.data());l(f=>({...f,recentChats:m}))}),j=z(S(v,"schedules")),u=D(j,i=>{const m=i.docs.map(r=>r.data()),f=new Date().toISOString().split("T")[0],b=m.filter(r=>r.date>=f).sort((r,a)=>r.date.localeCompare(a.date));let t="ì˜ˆì •ëœ ì›ì •ì´ ì—†ìŠµë‹ˆë‹¤.";if(b.length>0){const r=b[0].date,a=new Set(b.filter(h=>h.date===r).map(h=>h.nickname)).size;t=`${r} (ì›ì •ëŒ€ì› ${a}ëª… ëŒ€ê¸° ì¤‘)`}l(r=>({...r,upcomingRaid:t}))});return d(!1),()=>{n(),u()}},[]);const o=({title:x,icon:n,color:j,children:u,onClick:i})=>e.jsxs("div",{className:"glass-panel",onClick:i,style:{padding:"25px",display:"flex",flexDirection:"column",gap:"15px",cursor:i?"pointer":"default",transition:"transform 0.2s",minHeight:"180px",position:"relative",overflow:"hidden"},onMouseEnter:m=>i&&(m.currentTarget.style.transform="translateY(-5px)"),onMouseLeave:m=>i&&(m.currentTarget.style.transform="translateY(0)"),children:[e.jsx("div",{style:{position:"absolute",top:-10,right:-10,width:"80px",height:"80px",background:j,opacity:.1,borderRadius:"50%",filter:"blur(20px)"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("h3",{style:{margin:0,fontSize:"1.2rem",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(n,{color:j,size:24})," ",x]}),i&&e.jsx(Z,{size:20,style:{opacity:.5}})]}),e.jsx("div",{style:{flex:1},children:u})]});return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"30px",textAlign:"center"},children:[e.jsx("h1",{style:{fontSize:"2.5rem",marginBottom:"10px",background:"linear-gradient(to right, #4ade80, #3b82f6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Baldur's Gate 3 Raid Manager"}),e.jsx("p",{style:{opacity:.7},children:"í™˜ì˜í•©ë‹ˆë‹¤, ëª¨í—˜ê°€ë‹˜. ì˜¤ëŠ˜ì˜ ì˜ì§€ í˜„í™© ë³´ê³ ì„œìž…ë‹ˆë‹¤."})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[e.jsx(o,{title:"ì˜ì§€ í˜„í™©",icon:Q,color:"#f472b6",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",height:"100%",justifyContent:"center"},children:[e.jsxs("div",{style:{fontSize:"3rem",fontWeight:"bold"},children:[c.userCount,e.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"normal",opacity:.6},children:"/4 ëª…"})]}),e.jsx("div",{style:{fontSize:"0.9rem",opacity:.7},children:"í˜„ìž¬ ì •ì˜ˆ ë©¤ë²„ê°€ êµ¬ì„±ë˜ì—ˆìŠµë‹ˆë‹¤."})]})}),e.jsx(o,{title:"ë‹¤ìŒ ì›ì •",icon:T,color:"#facc15",onClick:()=>s("calendar"),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",height:"100%",justifyContent:"center"},children:[e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#facc15"},children:c.upcomingRaid||"ì¼ì • ë¡œë”© ì¤‘..."}),e.jsx("div",{style:{fontSize:"0.9rem",opacity:.7},children:"ì¼ì •ì„ ì¡°ìœ¨í•˜ë ¤ë©´ í´ë¦­í•˜ì„¸ìš”."})]})}),e.jsx(o,{title:"ìµœê·¼ ì†Œì‹",icon:O,color:"#60a5fa",onClick:()=>s("chat"),children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:c.recentChats.length>0?c.recentChats.map((x,n)=>e.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"8px",fontSize:"0.9rem",borderLeft:"3px solid #60a5fa"},children:[e.jsxs("span",{style:{fontWeight:"bold",marginRight:"6px"},children:[x.sender,":"]}),e.jsxs("span",{style:{opacity:.8},children:[x.text.substring(0,20),x.text.length>20&&"..."]})]},n)):e.jsx("div",{style:{opacity:.5},children:"ì•„ì§ ëŒ€í™”ê°€ ì—†ìŠµë‹ˆë‹¤."})})})]}),e.jsxs("div",{onClick:()=>s("save"),className:"glass-panel",style:{marginTop:"30px",padding:"30px",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(90deg, rgba(16, 185, 129, 0.1) 0%, rgba(0,0,0,0) 100%)",cursor:"pointer"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 5px 0",color:"#4ade80"},children:"ì„¸ì´ë¸Œ íŒŒì¼ ì •ë°€ ë¶„ì„"}),e.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:"ë‚´ ì„¸ì´ë¸Œ íŒŒì¼ì˜ ì§„ì§œ ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”. (HEX Dump / Hidden Stats)"})]}),e.jsx("div",{style:{padding:"10px 20px",borderRadius:"20px",background:"rgba(74, 222, 128, 0.2)",color:"#4ade80",fontWeight:"bold"},children:"ë¶„ì„ì‹¤ ì´ë™ â†’"})]})]})},De=({user:s})=>{const[c,l]=g.useState([]),[p,d]=g.useState(""),[o,x]=g.useState(!0),n=g.useRef(null);g.useEffect(()=>{const u=z(S(v,"chats"),U(100)),i=D(u,m=>{const f=m.docs.map(b=>({id:b.id,...b.data(),timestamp:b.data().timestamp?.toDate().toISOString()||new Date().toISOString()}));f.sort((b,t)=>new Date(b.timestamp)-new Date(t.timestamp)),l(f),x(!1)});return()=>i()},[]),g.useEffect(()=>{n.current?.scrollIntoView({behavior:"smooth"})},[c]);const j=async u=>{if(u.preventDefault(),!p.trim())return;const i=p;d("");try{await P(S(v,"chats"),{text:i,sender:s?.nickname||"Anonymous",userClass:s?.className||"Unknown",uid:s?.id||"guest",timestamp:R()})}catch(m){console.error("Error sending message: ",m)}};return e.jsxs("div",{className:"glass-panel",style:{height:"calc(100dvh - 80px)",display:"flex",flexDirection:"column",padding:0},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(ee,{color:"#4fd1c5"})," íŒŒí‹° ìž‘ì „ íšŒì˜ì‹¤"]}),e.jsx("span",{style:{fontSize:"0.8rem",opacity:.7},children:"ë ˆì´ë“œ ì¼ì •ê³¼ ì „ëžµì„ ë…¼ì˜í•˜ì„¸ìš”."})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[o&&e.jsx("div",{style:{textAlign:"center",opacity:.5},children:"ë¡œë”© ì¤‘..."}),c.map(u=>{const i=u.uid===s?.id;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:i?"flex-end":"flex-start"},children:[e.jsx("div",{style:{fontSize:"0.8rem",marginBottom:"4px",opacity:.7,display:"flex",alignItems:"center",gap:"6px"},children:!i&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:["[",u.userClass,"]"]}),u.sender]})}),e.jsx("div",{style:{background:i?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(255, 255, 255, 0.1)",padding:"12px 16px",borderRadius:i?"16px 16px 0 16px":"16px 16px 16px 0",maxWidth:"75%",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",backdropFilter:"blur(5px)",border:"1px solid rgba(255,255,255,0.1)",wordBreak:"break-word"},children:u.text}),e.jsx("span",{style:{fontSize:"0.7rem",opacity:.4,marginTop:"4px"},children:new Date(u.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},u.id)}),e.jsx("div",{ref:n})]}),e.jsxs("form",{onSubmit:j,style:{padding:"20px",background:"rgba(0,0,0,0.2)",display:"flex",gap:"10px",borderRadius:"0 0 16px 16px"},children:[e.jsx("input",{type:"text",value:p,onChange:u=>d(u.target.value),placeholder:"ìž‘ì „ì„ ì „ë‹¬í•˜ì„¸ìš”...",style:{flex:1,padding:"12px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.05)",color:"white",outline:"none"}}),e.jsx("button",{type:"submit",style:{padding:"12px",borderRadius:"12px",background:"var(--accent-color)",color:"white",border:"none",cursor:"pointer",transition:"all 0.3s"},children:e.jsx(te,{size:20})})]})]})},Ie=({user:s})=>{const c=()=>{const t=[];for(let r=0;r<7;r++){const a=new Date;a.setDate(a.getDate()+r),t.push(a.toISOString().split("T")[0])}return t},l=()=>[18,19,20,21,22,23,0,1,2],[p,d]=g.useState(new Date().toISOString().split("T")[0]),[o,x]=g.useState([]),[n,j]=g.useState([]),[u,i]=g.useState(c()),m=l();g.useEffect(()=>{const t=z(S(v,"schedules")),r=D(t,a=>{const h=a.docs.map(w=>({id:w.id,...w.data()}));j(h);const y=h.filter(w=>w.userId===s.id);x(y)});return()=>r()},[s]);const f=async(t,r)=>{const a=`${t}_${s.id}`,h=o.find(w=>w.id===a);let y=h?h.times:[];y.includes(r)?y=y.filter(w=>w!==r):y=[...y,r],y.length===0?h&&await E(k(v,"schedules",a)):await W(k(v,"schedules",a),{userId:s.id,nickname:s.nickname,date:t,times:y,updatedAt:new Date().toISOString()})},b=(t,r)=>{const a=n.filter(h=>h.date===t&&h.times.includes(r)).map(h=>h.nickname);return{count:a.length,names:a}};return e.jsxs("div",{style:{maxWidth:"1000px",margin:"0 auto",display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsx("div",{className:"glass-panel",style:{padding:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsxs("div",{children:[e.jsxs("h2",{style:{margin:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(T,{})," ë ˆì´ë“œ ì‹œê°„í‘œ ì¡°ì •"]}),e.jsx("p",{style:{margin:"5px 0 0 0",opacity:.7},children:"ê°€ëŠ¥í•œ ì‹œê°„ì„ ì²´í¬í•˜ë©´, ëª¨ë“  íŒŒí‹°ì›ì´ ê²¹ì¹˜ëŠ” 'Golden Time'ì„ ì°¾ì•„ì¤ë‹ˆë‹¤."})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"20px"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsx("h3",{style:{marginTop:0},children:"ðŸ“… ë‚ ì§œ ì„ íƒ"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"5px",marginBottom:"20px"},children:u.map(t=>e.jsxs("button",{onClick:()=>d(t),style:{padding:"12px",borderRadius:"8px",border:"none",background:p===t?"var(--accent-color)":"rgba(255,255,255,0.05)",color:"white",cursor:"pointer",textAlign:"left",fontWeight:p===t?"bold":"normal",display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:t}),o.find(r=>r.date===t)&&e.jsx(se,{size:16})]},t))}),e.jsxs("h3",{style:{marginTop:0},children:["â±ï¸ ",p," ê°€ëŠ¥ ì‹œê°„"]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:m.map(t=>{const r=o.find(a=>a.date===p)?.times.includes(t);return e.jsx("button",{onClick:()=>f(p,t),style:{padding:"10px",borderRadius:"6px",border:"1px solid "+(r?"var(--accent-color)":"rgba(255,255,255,0.2)"),background:r?"rgba(99, 102, 241, 0.3)":"transparent",color:r?"white":"rgba(255,255,255,0.6)",cursor:"pointer"},children:t<10?`0${t}:00`:`${t}:00`},t)})})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[e.jsxs("h3",{style:{marginTop:0,display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(M,{})," íŒŒí‹° í•©ë¥˜ í˜„í™©",e.jsx("span",{style:{fontSize:"0.8rem",fontWeight:"normal",opacity:.6},children:"(ì´ˆë¡ìƒ‰ì´ ë² ìŠ¤íŠ¸ íƒ€ìž„!)"})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:"ì‹œê°„"}),u.map(t=>e.jsx("th",{style:{padding:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"},children:t.slice(5)},t))]})}),e.jsx("tbody",{children:m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px",borderBottom:"1px solid rgba(255,255,255,0.05)",fontWeight:"bold",color:"rgba(255,255,255,0.7)"},children:t<10?`0${t}:00`:`${t}:00`}),u.map(r=>{const{count:a,names:h}=b(r,t);let y="transparent";return a===4?y="rgba(74, 222, 128, 0.6)":a===3?y="rgba(251, 191, 36, 0.4)":a>0&&(y="rgba(239, 68, 68, 0.2)"),e.jsx("td",{style:{background:y,borderBottom:"1px solid rgba(255,255,255,0.05)",textAlign:"center",cursor:"grab"},title:a>0?`${h.join(", ")} ê°€ëŠ¥`:"",children:a>0&&a},r+t)})]},t))})]})}),e.jsx("div",{style:{marginTop:"20px",fontSize:"0.8rem",opacity:.6,textAlign:"center"},children:"ê° ì¹¸ì˜ ìˆ«ìžëŠ” í•´ë‹¹ ì‹œê°„ì— ì°¸ì—¬ ê°€ëŠ¥í•œ ì¸ì› ìˆ˜ìž…ë‹ˆë‹¤. ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ë©´ ëˆ„êµ¬ì¸ì§€ ë³´ìž…ë‹ˆë‹¤."})]})]})]})},L=new TextDecoder("utf-8"),Re=async s=>new Promise(c=>{const l=new FileReader;l.onload=async p=>{const d=p.target.result,o=new DataView(d),x=d.byteLength,n=[];try{let j="";for(let b=0;b<Math.min(32,x);b++)j+=o.getUint8(b).toString(16).padStart(2,"0").toUpperCase()+" ";n.push(`Header Hex: ${j}`);const u=String.fromCharCode(o.getUint8(0),o.getUint8(1),o.getUint8(2),o.getUint8(3));if(n.push(`Magic String: "${u}"`),u!=="LSPK")n.push("WARNING: Magic mismatch. Proceeding with Raw Scan (Legacy/Console Save?).");else{const b=o.getUint32(4,!0);n.push(`LSPK Version: ${b}`)}const i=Math.min(x,20*1024*1024),m=new Uint8Array(d,0,i);let f="";try{f=L.decode(m)}catch{n.push("UTF-8 Decode Failed, using ASCII fallback."),f=Array.from(m).map(t=>String.fromCharCode(t)).join("")}if(x>i){const b=Math.min(1048576,x-i),t=new Uint8Array(d,x-b,b);let r="";try{r=L.decode(t)}catch{r=Array.from(t).map(h=>String.fromCharCode(h)).join("")}f+=r,n.push(`Scanned Footer (${b} bytes).`)}n.push(`Total Scanned Text Length: ${f.length}`),c({success:!0,rawText:f,fileSize:x,debugInfo:n})}catch(j){c({success:!1,error:j.message,debugInfo:n})}},l.onerror=()=>c({success:!1,error:"Read Error",debugInfo:[]}),l.readAsArrayBuffer(s)}),Ae=(s,c)=>{let l="Unknown";s.includes("Honour")?l="Honour (ëª…ì˜ˆ)":s.includes("Tactician")?l="Tactician (ì „ìˆ ê°€)":s.includes("Story")?l="Explorer (íƒí—˜ê°€)":(s.includes("Balanced")||s.includes("Balancer"))&&(l="Balanced (ê· í˜•)");const p=[];return[{key:"Shadowheart",name:"ì„€ë„í•˜íŠ¸",img:"ðŸ–¤"},{key:"Astarion",name:"ì•„ìŠ¤íƒ€ë¦¬ì˜¨",img:"ðŸ§›"},{key:"Gale",name:"ê²Œì¼",img:"ðŸ§™â€â™‚ï¸"},{key:"Lae'zel",name:"ë ˆì´ì ¤",img:"ðŸ‘½"},{key:"Wyll",name:"ìœŒ",img:"ðŸ˜ˆ"},{key:"Karlach",name:"ì¹´ë¥¼ë¼í¬",img:"â¤ï¸â€ðŸ”¥"},{key:"Halsin",name:"í• ì‹ ",img:"ðŸ»"},{key:"Minthara",name:"ë¯¼íƒ€ë¼",img:"ðŸ§â€â™€ï¸"},{key:"Jaheira",name:"ìží—¤ì´ë¼",img:"ðŸŒ¿"},{key:"Minsc",name:"ë¯¼ìŠ¤í¬",img:"ðŸ¹"}].forEach(o=>{s.includes(o.key)&&p.push({...o,status:"Detected"})}),{meta:{mode:l,size:c.toFixed(2)+" MB"},companions:p,economy:{gold:"Encrypted (LSF)",supplies:"Encrypted (LSF)"}}},Be=({user:s})=>{const[c,l]=g.useState(null),[p,d]=g.useState(!1),[o,x]=g.useState(null),[n,j]=g.useState([]),[u,i]=g.useState([]);g.useEffect(()=>{const t=z(S(v,"save_reports"),H("createdAt","desc")),r=D(t,a=>{i(a.docs.map(h=>({id:h.id,...h.data()})))});return()=>r()},[]);const m=t=>{t.preventDefault();const r=t.dataTransfer?t.dataTransfer.files:t.target.files;r&&r.length>0&&f(r[0])},f=async t=>{if(!t.name.endsWith(".lsv")&&!t.name.endsWith(".save")){alert("í™•ìž¥ìžê°€ .lsv ë˜ëŠ” .saveì¸ íŒŒì¼ë§Œ ì§€ì›í•©ë‹ˆë‹¤.");return}d(!0),x(null),l(null),j([]);try{const{success:r,rawText:a,fileSize:h,error:y,debugInfo:w}=await Re(t);if(j(w||[]),!r)throw new Error(y||"íŒŒì‹±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");const A={...Ae(a,h/(1024*1024)),filename:t.name};l(A),s&&A&&P(S(v,"save_reports"),{...A,uploader:s.nickname,createdAt:R()}).catch($=>console.error("DB ì €ìž¥ ì‹¤íŒ¨:",$))}catch(r){console.error(r),x(r.message)}finally{d(!1)}},b=async t=>{window.confirm("ì´ ë¶„ì„ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&await E(k(v,"save_reports",t))};return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",fontFamily:"monospace"},children:[e.jsxs("div",{className:"glass-panel",onDragOver:t=>t.preventDefault(),onDrop:m,style:{padding:"40px",textAlign:"center",border:"2px dashed rgba(255,255,255,0.2)",cursor:"pointer",marginBottom:"30px"},children:[e.jsx("input",{type:"file",id:"f",style:{display:"none"},onChange:m,accept:".lsv,.save"}),e.jsxs("label",{htmlFor:"f",style:{cursor:"pointer"},children:[e.jsx(ne,{size:48,style:{opacity:.5,marginBottom:"10px"}}),e.jsx("h2",{children:"DEEP SAVE SCANNER V.5"}),e.jsx("p",{style:{opacity:.6},children:"ë¶„ì„í•  .lsv íŒŒì¼ì„ ë“œëž˜ê·¸í•˜ì„¸ìš”"})]})]}),p&&e.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[e.jsx("div",{className:"spinner",style:{width:"50px",height:"50px",border:"5px solid #333",borderTop:"5px solid #4ade80",borderRadius:"50%",margin:"0 auto 20px"}}),e.jsx("h3",{children:"HEX DUMP ANALYSIS..."})]}),o&&e.jsxs("div",{style:{background:"rgba(239,68,68,0.2)",padding:"20px",borderRadius:"10px",color:"#fca5a5",marginBottom:"20px"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"10px",margin:0},children:[e.jsx(re,{})," SCAN FAILED"]}),e.jsx("p",{children:o}),e.jsx("div",{style:{background:"rgba(0,0,0,0.5)",padding:"10px",marginTop:"10px",fontSize:"0.8rem",maxHeight:"150px",overflowY:"auto"},children:n.map((t,r)=>e.jsx("div",{children:t},r))})]}),c&&e.jsxs("div",{className:"glass-panel",style:{padding:"30px",textAlign:"left",marginBottom:"30px"},children:[e.jsxs("div",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"20px",marginBottom:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,color:"#4ade80"},children:c.filename}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.7},children:["SIZE: ",c.meta.size," | MODE: ",c.meta.mode]})]}),e.jsx(ie,{size:24,color:"#4ade80"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"20px",borderRadius:"10px"},children:[e.jsxs("h3",{style:{marginTop:0,borderBottom:"1px solid #4ade80",paddingBottom:"5px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(M,{size:18})," DETECTED ENTITIES"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"15px"},children:c.companions.length>0?c.companions.map((t,r)=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:"5px 10px",borderRadius:"5px"},children:[t.img," ",t.name]},r)):e.jsx("span",{style:{opacity:.5},children:"No companion signatures found."})})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"20px",borderRadius:"10px"},children:[e.jsxs("h3",{style:{marginTop:0,borderBottom:"1px solid #f87171",paddingBottom:"5px",display:"flex",alignItems:"center",gap:"10px",color:"#f87171"},children:[e.jsx(ae,{size:18})," ECONOMY DATA (ENCRYPTED)"]}),e.jsxs("div",{style:{marginTop:"15px",fontSize:"0.85rem",color:"rgba(255,255,255,0.7)"},children:[e.jsx(_,{size:16,style:{float:"left",marginRight:"10px"}}),"Secure Binary Blob Detected. ",e.jsx("br",{}),"Gold/XP values are encrypted."]})]})]}),e.jsxs("div",{style:{marginTop:"20px",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"10px"},children:[e.jsx("h4",{style:{margin:"0 0 10px 0",opacity:.7},children:"DEBUG LOG"}),e.jsx("div",{style:{background:"black",padding:"10px",fontFamily:"monospace",fontSize:"0.7rem",color:"#4ade80",maxHeight:"100px",overflowY:"auto"},children:n.map((t,r)=>e.jsx("div",{children:t},r))})]})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"30px"},children:[e.jsx("h3",{style:{marginTop:0,borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"15px"},children:"ðŸ—„ï¸ ANALYSIS HISTORY (DB)"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[u.map(t=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"8px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold"},children:t.filename}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:[t.meta.mode," / ",t.meta.size," / by ",t.uploader]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:t.createdAt?.toDate().toLocaleString()}),e.jsx("button",{onClick:()=>b(t.id),style:{background:"rgba(239,68,68,0.2)",border:"none",color:"#fca5a5",padding:"8px",borderRadius:"6px",cursor:"pointer"},children:e.jsx(oe,{size:16})})]})]},t.id)),u.length===0&&e.jsx("div",{style:{opacity:.5,textAlign:"center"},children:"ê¸°ë¡ëœ ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."})]})]})]})},Te=({user:s})=>{const[c,l]=g.useState(0),[p,d]=g.useState(!1),o=()=>{confirm("ì •ë§ ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ê¸°ê¸°ì˜ í”„ë¡œí•„ ì •ë³´ê°€ ì‚­ì œë©ë‹ˆë‹¤.")&&(localStorage.removeItem("bg3_user_profile"),window.location.reload())},x=async()=>{d(!0);try{const n=pe(v);(await C(S(v,"chats"))).forEach(i=>{n.delete(i.ref)}),(await C(S(v,"schedules"))).forEach(i=>{n.delete(i.ref)}),await n.commit(),l(2)}catch(n){console.error(n),alert("ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: "+n.message),l(0)}finally{d(!1)}};return e.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[e.jsx("h1",{style:{marginBottom:"30px"},children:"âš™ï¸ í™˜ê²½ ì„¤ì •"}),e.jsxs("div",{className:"glass-panel",style:{padding:"30px",marginBottom:"20px"},children:[e.jsx("h2",{style:{fontSize:"1.2rem",margin:"0 0 20px 0"},children:"ë‚´ ëª¨í—˜ê°€ ì¹´ë“œ"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[e.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"#333",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2rem"},children:"ðŸ‘¤"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:s.nickname}),e.jsxs("div",{style:{opacity:.7},children:["Level 1 â€¢ ",s.className]}),s.isAdmin&&e.jsx("div",{style:{color:"#fbbf24",fontSize:"0.9rem",marginTop:"5px"},children:"ðŸ‘‘ Party Leader (Admin)"})]})]})]}),s.isAdmin&&e.jsxs("div",{className:"glass-panel",style:{padding:"30px",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[e.jsxs("h2",{style:{fontSize:"1.2rem",margin:"0 0 20px 0",color:"#f87171",borderBottom:"1px solid rgba(239, 68, 68, 0.2)",paddingBottom:"10px"},children:[e.jsx(le,{size:20,style:{verticalAlign:"middle",marginRight:"8px"}}),"ì„œë²„ ë°ì´í„° ê´€ë¦¬ (ìœ„í—˜)"]}),e.jsxs("p",{style:{opacity:.8,marginBottom:"20px"},children:["ì„œë²„ì— ì €ìž¥ëœ ",e.jsx("strong",{children:"ëª¨ë“  ì±„íŒ… ë‚´ì—­ê³¼ ë ˆì´ë“œ ì¼ì •"}),"ì„ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œí•©ë‹ˆë‹¤.",e.jsx("br",{}),"ì´ ìž‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë‹ˆ íŒŒí‹°ì›ë“¤ê³¼ ìƒì˜ í›„ ì§„í–‰í•˜ì„¸ìš”."]}),c===0&&e.jsxs("button",{onClick:()=>l(1),style:{background:"rgba(239, 68, 68, 0.2)",color:"#fca5a5",border:"1px solid rgba(239, 68, 68, 0.4)",padding:"12px 20px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(de,{size:18})," ì›”ë“œ ë°ì´í„° ì´ˆê¸°í™”"]}),c===1&&e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"20px",borderRadius:"8px",border:"1px solid #f87171"},children:[e.jsx("div",{style:{color:"#fca5a5",fontWeight:"bold",marginBottom:"15px"},children:"ì •ë§ ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>l(0),disabled:p,style:{flex:1,padding:"10px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",borderRadius:"6px",cursor:"pointer"},children:"ì·¨ì†Œ"}),e.jsx("button",{onClick:x,disabled:p,style:{flex:1,padding:"10px",background:"#ef4444",border:"none",color:"white",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:p?"ì‚­ì œ ì¤‘...":"ë„¤, ì‚­ì œí•©ë‹ˆë‹¤"})]})]}),c===2&&e.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#4ade80"},children:[e.jsx(ce,{size:40,style:{marginBottom:"10px"}}),e.jsx("div",{children:"ì´ˆê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."}),e.jsx("button",{onClick:()=>l(0),style:{marginTop:"15px",padding:"8px 16px",borderRadius:"6px",background:"rgba(255,255,255,0.1)",border:"none",color:"white",cursor:"pointer"},children:"ëŒì•„ê°€ê¸°"})]})]}),e.jsxs("button",{onClick:o,style:{width:"100%",padding:"20px",borderRadius:"12px",marginTop:"20px",background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.1)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",cursor:"pointer"},children:[e.jsx(F,{size:20})," ë¡œê·¸ì•„ì›ƒ (í”„ë¡œí•„ ìž¬ì„¤ì •)"]})]})},Ee=({user:s})=>{const[c,l]=g.useState([]),[p,d]=g.useState(!0);if(!s.isAdmin)return e.jsx("div",{style:{padding:"50px",textAlign:"center"},children:"ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."});const o=async()=>{d(!0);try{const n=await C(S(v,"users"));l(n.docs.map(j=>j.data()))}catch(n){console.error(n)}finally{d(!1)}};g.useEffect(()=>{o()},[]);const x=async n=>{if(n.nickname==="ì¤€í˜"){alert("ê´€ë¦¬ìž ìžì‹ ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}if(confirm(`ì •ë§ë¡œ '${n.nickname}'ë‹˜ì„ íŒŒí‹°ì—ì„œ ì¶”ë°©í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.`))try{await E(k(v,"users",n.nickname)),alert("ì¶”ë°©ë˜ì—ˆìŠµë‹ˆë‹¤."),o()}catch(j){alert("ì˜¤ë¥˜ ë°œìƒ: "+j.message)}};return e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[e.jsxs("div",{className:"glass-panel",style:{padding:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(I,{size:24,color:"#fca5a5"}),e.jsx("h2",{style:{margin:0},children:"ê´€ë¦¬ìž ëŒ€ì‹œë³´ë“œ"})]}),e.jsxs("div",{className:"glass-panel",style:{padding:"30px"},children:[e.jsxs("h3",{style:{margin:"0 0 20px 0"},children:["ë“±ë¡ëœ íŒŒí‹°ì› ê´€ë¦¬ (",c.length,"/4)"]}),p?e.jsx("div",{children:"ë¡œë”© ì¤‘..."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:c.map(n=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(255,255,255,0.05)",padding:"15px",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#333",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:n.isAdmin?"ðŸ‘‘":"ðŸ‘¤"}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold"},children:[n.nickname," ",n.isAdmin&&e.jsx("span",{style:{color:"#fbbf24",fontSize:"0.8rem"},children:"(Admin)"})]}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.6},children:["Class: ",n.className]})]})]}),!n.isAdmin&&e.jsxs("button",{onClick:()=>x(n),style:{background:"rgba(239, 68, 68, 0.2)",color:"#fca5a5",border:"1px solid rgba(239, 68, 68, 0.4)",padding:"8px 12px",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(xe,{size:16})," ì¶”ë°©"]})]},n.id))})]})]})},We=[{id:"barbarian",name:"ë°”ë°”ë¦¬ì•ˆ",icon:ge,color:"#fca5a5"},{id:"bard",name:"ë°”ë“œ",icon:ue,color:"#f9a8d4"},{id:"cleric",name:"í´ë ˆë¦­",icon:he,color:"#d1d5db"},{id:"druid",name:"ë“œë£¨ì´ë“œ",icon:me,color:"#bef264"},{id:"fighter",name:"íŒŒì´í„°",icon:I,color:"#93c5fd"},{id:"monk",name:"ëª½í¬",icon:fe,color:"#7dd3fc"},{id:"paladin",name:"íŒ”ë¼ë”˜",icon:I,color:"#fbbf24"},{id:"ranger",name:"ë ˆì¸ì €",icon:ye,color:"#86efac"},{id:"rogue",name:"ë¡œê·¸",icon:be,color:"#cbd5e1"},{id:"sorcerer",name:"ì†Œì„œëŸ¬",icon:je,color:"#c084fc"},{id:"warlock",name:"ì›Œë½",icon:ve,color:"#e879f9"},{id:"wizard",name:"ìœ„ìžë“œ",icon:Se,color:"#818cf8"}],Ne=({onComplete:s})=>{const[c,l]=g.useState("check"),[p,d]=g.useState(""),[o,x]=g.useState(""),[n,j]=g.useState(null),[u,i]=g.useState(!1),[m,f]=g.useState(""),b=async a=>{if(a.preventDefault(),!!p.trim()){i(!0),f("");try{if((await N(k(v,"users",p))).exists())l("login");else{if((await C(S(v,"users"))).size>=4){f("ì£„ì†¡í•©ë‹ˆë‹¤. íŒŒí‹°ì› ì •ì›(4ëª…)ì´ ê½‰ ì°¼ìŠµë‹ˆë‹¤. ê´€ë¦¬ìžì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”."),i(!1);return}l("signup")}}catch(h){console.error(h),f("ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{i(!1)}}},t=async a=>{a.preventDefault(),i(!0);try{const y=(await N(k(v,"users",p))).data();y.password===o?(localStorage.setItem("bg3_user_profile",JSON.stringify(y)),s(y)):f("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")}catch{f("ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ")}finally{i(!1)}},r=async()=>{if(!n||!o){f("í´ëž˜ìŠ¤ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ìž…ë ¥í•´ì£¼ì„¸ìš”.");return}i(!0);try{if((await C(S(v,"users"))).size>=4)throw new Error("ê·¸ ì‚¬ì´ì— ì •ì›ì´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.");const h=p==="ì¤€í˜",y={id:p,nickname:p,password:o,className:n.name,classId:n.id,isAdmin:h,createdAt:R()};await W(k(v,"users",p),y),localStorage.setItem("bg3_user_profile",JSON.stringify(y)),s(y)}catch(a){console.error(a),f(a.message||"ê°€ìž… ì‹¤íŒ¨")}finally{i(!1)}};return e.jsxs("div",{className:"glass-panel",style:{maxWidth:"500px",margin:"100px auto",padding:"40px",textAlign:"center",position:"relative",overflow:"hidden"},children:[e.jsx("h1",{style:{marginBottom:"10px"},children:"âš”ï¸ ëª¨í—˜ê°€ ë“±ë¡"}),m&&e.jsx("div",{style:{color:"#ef4444",marginBottom:"15px",fontWeight:"bold"},children:m}),c==="check"&&e.jsxs("form",{onSubmit:b,children:[e.jsxs("p",{style:{opacity:.7,marginBottom:"30px"},children:["ì‚¬ìš©í•˜ì‹¤ ë‹‰ë„¤ìž„ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.",e.jsx("br",{}),"(ì´ 4ëª…ì˜ íŒŒí‹°ì›ë§Œ ë“±ë¡ ê°€ëŠ¥í•©ë‹ˆë‹¤)"]}),e.jsx("input",{type:"text",value:p,onChange:a=>d(a.target.value),placeholder:"ë‹‰ë„¤ìž„ (ì˜ˆ: ì¤€í˜)",style:{width:"100%",padding:"15px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.2)",color:"white",fontSize:"1.1rem",marginBottom:"20px",textAlign:"center"}}),e.jsx("button",{type:"submit",disabled:u,style:{width:"100%",padding:"15px",borderRadius:"12px",background:"var(--accent-color)",border:"none",color:"white",fontWeight:"bold"},children:u?"í™•ì¸ ì¤‘...":"ë‹¤ìŒ"})]}),c==="login"&&e.jsxs("form",{onSubmit:t,children:[e.jsxs("p",{style:{marginBottom:"20px"},children:[e.jsx("strong",{children:p}),"ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!",e.jsx("br",{}),"ë¹„ë°€ë²ˆí˜¸ë¥¼ ìž…ë ¥í•˜ì—¬ íŒŒí‹°ì— í•©ë¥˜í•˜ì„¸ìš”."]}),e.jsx("input",{type:"password",value:o,onChange:a=>x(a.target.value),placeholder:"ë¹„ë°€ë²ˆí˜¸",style:{width:"100%",padding:"15px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.2)",color:"white",fontSize:"1.1rem",marginBottom:"20px",textAlign:"center"}}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{type:"button",onClick:()=>l("check"),style:{flex:1,padding:"15px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"none",color:"white"},children:"ë’¤ë¡œ"}),e.jsx("button",{type:"submit",disabled:u,style:{flex:2,padding:"15px",borderRadius:"12px",background:"var(--accent-color)",border:"none",color:"white",fontWeight:"bold"},children:u?"ë¡œê·¸ì¸ ì¤‘...":"ëª¨í—˜ ì‹œìž‘"})]})]}),c==="signup"&&e.jsxs("div",{children:[e.jsxs("p",{style:{marginBottom:"20px"},children:["ì‹ ê·œ ë“±ë¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤!",e.jsx("br",{}),"í´ëž˜ìŠ¤ì™€ ì‚¬ìš©í•  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•˜ì„¸ìš”."]}),e.jsxs("div",{style:{position:"relative",marginBottom:"20px"},children:[e.jsx(_,{size:16,style:{position:"absolute",left:"15px",top:"50%",transform:"translateY(-50%)",opacity:.5}}),e.jsx("input",{type:"password",value:o,onChange:a=>x(a.target.value),placeholder:"ì‚¬ìš©í•  ë¹„ë°€ë²ˆí˜¸ ì„¤ì •",style:{width:"100%",padding:"12px 12px 12px 40px",borderRadius:"8px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(0,0,0,0.2)",color:"white",fontSize:"1rem",textAlign:"left"}})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px",maxHeight:"300px",overflowY:"auto",marginBottom:"20px",paddingRight:"5px"},children:We.map(a=>{const h=a.icon;return e.jsxs("button",{onClick:()=>j(a),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",padding:"10px",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)",background:n?.id===a.id?a.color:"rgba(255,255,255,0.05)",color:n?.id===a.id?"black":"white",cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(h,{size:24}),e.jsx("span",{style:{fontSize:"0.7rem"},children:a.name})]},a.id)})}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>l("check"),style:{flex:1,padding:"15px",borderRadius:"12px",background:"rgba(255,255,255,0.1)",border:"none",color:"white"},children:"ë’¤ë¡œ"}),e.jsx("button",{onClick:r,disabled:u,style:{flex:2,padding:"15px",borderRadius:"12px",background:"var(--accent-color)",border:"none",color:"white",fontWeight:"bold"},children:u?"ë“±ë¡ ì¤‘...":"ë“±ë¡ ì™„ë£Œ"})]})]})]})},Le=()=>{const[s,c]=g.useState(null),[l,p]=g.useState(1),[d,o]=g.useState("home"),[x,n]=g.useState(window.innerWidth<768);g.useEffect(()=>{const i=localStorage.getItem("bg3_user_profile");i&&c(JSON.parse(i));const m=()=>n(window.innerWidth<768);return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),g.useEffect(()=>{if(!s)return;const i=async()=>{try{await W(k(v,"online_users",s.id),{nickname:s.nickname,classId:s.classId||"unknown",lastSeen:R()},{merge:!0})}catch(t){console.error("Heartbeat fail:",t)}};i();const m=setInterval(i,3e4),f=z(S(v,"online_users")),b=D(f,t=>{const r=Date.now(),a=t.docs.filter(h=>{const y=h.data();if(!y.lastSeen)return!1;const w=y.lastSeen.toDate?y.lastSeen.toDate().getTime():0;return r-w<12e4});p(a.length)});return()=>{clearInterval(m),b()}},[s]);const j=i=>{c(i)},u=()=>{switch(d){case"home":return e.jsx(B,{user:s});case"chat":return e.jsx(De,{user:s});case"calendar":return e.jsx(Ie,{user:s});case"save":return e.jsx(Be,{user:s});case"settings":return e.jsx(Te,{user:s});case"admin":return s.isAdmin?e.jsx(Ee,{user:s}):e.jsx(B,{user:s});default:return e.jsx(B,{user:s})}};return s?e.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"var(--bg-color)"},children:[e.jsx(ke,{activeTab:d,setActiveTab:o,isMobile:x,onlineCount:l,user:s}),e.jsx("main",{style:{flex:1,padding:x?"80px 20px 20px":"20px",overflowY:"auto",position:"relative"},children:u()})]}):e.jsx(Ne,{onComplete:j})};function Oe(){return e.jsx(Le,{})}we.createRoot(document.getElementById("root")).render(e.jsx(g.StrictMode,{children:e.jsx(Oe,{})}));
